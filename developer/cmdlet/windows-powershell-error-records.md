---
title: Windows PowerShell 错误记录 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- error category [PowerShell SDK]
- error identifier [PowerShell SDK]
- error records [PowerShell SDK]
- error category string [PowerShell SDK]
ms.assetid: bdd66fea-eb63-4bb6-9cbe-9a799e5e0db5
caps.latest.revision: 9
ms.openlocfilehash: bbe04a8fb556f0f6807bc0eae6634e3cf505759e
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/03/2019
ms.locfileid: "56861973"
---
# <a name="windows-powershell-error-records"></a><span data-ttu-id="80566-102">Windows PowerShell 错误记录</span><span class="sxs-lookup"><span data-stu-id="80566-102">Windows PowerShell Error Records</span></span>

<span data-ttu-id="80566-103">Cmdlet 必须传递[System.Management.Automation.Errorrecord](/dotnet/api/System.Management.Automation.ErrorRecord)标识终止和非终止性错误的错误条件的对象。</span><span class="sxs-lookup"><span data-stu-id="80566-103">Cmdlets must pass an [System.Management.Automation.Errorrecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that identifies the error condition for terminating and non-terminating errors.</span></span>

<span data-ttu-id="80566-104">[System.Management.Automation.Errorrecord](/dotnet/api/System.Management.Automation.ErrorRecord)对象包含以下信息：</span><span class="sxs-lookup"><span data-stu-id="80566-104">The [System.Management.Automation.Errorrecord](/dotnet/api/System.Management.Automation.ErrorRecord) object contains the following information:</span></span>

- <span data-ttu-id="80566-105">描述错误的异常。</span><span class="sxs-lookup"><span data-stu-id="80566-105">The exception that describes the error.</span></span> <span data-ttu-id="80566-106">通常情况下，这是该 cmdlet 捕获并转换为错误记录的异常。</span><span class="sxs-lookup"><span data-stu-id="80566-106">Often, this is an exception that the cmdlet caught and converted into an error record.</span></span> <span data-ttu-id="80566-107">每个错误记录必须包含一个异常。</span><span class="sxs-lookup"><span data-stu-id="80566-107">Every error record must contain an exception.</span></span>

<span data-ttu-id="80566-108">如果该 cmdlet 未捕获异常，它必须创建新异常，并选择最适合描述错误条件的异常类。</span><span class="sxs-lookup"><span data-stu-id="80566-108">If the cmdlet did not catch an exception, it must create a new exception and choose the exception class that best describes the error condition.</span></span> <span data-ttu-id="80566-109">但是，不需要引发异常，因为它可以通过访问[System.Management.Automation.Errorrecord.Exception\*](/dotnet/api/System.Management.Automation.ErrorRecord.Exception)属性的[System.Management.Automation.Errorrecord](/dotnet/api/System.Management.Automation.ErrorRecord)对象。</span><span class="sxs-lookup"><span data-stu-id="80566-109">However, you do not need to throw the exception because it can be accessed through the [System.Management.Automation.Errorrecord.Exception\*](/dotnet/api/System.Management.Automation.ErrorRecord.Exception) property of the [System.Management.Automation.Errorrecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span>

- <span data-ttu-id="80566-110">提供可用于诊断目的和通过 Windows PowerShell 脚本来处理具有特定的错误处理程序的特定错误条件的目标的指示符错误标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-110">An error identifier that provides a targeted designator that can be used for diagnostic purposes and by Windows PowerShell scripts to handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="80566-111">每个错误记录必须包含的错误标识符 （请参阅错误标识符）。</span><span class="sxs-lookup"><span data-stu-id="80566-111">Every error record must contain an error identifier (see Error Identifier).</span></span>

- <span data-ttu-id="80566-112">错误类别，提供可用于诊断目的的常规指示符。</span><span class="sxs-lookup"><span data-stu-id="80566-112">An error category that provides a general designator that can be used for diagnostic purposes.</span></span> <span data-ttu-id="80566-113">每个错误记录必须指定的错误类别 （请参阅错误类别）。</span><span class="sxs-lookup"><span data-stu-id="80566-113">Every error record must specify an error category (see Error Category).</span></span>

- <span data-ttu-id="80566-114">可选替换错误消息和建议的操作 （请参阅替换错误消息）。</span><span class="sxs-lookup"><span data-stu-id="80566-114">An optional replacement error message and a recommended action (see Replacement Error Message).</span></span>

- <span data-ttu-id="80566-115">可选调用引发了错误的 cmdlet 的信息。</span><span class="sxs-lookup"><span data-stu-id="80566-115">Optional invocation information about the cmdlet that threw the error.</span></span> <span data-ttu-id="80566-116">此信息指定 Windows powershell （请参阅调用消息）。</span><span class="sxs-lookup"><span data-stu-id="80566-116">This information is specified by Windows PowerShell (see Invocation Message).</span></span>

- <span data-ttu-id="80566-117">发生错误时正在处理的目标对象。</span><span class="sxs-lookup"><span data-stu-id="80566-117">The target object that was being processed when the error occurred.</span></span> <span data-ttu-id="80566-118">这可能是输入的对象，也可能是你的 cmdlet 已处理的另一个对象。</span><span class="sxs-lookup"><span data-stu-id="80566-118">This might be the input object, or it might be another object that your cmdlet was processing.</span></span> <span data-ttu-id="80566-119">例如，对于该命令`remove-item -recurse c:\somedirectory`，错误可能是"c:\somedirectory\lockedfile"FileInfo 对象的实例。</span><span class="sxs-lookup"><span data-stu-id="80566-119">For example, for the command `remove-item -recurse c:\somedirectory`, the error might be an instance of a FileInfo object for "c:\somedirectory\lockedfile".</span></span> <span data-ttu-id="80566-120">目标对象信息是可选的。</span><span class="sxs-lookup"><span data-stu-id="80566-120">The target object information is optional.</span></span>

## <a name="error-identifier"></a><span data-ttu-id="80566-121">错误标识符</span><span class="sxs-lookup"><span data-stu-id="80566-121">Error Identifier</span></span>

<span data-ttu-id="80566-122">创建错误记录时，指定将在你的 cmdlet 中的错误条件指定的标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-122">When you create an error record, specify an identifier that designates the error condition within your cmdlet.</span></span> <span data-ttu-id="80566-123">Windows PowerShell cmdlet 来创建完全限定的错误标识符的名称与组合目标的标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-123">Windows PowerShell combines the targeted identifier with the name of your cmdlet to create a fully qualified error identifier.</span></span> <span data-ttu-id="80566-124">可以通过访问的完全限定的错误标识符[System.Management.Automation.Errorrecord.Fullyqualifiederrorid\*](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId)属性的[System.Management.Automation.Errorrecord](/dotnet/api/System.Management.Automation.ErrorRecord)对象。</span><span class="sxs-lookup"><span data-stu-id="80566-124">The fully qualified error identifier can be accessed through the [System.Management.Automation.Errorrecord.Fullyqualifiederrorid\*](/dotnet/api/System.Management.Automation.ErrorRecord.FullyQualifiedErrorId) property of the [System.Management.Automation.Errorrecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="80566-125">本身的错误标识符不可用。</span><span class="sxs-lookup"><span data-stu-id="80566-125">The error identifier is not available by itself.</span></span> <span data-ttu-id="80566-126">该内容位于仅作为完全限定的错误标识符的一部分。</span><span class="sxs-lookup"><span data-stu-id="80566-126">It is available only as part of the fully qualified error identifier.</span></span>

<span data-ttu-id="80566-127">使用以下准则来创建错误记录时生成错误标识符：</span><span class="sxs-lookup"><span data-stu-id="80566-127">Use the following guidelines to generate error identifiers when you create error records:</span></span>

- <span data-ttu-id="80566-128">使特定的错误条件的错误标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-128">Make error identifiers specific to an error condition.</span></span> <span data-ttu-id="80566-129">诊断目的和处理特定错误条件使用特定的错误处理程序的脚本为目标的错误标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-129">Target the error identifiers for diagnostic purposes and for scripts that handle specific error conditions with specific error handlers.</span></span> <span data-ttu-id="80566-130">用户应该能够使用错误标识符来标识该错误和其源。</span><span class="sxs-lookup"><span data-stu-id="80566-130">A user should be able to use the error identifier to identify the error and its source.</span></span> <span data-ttu-id="80566-131">错误标识符还为启用报表从现有异常的特定错误条件，以便新异常子类不是必需的。</span><span class="sxs-lookup"><span data-stu-id="80566-131">Error identifiers also enable reporting for specific error conditions from existing exceptions so that new exception subclasses are not required.</span></span>

- <span data-ttu-id="80566-132">一般情况下，将不同的错误标识符分配给不同的代码路径。</span><span class="sxs-lookup"><span data-stu-id="80566-132">In general, assign different error identifiers to different code paths.</span></span> <span data-ttu-id="80566-133">最终用户可以利用特定标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-133">The end-user benefits from specific identifiers.</span></span> <span data-ttu-id="80566-134">通常情况下，每个调用的代码路径[System.Management.Automation.Cmdlet.Writeerror\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或[System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)具有其自己的标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-134">Often, each code path that calls [System.Management.Automation.Cmdlet.Writeerror\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) has its own identifier.</span></span> <span data-ttu-id="80566-135">一般来说，定义一个新的标识符时定义的错误消息和进行相反转换为新的模板字符串。</span><span class="sxs-lookup"><span data-stu-id="80566-135">As a rule, define a new identifier when you define a new template string for the error message, and vice-versa.</span></span> <span data-ttu-id="80566-136">不要使用错误消息作为标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-136">Do not use the error message as an identifier.</span></span>

- <span data-ttu-id="80566-137">发布时使用的特定错误标识符代码，您建立的语义错误该标识符完整产品支持生命周期。</span><span class="sxs-lookup"><span data-stu-id="80566-137">When you publish code using a particular error identifier, you establish the semantics of errors with that identifier for your complete product support lifecycle.</span></span> <span data-ttu-id="80566-138">不要重复使用它在语义上不同于原始上下文的上下文中。</span><span class="sxs-lookup"><span data-stu-id="80566-138">Do not reuse it in a context that is semantically different from the original context.</span></span> <span data-ttu-id="80566-139">如果此错误的语义更改，请创建，然后使用新的标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-139">If the semantics of this error change, create and then use a new identifier.</span></span>

- <span data-ttu-id="80566-140">通常应仅为特定的 CLR 类型的异常使用的特定错误标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-140">You should generally use a particular error identifier only for exceptions of a particular CLR type.</span></span> <span data-ttu-id="80566-141">如果异常的类型或目标对象的类型发生更改，创建，然后使用新的标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-141">If the type of the exception or the type of the target object changes, create and then use a new identifier.</span></span>

- <span data-ttu-id="80566-142">选择你用于简明地对应于要报告的错误的错误标识符的文本。</span><span class="sxs-lookup"><span data-stu-id="80566-142">Choose text for your error identifier that concisely corresponds to the error that you are reporting.</span></span> <span data-ttu-id="80566-143">使用标准.NET Framework 命名和大小写约定。</span><span class="sxs-lookup"><span data-stu-id="80566-143">Use standard .NET Framework naming and capitalization conventions.</span></span> <span data-ttu-id="80566-144">不要使用空格或标点。</span><span class="sxs-lookup"><span data-stu-id="80566-144">Do not use white space or punctuation.</span></span> <span data-ttu-id="80566-145">不要本地化错误标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-145">Do not localize error identifiers.</span></span>

- <span data-ttu-id="80566-146">不动态会生成错误标识符不可重现的方式。</span><span class="sxs-lookup"><span data-stu-id="80566-146">Do not dynamically generate error identifiers in a non-reproducible way.</span></span> <span data-ttu-id="80566-147">例如，不包含错误的信息，例如进程 id。</span><span class="sxs-lookup"><span data-stu-id="80566-147">For example, do not incorporate error information such as a process ID.</span></span> <span data-ttu-id="80566-148">错误标识符是仅在它们对应于遇到相同的错误条件的其他用户看到的错误标识符。</span><span class="sxs-lookup"><span data-stu-id="80566-148">Error identifiers are useful only if they correspond to the error identifiers seen by other users who are experiencing the same error condition.</span></span>

## <a name="error-category"></a><span data-ttu-id="80566-149">错误类别</span><span class="sxs-lookup"><span data-stu-id="80566-149">Error Category</span></span>

<span data-ttu-id="80566-150">创建错误记录时，指定使用定义的常量之一的错误类别[System.Management.Automation.Errorcategory](/dotnet/api/System.Management.Automation.ErrorCategory)枚举。</span><span class="sxs-lookup"><span data-stu-id="80566-150">When you create an error record, specify the category of the error using one of the constants defined by the [System.Management.Automation.Errorcategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span> <span data-ttu-id="80566-151">Windows PowerShell 使用的错误类别的用户设置时显示错误信息`$ErrorView`变量`"CategoryView"`。</span><span class="sxs-lookup"><span data-stu-id="80566-151">Windows PowerShell uses the error category to display error information when users set the `$ErrorView` variable to `"CategoryView"`.</span></span>

<span data-ttu-id="80566-152">避免使用[System.Management.Automation.Errorcategory.Notspecified](/dotnet/api/System.Management.Automation.ErrorCategory.NotSpecified)常量。</span><span class="sxs-lookup"><span data-stu-id="80566-152">Avoid using the [System.Management.Automation.Errorcategory.Notspecified](/dotnet/api/System.Management.Automation.ErrorCategory.NotSpecified) constant.</span></span> <span data-ttu-id="80566-153">如果有任何有关错误或导致了错误的操作的信息，即使该类别不是完美匹配选择最适合描述错误或操作的类别。</span><span class="sxs-lookup"><span data-stu-id="80566-153">If you have any information about the error or about the operation that caused the error, choose the category that best describes the error or the operation, even if the category is not a perfect match.</span></span>

<span data-ttu-id="80566-154">显示 Windows powershell 的信息被称为类别查看字符串和为依据的属性[System.Management.Automation.Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)类。</span><span class="sxs-lookup"><span data-stu-id="80566-154">The information displayed by Windows PowerShell is referred to as the category-view string and is built from the properties of the [System.Management.Automation.Errorcategoryinfo](/dotnet/api/System.Management.Automation.ErrorCategoryInfo) class.</span></span> <span data-ttu-id="80566-155">(此类错误可通过访问[System.Management.Automation.Errorrecord.Categoryinfo\*](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo)属性。)</span><span class="sxs-lookup"><span data-stu-id="80566-155">(This class is accessed through the error [System.Management.Automation.Errorrecord.Categoryinfo\*](/dotnet/api/System.Management.Automation.ErrorRecord.CategoryInfo) property.)</span></span>

```
{Category}: ({TargetName}:{TargetType}):[{Activity}], {Reason}
```

<span data-ttu-id="80566-156">以下列表描述了显示的信息：</span><span class="sxs-lookup"><span data-stu-id="80566-156">The following list describes the information displayed:</span></span>

- <span data-ttu-id="80566-157">类别：Windows PowerShell 定义[System.Management.Automation.Errorcategory](/dotnet/api/System.Management.Automation.ErrorCategory)常量。</span><span class="sxs-lookup"><span data-stu-id="80566-157">Category: A Windows PowerShell-defined [System.Management.Automation.Errorcategory](/dotnet/api/System.Management.Automation.ErrorCategory) constant.</span></span>

- <span data-ttu-id="80566-158">TargetName:默认情况下，该对象的名称 cmdlet 处理中出现错误。</span><span class="sxs-lookup"><span data-stu-id="80566-158">TargetName: By default, the name of the object the cmdlet was processing when the error occurred.</span></span> <span data-ttu-id="80566-159">或者，另一个 cmdlet，定义的字符串。</span><span class="sxs-lookup"><span data-stu-id="80566-159">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="80566-160">TargetType:默认情况下，目标对象的类型。</span><span class="sxs-lookup"><span data-stu-id="80566-160">TargetType: By default, the type of the target object.</span></span> <span data-ttu-id="80566-161">或者，另一个 cmdlet，定义的字符串。</span><span class="sxs-lookup"><span data-stu-id="80566-161">Or, another cmdlet-defined string.</span></span>

- <span data-ttu-id="80566-162">活动：默认情况下，创建错误记录 cmdlet 的名称。</span><span class="sxs-lookup"><span data-stu-id="80566-162">Activity: By default, the name of the cmdlet that created the error record.</span></span> <span data-ttu-id="80566-163">或者，某些其他 cmdlet 定义的字符串。</span><span class="sxs-lookup"><span data-stu-id="80566-163">Or, some other cmdlet-defined string.</span></span>

- <span data-ttu-id="80566-164">原因：默认情况下，异常类型。</span><span class="sxs-lookup"><span data-stu-id="80566-164">Reason: By default, the exception type.</span></span> <span data-ttu-id="80566-165">或者，另一个 cmdlet，定义的字符串。</span><span class="sxs-lookup"><span data-stu-id="80566-165">Or, another cmdlet-defined string.</span></span>

## <a name="replacement-error-message"></a><span data-ttu-id="80566-166">替换错误消息</span><span class="sxs-lookup"><span data-stu-id="80566-166">Replacement Error Message</span></span>

<span data-ttu-id="80566-167">开发时 cmdlet 的错误记录，该错误的默认错误消息来自中的默认消息文本[System.Exception.Message](/dotnet/api/System.Exception.Message)属性。</span><span class="sxs-lookup"><span data-stu-id="80566-167">When you develop an error record for a cmdlet, the default error message for the error comes from the default message text in the [System.Exception.Message](/dotnet/api/System.Exception.Message) property.</span></span> <span data-ttu-id="80566-168">这是其消息文本旨在仅适用于调试 （.NET Framework 指南 》 中提及） 的只读属性。</span><span class="sxs-lookup"><span data-stu-id="80566-168">This is a read-only property whose message text is intended only for debugging purposes (according to the .NET Framework guidelines).</span></span> <span data-ttu-id="80566-169">我们建议创建替换或补充默认消息文本的错误消息。</span><span class="sxs-lookup"><span data-stu-id="80566-169">We recommend that you create an error message that replaces or augments the default message text.</span></span> <span data-ttu-id="80566-170">将更加友好的用户和更多特定消息给 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="80566-170">Make the message more user-friendly and more specific to the cmdlet.</span></span>

<span data-ttu-id="80566-171">通过提供的替换消息[System.Management.Automation.Errordetails](/dotnet/api/System.Management.Automation.ErrorDetails)对象。</span><span class="sxs-lookup"><span data-stu-id="80566-171">The replacement message is provided by an [System.Management.Automation.Errordetails](/dotnet/api/System.Management.Automation.ErrorDetails) object.</span></span> <span data-ttu-id="80566-172">使用此对象的以下构造函数之一，因为它们提供可由 Windows PowerShell 的额外的本地化信息。</span><span class="sxs-lookup"><span data-stu-id="80566-172">Use one of the following constructors of this object because they provide additional localization information that can be used by Windows PowerShell.</span></span>

- <span data-ttu-id="80566-173">[ErrorDetails.ErrorDetails (Cmdlet、 字符串、 字符串、 对象\[System.Management.Automation.Errordetails.%23Ctor%28System.Management.Automation.Cmdlet%2Csystem.String%2Csystem.String%2Csystem.Object%5B%5D%29？Displayproperty =](/dotnet/api/System.Management.Automation.ErrorDetails.%23ctor%28System.Management.Automation.Cmdlet%2CSystem.String%2CSystem.String%2CSystem.Object%5B%5D%29):使用此构造函数，如果您的模板字符串是在其中实现该 cmdlet 在同一程序集中的资源字符串，或如果你想要加载的模板字符串的重写通过[System.Management.Automation.Cmdlet.Getresourcestring\*](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)方法。</span><span class="sxs-lookup"><span data-stu-id="80566-173">[ErrorDetails.ErrorDetails(Cmdlet, String, String, Object\[System.Management.Automation.Errordetails.%23Ctor%28System.Management.Automation.Cmdlet%2Csystem.String%2Csystem.String%2Csystem.Object%5B%5D%29?Displayproperty=Fullname](/dotnet/api/System.Management.Automation.ErrorDetails.%23ctor%28System.Management.Automation.Cmdlet%2CSystem.String%2CSystem.String%2CSystem.Object%5B%5D%29): Use this constructor if your template string is a resource string in the same assembly in which the cmdlet is implemented or if you want to load the template string through an override of the  [System.Management.Automation.Cmdlet.Getresourcestring\*](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString) method.</span></span>

- <span data-ttu-id="80566-174">[ErrorDetails.ErrorDetails (程序集、 字符串、 字符串、 对象\[System.Management.Automation.Errordetails.%23Ctor%28System.Reflection.Assembly%2Csystem.String%2Csystem.String%2Csystem.Object%5B%5D%29？Displayproperty =](/dotnet/api/System.Management.Automation.ErrorDetails.%23ctor%28System.Reflection.Assembly%2CSystem.String%2CSystem.String%2CSystem.Object%5B%5D%29):如果模板字符串为另一个程序集中并且不执行操作的重写通过加载它，请使用此构造函数[System.Management.Automation.Cmdlet.Getresourcestring\*](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString)。</span><span class="sxs-lookup"><span data-stu-id="80566-174">[ErrorDetails.ErrorDetails(Assembly, String, String, Object\[System.Management.Automation.Errordetails.%23Ctor%28System.Reflection.Assembly%2Csystem.String%2Csystem.String%2Csystem.Object%5B%5D%29?Displayproperty=Fullname](/dotnet/api/System.Management.Automation.ErrorDetails.%23ctor%28System.Reflection.Assembly%2CSystem.String%2CSystem.String%2CSystem.Object%5B%5D%29): Use this constructor if the template string is in another assembly and you do not load it through an override of [System.Management.Automation.Cmdlet.Getresourcestring\*](/dotnet/api/System.Management.Automation.Cmdlet.GetResourceString).</span></span>

<span data-ttu-id="80566-175">替换消息应符合编写略有不同的异常消息的.NET Framework 设计准则。</span><span class="sxs-lookup"><span data-stu-id="80566-175">The replacement message should conform to the .NET Framework design guidelines for writing exception messages with a small difference.</span></span> <span data-ttu-id="80566-176">异常消息应面向开发人员指南状态。</span><span class="sxs-lookup"><span data-stu-id="80566-176">The guidelines state that exception messages should be written for developers.</span></span> <span data-ttu-id="80566-177">应为 cmdlet 用户编写这些替换消息。</span><span class="sxs-lookup"><span data-stu-id="80566-177">These replacement messages should be written for the cmdlet user.</span></span>

<span data-ttu-id="80566-178">替换错误消息必须添加之前[System.Management.Automation.Cmdlet.Writeerror\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或[System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)调用方法.</span><span class="sxs-lookup"><span data-stu-id="80566-178">The replacement error message must be added before the [System.Management.Automation.Cmdlet.Writeerror\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) methods are called.</span></span> <span data-ttu-id="80566-179">若要添加置换消息，请设置[System.Management.Automation.Errorrecord.Errordetails\*](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails)错误记录的属性。</span><span class="sxs-lookup"><span data-stu-id="80566-179">To add a replacement message, set the [System.Management.Automation.Errorrecord.Errordetails\*](/dotnet/api/System.Management.Automation.ErrorRecord.ErrorDetails) property of the error record.</span></span> <span data-ttu-id="80566-180">当设置此属性时，Windows PowerShell 会显示[System.Management.Automation.Errordetails.Message\*](/dotnet/api/System.Management.Automation.ErrorDetails.Message)属性而不是默认消息文本。</span><span class="sxs-lookup"><span data-stu-id="80566-180">When this property is set, Windows PowerShell displays the [System.Management.Automation.Errordetails.Message\*](/dotnet/api/System.Management.Automation.ErrorDetails.Message) property instead of the default message text.</span></span>

## <a name="recommended-action-information"></a><span data-ttu-id="80566-181">建议的操作信息</span><span class="sxs-lookup"><span data-stu-id="80566-181">Recommended Action Information</span></span>

<span data-ttu-id="80566-182">[System.Management.Automation.Errordetails](/dotnet/api/System.Management.Automation.ErrorDetails)对象还可以提供有关发生错误时，建议使用哪些操作的信息。</span><span class="sxs-lookup"><span data-stu-id="80566-182">The [System.Management.Automation.Errordetails](/dotnet/api/System.Management.Automation.ErrorDetails) object can also provide information about what actions are recommended when the error occurs.</span></span>

## <a name="invocation-information"></a><span data-ttu-id="80566-183">调用的信息</span><span class="sxs-lookup"><span data-stu-id="80566-183">Invocation information</span></span>

<span data-ttu-id="80566-184">当使用 cmdlet [System.Management.Automation.Cmdlet.Writeerror\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)或[System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)来报告错误记录，Windows PowerShell会自动添加描述发生错误时调用的命令的信息。</span><span class="sxs-lookup"><span data-stu-id="80566-184">When a cmdlet uses [System.Management.Automation.Cmdlet.Writeerror\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) or [System.Management.Automation.Cmdlet.Throwterminatingerror\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) to report an error record, Windows PowerShell automatically adds information that describes the command that was invoked when the error occurred.</span></span> <span data-ttu-id="80566-185">通过提供此信息[System.Management.Automation.Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo)对象，其中包含已调用的命令，命令自身中，该 cmdlet 的名称和有关管道或脚本的信息。</span><span class="sxs-lookup"><span data-stu-id="80566-185">This information is provided by a [System.Management.Automation.Invocationinfo](/dotnet/api/System.Management.Automation.InvocationInfo) object that contains the name of the cmdlet that was invoked by the command, the command itself, and information about the pipeline or script.</span></span> <span data-ttu-id="80566-186">此属性是只读的。</span><span class="sxs-lookup"><span data-stu-id="80566-186">This property is read-only.</span></span>

## <a name="see-also"></a><span data-ttu-id="80566-187">另请参阅</span><span class="sxs-lookup"><span data-stu-id="80566-187">See Also</span></span>

[<span data-ttu-id="80566-188">System.Management.Automation.Cmdlet.Writeerror\*</span><span class="sxs-lookup"><span data-stu-id="80566-188">System.Management.Automation.Cmdlet.Writeerror\*</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)

[<span data-ttu-id="80566-189">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span><span class="sxs-lookup"><span data-stu-id="80566-189">System.Management.Automation.Cmdlet.Throwterminatingerror\*</span></span>](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)

[<span data-ttu-id="80566-190">System.Management.Automation.Errorcategory</span><span class="sxs-lookup"><span data-stu-id="80566-190">System.Management.Automation.Errorcategory</span></span>](/dotnet/api/System.Management.Automation.ErrorCategory)

[<span data-ttu-id="80566-191">System.Management.Automation.Errorcategoryinfo</span><span class="sxs-lookup"><span data-stu-id="80566-191">System.Management.Automation.Errorcategoryinfo</span></span>](/dotnet/api/System.Management.Automation.ErrorCategoryInfo)

[<span data-ttu-id="80566-192">System.Management.Automation.Errorrecord</span><span class="sxs-lookup"><span data-stu-id="80566-192">System.Management.Automation.Errorrecord</span></span>](/dotnet/api/System.Management.Automation.ErrorRecord)

[<span data-ttu-id="80566-193">System.Management.Automation.Errordetails</span><span class="sxs-lookup"><span data-stu-id="80566-193">System.Management.Automation.Errordetails</span></span>](/dotnet/api/System.Management.Automation.ErrorDetails)

[<span data-ttu-id="80566-194">System.Management.Automation.Invocationinfo</span><span class="sxs-lookup"><span data-stu-id="80566-194">System.Management.Automation.Invocationinfo</span></span>](/dotnet/api/System.Management.Automation.InvocationInfo)

[<span data-ttu-id="80566-195">Windows PowerShell 错误报告</span><span class="sxs-lookup"><span data-stu-id="80566-195">Windows PowerShell Error Reporting</span></span>](./error-reporting-concepts.md)

[<span data-ttu-id="80566-196">编写 Windows PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="80566-196">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
