---
title: 所需的开发准则 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 41d2b308-a36a-496f-8542-666b6a21eedc
caps.latest.revision: 19
ms.openlocfilehash: 3f6bcd2e4ef4d9c404b3a5deeaa9f25d3fa42ec1
ms.sourcegitcommit: caac7d098a448232304c9d6728e7340ec7517a71
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/16/2019
ms.locfileid: "58056509"
---
# <a name="required-development-guidelines"></a><span data-ttu-id="c5ff6-102">必需的开发指南</span><span class="sxs-lookup"><span data-stu-id="c5ff6-102">Required Development Guidelines</span></span>

<span data-ttu-id="c5ff6-103">编写 cmdlet 时，必须遵循以下准则。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-103">The following guidelines must be followed when you write your cmdlets.</span></span> <span data-ttu-id="c5ff6-104">它们分为设计 cmdlet 和指引，用于编写 cmdlet 代码的准则。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="c5ff6-105">如果不遵循这些指导原则，cmdlet 可能会失败，并在使用 cmdlet 时，用户可能具有不好的体验。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-105">If you do not follow these guidelines, your cmdlets could fail, and your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="c5ff6-106">本主题内容</span><span class="sxs-lookup"><span data-stu-id="c5ff6-106">In this Topic</span></span>

### <a name="design-guidelines"></a><span data-ttu-id="c5ff6-107">设计指南</span><span class="sxs-lookup"><span data-stu-id="c5ff6-107">Design Guidelines</span></span>

- [<span data-ttu-id="c5ff6-108">只使用批准的谓词 (RD01)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-108">Use Only Approved Verbs (RD01)</span></span>](./required-development-guidelines.md#use-only-approved-verbs-rd01)

- [<span data-ttu-id="c5ff6-109">Cmdlet 名称：不能使用的字符 (RD02)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-109">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>](./required-development-guidelines.md#cmdlet-names-characters-that-cannot-be-used-rd02)

- [<span data-ttu-id="c5ff6-110">不能使用的参数名称 (RD03)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-110">Parameters Names that cannot be Used (RD03)</span></span>](./required-development-guidelines.md#parameters-names-that-cannot-be-used-rd03)

- [<span data-ttu-id="c5ff6-111">支持确认请求 (RD04)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-111">Support Confirmation Requests (RD04)</span></span>](./required-development-guidelines.md#support-confirmation-requests-rd04)

- [<span data-ttu-id="c5ff6-112">为交互式会话 (RD05) 支持 Force 参数</span><span class="sxs-lookup"><span data-stu-id="c5ff6-112">Support Force Parameter for Interactive Sessions (RD05)</span></span>](./required-development-guidelines.md#support-force-parameter-for-interactive-sessions-rd05)

- [<span data-ttu-id="c5ff6-113">文档输出对象 (RD06)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-113">Document Output Objects (RD06)</span></span>](./required-development-guidelines.md#document-output-objects-rd06)

### <a name="code-guidelines"></a><span data-ttu-id="c5ff6-114">代码指南</span><span class="sxs-lookup"><span data-stu-id="c5ff6-114">Code Guidelines</span></span>

- [<span data-ttu-id="c5ff6-115">派生的 Cmdlet 或 PSCmdlet 类 (RC01)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-115">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>](./required-development-guidelines.md#derive-from-the-cmdlet-or-pscmdlet-classes-rc01)

- [<span data-ttu-id="c5ff6-116">指定 Cmdlet 属性 (RC02)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-116">Specify the Cmdlet Attribute (RC02)</span></span>](./required-development-guidelines.md#specify-the-cmdlet-attribute-rc02)

- [<span data-ttu-id="c5ff6-117">重写输入处理方法 (RC03)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-117">Override an Input Processing Method (RC03)</span></span>](./required-development-guidelines.md#override-an-input-processing-method-rc03)

- [<span data-ttu-id="c5ff6-118">指定 OutputType 属性 (RC04)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-118">Specify the OutputType Attribute (RC04)</span></span>](./required-development-guidelines.md#specify-the-outputtype-attribute-rc04)

- [<span data-ttu-id="c5ff6-119">不保留输出对象 (RC05) 的句柄</span><span class="sxs-lookup"><span data-stu-id="c5ff6-119">Do Not Retain Handles to Output Objects (RC05)</span></span>](./required-development-guidelines.md#do-not-retain-handles-to-output-objects-rc05)

- [<span data-ttu-id="c5ff6-120">可靠地处理错误 (RC06)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-120">Handle Errors Robustly (RC06)</span></span>](./required-development-guidelines.md#handle-errors-robustly-rc06)

- [<span data-ttu-id="c5ff6-121">使用 Windows PowerShell 模块来部署 Cmdlet (RC07)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-121">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>](./required-development-guidelines.md#use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07)

## <a name="design-guidelines"></a><span data-ttu-id="c5ff6-122">设计指南</span><span class="sxs-lookup"><span data-stu-id="c5ff6-122">Design Guidelines</span></span>

<span data-ttu-id="c5ff6-123">设计用于确保使用 cmdlet 和其他 cmdlet 之间一致的用户体验的 cmdlet 时，必须遵循以下准则。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-123">The following guidelines must be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="c5ff6-124">找到一个设计指导原则适用于你的情况，请务必查看类似的指导原则的代码准则。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-124">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-only-approved-verbs-rd01"></a><span data-ttu-id="c5ff6-125">只使用批准的谓词 (RD01)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-125">Use Only Approved Verbs (RD01)</span></span>

<span data-ttu-id="c5ff6-126">Cmdlet 属性中指定的谓词必须来自已识别组提供的 Windows PowerShell 的谓词。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-126">The verb specified in the Cmdlet attribute must come from the recognized set of verbs provided by Windows PowerShell.</span></span> <span data-ttu-id="c5ff6-127">它不能禁止同义词之一。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-127">It must not be one of the prohibited synonyms.</span></span> <span data-ttu-id="c5ff6-128">使用以下枚举来指定 cmdlet 谓词定义的常量字符串：</span><span class="sxs-lookup"><span data-stu-id="c5ff6-128">Use the constant strings that are defined by the following enumerations to specify cmdlet verbs:</span></span>

- [<span data-ttu-id="c5ff6-129">System.Management.Automation.VerbsCommon</span><span class="sxs-lookup"><span data-stu-id="c5ff6-129">System.Management.Automation.VerbsCommon</span></span>](/dotnet/api/System.Management.Automation.VerbsCommon)

- [<span data-ttu-id="c5ff6-130">System.Management.Automation.VerbsCommunications</span><span class="sxs-lookup"><span data-stu-id="c5ff6-130">System.Management.Automation.VerbsCommunications</span></span>](/dotnet/api/System.Management.Automation.VerbsCommunications)

- [<span data-ttu-id="c5ff6-131">System.Management.Automation.VerbsData</span><span class="sxs-lookup"><span data-stu-id="c5ff6-131">System.Management.Automation.VerbsData</span></span>](/dotnet/api/System.Management.Automation.VerbsData)

- [<span data-ttu-id="c5ff6-132">System.Management.Automation.VerbsDiagnostic</span><span class="sxs-lookup"><span data-stu-id="c5ff6-132">System.Management.Automation.VerbsDiagnostic</span></span>](/dotnet/api/System.Management.Automation.VerbsDiagnostic)

- [<span data-ttu-id="c5ff6-133">System.Management.Automation.VerbsLifeCycle</span><span class="sxs-lookup"><span data-stu-id="c5ff6-133">System.Management.Automation.VerbsLifeCycle</span></span>](/dotnet/api/System.Management.Automation.VerbsLifeCycle)

- [<span data-ttu-id="c5ff6-134">System.Management.Automation.VerbsSecurity</span><span class="sxs-lookup"><span data-stu-id="c5ff6-134">System.Management.Automation.VerbsSecurity</span></span>](/dotnet/api/System.Management.Automation.VerbsSecurity)

- [<span data-ttu-id="c5ff6-135">System.Management.Automation.VerbsOther</span><span class="sxs-lookup"><span data-stu-id="c5ff6-135">System.Management.Automation.VerbsOther</span></span>](/dotnet/api/System.Management.Automation.VerbsOther)

<span data-ttu-id="c5ff6-136">有关批准的动词名称的详细信息，请参阅[Cmdlet 谓词](./approved-verbs-for-windows-powershell-commands.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-136">For more information about the approved verb names, see [Cmdlet Verbs](./approved-verbs-for-windows-powershell-commands.md).</span></span>

<span data-ttu-id="c5ff6-137">用户需要一组可发现和预期的 cmdlet 名称。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-137">Users need a set of discoverable and expected cmdlet names.</span></span> <span data-ttu-id="c5ff6-138">使用相应的动词，以便用户能够进行快速评估的 cmdlet 的用途并轻松地发现系统的功能。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-138">Use the appropriate verb so that the user can make a quick assessment of what a cmdlet does and to easily discover the capabilities of the system.</span></span> <span data-ttu-id="c5ff6-139">例如，以下命令行命令将获取名称以"start"开头的系统上的所有命令列表： `get-command start-*`。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-139">For example, the following command-line command gets a list of all the commands on the system whose names begin with "start": `get-command start-*`.</span></span> <span data-ttu-id="c5ff6-140">使用中的名词 cmdlet 中将 cmdlet 与其他 cmdlet 区分开来。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-140">Use the nouns in your cmdlets to differentiate your cmdlets from other cmdlets.</span></span> <span data-ttu-id="c5ff6-141">（） 名词，指示将对其执行操作的资源。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-141">The noun indicates the resource on which the operation will be performed.</span></span> <span data-ttu-id="c5ff6-142">谓词被表示本身的操作。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-142">The operation itself is represented by the verb.</span></span>

### <a name="cmdlet-names-characters-that-cannot-be-used-rd02"></a><span data-ttu-id="c5ff6-143">Cmdlet 名称：不能使用的字符 (RD02)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-143">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>

<span data-ttu-id="c5ff6-144">当命名 cmdlet 时，则不使用任何以下特殊字符。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-144">When you name cmdlets, do not use any of the following special characters.</span></span>

|<span data-ttu-id="c5ff6-145">字符</span><span class="sxs-lookup"><span data-stu-id="c5ff6-145">Character</span></span>|<span data-ttu-id="c5ff6-146">名称</span><span class="sxs-lookup"><span data-stu-id="c5ff6-146">Name</span></span>|
|---------------|----------|
|#|<span data-ttu-id="c5ff6-147">数字符号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-147">number sign</span></span>|
|<span data-ttu-id="c5ff6-148">、</span><span class="sxs-lookup"><span data-stu-id="c5ff6-148">,</span></span>|<span data-ttu-id="c5ff6-149">逗号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-149">comma</span></span>|
|<span data-ttu-id="c5ff6-150">()</span><span class="sxs-lookup"><span data-stu-id="c5ff6-150">()</span></span>|<span data-ttu-id="c5ff6-151">括号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-151">parentheses</span></span>|
|{}|<span data-ttu-id="c5ff6-152">大括号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-152">braces</span></span>|
|<span data-ttu-id="c5ff6-153">[]</span><span class="sxs-lookup"><span data-stu-id="c5ff6-153">[]</span></span>|<span data-ttu-id="c5ff6-154">方括号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-154">brackets</span></span>|
|&|<span data-ttu-id="c5ff6-155">and 符</span><span class="sxs-lookup"><span data-stu-id="c5ff6-155">ampersand</span></span>|
|-|<span data-ttu-id="c5ff6-156">连字符**注意：** 可以使用连字符分隔中名词谓词，但不是能在名词或谓词中使用。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-156">hyphen **Note:**  The hyphen can be used to separate the verb from the noun, but it cannot be used within the noun or within the verb.</span></span>|
|/|<span data-ttu-id="c5ff6-157">斜杠标记</span><span class="sxs-lookup"><span data-stu-id="c5ff6-157">slash mark</span></span>|
|<span data-ttu-id="c5ff6-158">\|反斜杠</span><span class="sxs-lookup"><span data-stu-id="c5ff6-158">\|backslash</span></span>|
|$|<span data-ttu-id="c5ff6-159">美元符号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-159">dollar sign</span></span>|
|^|<span data-ttu-id="c5ff6-160">插入符号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-160">caret</span></span>|
|<span data-ttu-id="c5ff6-161">;</span><span class="sxs-lookup"><span data-stu-id="c5ff6-161">;</span></span>|<span data-ttu-id="c5ff6-162">以分号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-162">semicolon</span></span>|
|<span data-ttu-id="c5ff6-163">：</span><span class="sxs-lookup"><span data-stu-id="c5ff6-163">:</span></span>|<span data-ttu-id="c5ff6-164">冒号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-164">colon</span></span>|
|<span data-ttu-id="c5ff6-165">"</span><span class="sxs-lookup"><span data-stu-id="c5ff6-165">"</span></span>|<span data-ttu-id="c5ff6-166">双引号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-166">double quotation mark</span></span>|
|<span data-ttu-id="c5ff6-167">'</span><span class="sxs-lookup"><span data-stu-id="c5ff6-167">'</span></span>|<span data-ttu-id="c5ff6-168">单引号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-168">single quotation mark</span></span>|
|<>|<span data-ttu-id="c5ff6-169">尖括号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-169">angle brackets</span></span>|
|<span data-ttu-id="c5ff6-170">&#124;</span><span class="sxs-lookup"><span data-stu-id="c5ff6-170">&#124;</span></span>|<span data-ttu-id="c5ff6-171">垂直条</span><span class="sxs-lookup"><span data-stu-id="c5ff6-171">vertical bar</span></span>|
|<span data-ttu-id="c5ff6-172">?</span><span class="sxs-lookup"><span data-stu-id="c5ff6-172">?</span></span>|<span data-ttu-id="c5ff6-173">问号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-173">question mark</span></span>|
|@|<span data-ttu-id="c5ff6-174">at 符号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-174">at sign</span></span>|
|<span data-ttu-id="c5ff6-175">| 返回时钟周期 （重音符）</span><span class="sxs-lookup"><span data-stu-id="c5ff6-175">\`|back tick (grave accent)</span></span>|
|*|<span data-ttu-id="c5ff6-176">星号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-176">asterisk</span></span>|
|%|<span data-ttu-id="c5ff6-177">百分比符号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-177">percent sign</span></span>|
|+|<span data-ttu-id="c5ff6-178">加号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-178">plus sign</span></span>|
|=|<span data-ttu-id="c5ff6-179">等号</span><span class="sxs-lookup"><span data-stu-id="c5ff6-179">equals sign</span></span>|
|~|<span data-ttu-id="c5ff6-180">波形符</span><span class="sxs-lookup"><span data-stu-id="c5ff6-180">tilde</span></span>|

### <a name="parameters-names-that-cannot-be-used-rd03"></a><span data-ttu-id="c5ff6-181">不能使用的参数名称 (RD03)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-181">Parameters Names that cannot be Used (RD03)</span></span>

<span data-ttu-id="c5ff6-182">Windows PowerShell 提供了一组通用的所有 cmdlet 参数加上在特定情况下添加的其他参数。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-182">Windows PowerShell provides a common set a parameters to all cmdlets plus additional parameters that are added in specific situations.</span></span> <span data-ttu-id="c5ff6-183">设计自己的 cmdlet 时不能使用以下名称：确认，Debug、 ErrorAction、 ErrorVariable、 OutBuffer OutVariable、 WarningAction、 WarningVariable、 WhatIf、 UseTransaction，和详细。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-183">When designing your own cmdlets you cannot use the following names: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, and Verbose.</span></span> <span data-ttu-id="c5ff6-184">有关这些参数的详细信息，请参阅[通用参数名称](./common-parameter-names.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-184">For more information about these parameters, see [Common Parameter Names](./common-parameter-names.md).</span></span>

### <a name="support-confirmation-requests-rd04"></a><span data-ttu-id="c5ff6-185">支持确认请求 (RD04)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-185">Support Confirmation Requests (RD04)</span></span>

<span data-ttu-id="c5ff6-186">对于执行修改系统的操作的 cmdlet，它们应调用[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法来请求确认，并在特殊情况下调用[System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-186">For cmdlets that perform an operation that modifies the system, they should call the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method to request confirmation, and in special cases call the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method.</span></span> <span data-ttu-id="c5ff6-187">( [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)后，才应调用方法[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)调用方法。)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-187">(The [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method should be called only after the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method is called.)</span></span>

<span data-ttu-id="c5ff6-188">若要进行这些调用必须指定该 cmdlet，它支持通过设置确认请求`SupportsShouldProcess`Cmdlet 属性的关键字。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-188">To make these calls the cmdlet must specify that it supports confirmation requests by setting the `SupportsShouldProcess` keyword of the Cmdlet attribute.</span></span> <span data-ttu-id="c5ff6-189">有关设置此属性的详细信息，请参阅[Cmdlet 特性声明](./cmdlet-attribute-declaration.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-189">For more information about setting this attribute, see [Cmdlet Attribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

> [!NOTE]
> <span data-ttu-id="c5ff6-190">如果在 cmdlet 类 Cmdlet 属性指示该 cmdlet 支持调用[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法，并且该 cmdlet 无法调用[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法，用户可能意外修改系统。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-190">If the Cmdlet attribute of the cmdlet class indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, and the cmdlet fails to make the call to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, the user could modify the system unexpectedly.</span></span>

<span data-ttu-id="c5ff6-191">使用[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)系统进行任何修改的方法。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-191">Use the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method for any system modification.</span></span> <span data-ttu-id="c5ff6-192">用户首选项和`WhatIf`参数控制[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-192">A user preference and the `WhatIf` parameter control the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="c5ff6-193">与此相反， [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)调用具有潜在危险的修改，执行其他检查。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-193">In contrast, the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) call performs an additional check for potentially dangerous modifications.</span></span> <span data-ttu-id="c5ff6-194">此方法不受任何用户首选项或`WhatIf`参数。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-194">This method is not controlled by any user preference or the `WhatIf` parameter.</span></span> <span data-ttu-id="c5ff6-195">如果你的 cmdlet 调用[System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法，它应具有`Force`参数跳过对这两种方法的调用和，继续执行该操作。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-195">If your cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method, it should have a `Force` parameter that bypasses the calls to these two methods and that proceeds with the operation.</span></span> <span data-ttu-id="c5ff6-196">这非常重要，因为它允许您以非交互式脚本和主机中使用的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-196">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span>

<span data-ttu-id="c5ff6-197">如果你 cmdlet 支持这些调用，用户可以确定是否应实际执行该操作。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-197">If your cmdlets support these calls, the user can determine whether the action should actually be performed.</span></span> <span data-ttu-id="c5ff6-198">例如， [Stop-process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet 可调用[System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue)方法之前停止的一组关键进程，包括 Winlogon，系统和Spoolsv 进程。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-198">For example, the [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method before it stops a set of critical processes, including the System, Winlogon, and Spoolsv processes.</span></span>

<span data-ttu-id="c5ff6-199">支持这些方法的详细信息，请参阅[请求确认](./requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-199">For more information about supporting these methods, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="support-force-parameter-for-interactive-sessions-rd05"></a><span data-ttu-id="c5ff6-200">为交互式会话 (RD05) 支持 Force 参数</span><span class="sxs-lookup"><span data-stu-id="c5ff6-200">Support Force Parameter for Interactive Sessions (RD05)</span></span>

<span data-ttu-id="c5ff6-201">如果以交互方式使用 cmdlet，则始终提供 Force 参数来重写的交互操作，如提示或读取行输入）。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-201">If your cmdlet is used interactively, always provide a Force parameter to override the interactive actions, such as prompts or reading lines of input).</span></span> <span data-ttu-id="c5ff6-202">这非常重要，因为它允许您以非交互式脚本和主机中使用的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-202">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span> <span data-ttu-id="c5ff6-203">以下方法可以实现的交互式主机。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-203">The following methods can be implemented by an interactive host.</span></span>

- [<span data-ttu-id="c5ff6-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span><span class="sxs-lookup"><span data-stu-id="c5ff6-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.Prompt)

- [<span data-ttu-id="c5ff6-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="c5ff6-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForChoice)

- [<span data-ttu-id="c5ff6-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="c5ff6-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.IHostUISupportsMultipleChoiceSelection.PromptForChoice)

- [<span data-ttu-id="c5ff6-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span><span class="sxs-lookup"><span data-stu-id="c5ff6-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForCredential)

- [<span data-ttu-id="c5ff6-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span><span class="sxs-lookup"><span data-stu-id="c5ff6-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLine)

- [<span data-ttu-id="c5ff6-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span><span class="sxs-lookup"><span data-stu-id="c5ff6-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLineAsSecureString)

### <a name="document-output-objects-rd06"></a><span data-ttu-id="c5ff6-210">文档输出对象 (RD06)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-210">Document Output Objects (RD06)</span></span>

<span data-ttu-id="c5ff6-211">Windows PowerShell 使用写入管道的对象。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-211">Windows PowerShell uses the objects that are written to the pipeline.</span></span> <span data-ttu-id="c5ff6-212">为了使用户可以利用每个 cmdlet 返回的对象，必须文档将返回的对象和必须文档使用为这些返回的对象的成员。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-212">In order for users to take advantage of the objects that are returned by each cmdlet, you must document the objects that are returned, and you must document what the members of those returned objects are used for.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="c5ff6-213">代码指南</span><span class="sxs-lookup"><span data-stu-id="c5ff6-213">Code Guidelines</span></span>

<span data-ttu-id="c5ff6-214">编写 cmdlet 代码时，必须遵循以下准则。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-214">The following guidelines must be followed when writing cmdlet code.</span></span> <span data-ttu-id="c5ff6-215">找到适用于您的具体情况的代码准则，请务必查看类似的指导原则的设计指南。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-215">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="derive-from-the-cmdlet-or-pscmdlet-classes-rc01"></a><span data-ttu-id="c5ff6-216">派生的 Cmdlet 或 PSCmdlet 类 (RC01)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-216">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>

<span data-ttu-id="c5ff6-217">Cmdlet 必须或者派生[System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)或[System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)基类。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-217">A cmdlet must derive from either the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) or [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="c5ff6-218">派生的 Cmdlet [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet)类不依赖于 Windows PowerShell 运行时。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-218">Cmdlets that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class do not depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="c5ff6-219">它们可以直接从任何 Microsoft.NET Framework 语言调用。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-219">They can be called directly from any Microsoft .NET Framework language.</span></span> <span data-ttu-id="c5ff6-220">派生的 Cmdlet [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet)类依赖于 Windows PowerShell 运行时。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-220">Cmdlets that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="c5ff6-221">因此，它们在内执行一个运行空间。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-221">Therefore, they execute within a runspace.</span></span>

<span data-ttu-id="c5ff6-222">您实现的所有 cmdlet 类必须都是公共类。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-222">All cmdlet classes that you implement must be public classes.</span></span> <span data-ttu-id="c5ff6-223">有关这些 cmdlet 类的详细信息，请参阅[Cmdlet 概述](./cmdlet-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-223">For more information about these cmdlet classes, see [Cmdlet Overview](./cmdlet-overview.md).</span></span>

### <a name="specify-the-cmdlet-attribute-rc02"></a><span data-ttu-id="c5ff6-224">指定 Cmdlet 属性 (RC02)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-224">Specify the Cmdlet Attribute (RC02)</span></span>

<span data-ttu-id="c5ff6-225">若要识别的 Windows PowerShell cmdlet，必须使用 Cmdlet 特性修饰其.NET Framework 类。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-225">For a cmdlet to be recognized by Windows PowerShell, its .NET Framework class must be decorated with the Cmdlet attribute.</span></span> <span data-ttu-id="c5ff6-226">此属性指定该 cmdlet 的以下功能。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-226">This attribute specifies the following features of the cmdlet.</span></span>

- <span data-ttu-id="c5ff6-227">标识该 cmdlet 的动词-名词对。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-227">The verb-and-noun pair that identifies the cmdlet.</span></span>

- <span data-ttu-id="c5ff6-228">指定多个参数集时使用默认参数集。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-228">The default parameter set that is used when multiple parameter sets are specified.</span></span> <span data-ttu-id="c5ff6-229">如果 Windows PowerShell 不具有足够的信息来确定哪些参数设置为使用，则使用默认参数集。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-229">The default parameter set is used when Windows PowerShell does not have enough information to determine which parameter set to use.</span></span>

- <span data-ttu-id="c5ff6-230">指示该 cmdlet 支持调用[System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess)方法。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-230">Indicates if the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="c5ff6-231">该 cmdlet 对系统进行更改之前，此方法会向用户显示一条确认消息。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-231">This method displays a confirmation message to the user before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="c5ff6-232">有关如何建立确认请求的详细信息，请参阅[请求确认](./requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-232">For more information about how confirmation requests are made, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

- <span data-ttu-id="c5ff6-233">指示与确认消息关联的操作的影响级别 （或严重性）。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-233">Indicate the impact level (or severity) of the action associated with the confirmation message.</span></span> <span data-ttu-id="c5ff6-234">在大多数情况下，应使用的介质的默认值。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-234">In most cases, the default value of Medium should be used.</span></span> <span data-ttu-id="c5ff6-235">有关如何影响级别影响向用户显示的确认请求的详细信息，请参阅[请求确认](./requesting-confirmation-from-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-235">For more information about how the impact level affects the confirmation requests that are displayed to the user, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="c5ff6-236">有关如何声明 cmdlet 属性的详细信息，请参阅[CmdletAttribute 声明](./cmdlet-attribute-declaration.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-236">For more information about how to declare the cmdlet attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="override-an-input-processing-method-rc03"></a><span data-ttu-id="c5ff6-237">重写输入处理方法 (RC03)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-237">Override an Input Processing Method (RC03)</span></span>

<span data-ttu-id="c5ff6-238">若要在 Windows PowerShell 环境中参与 cmdlet，则必须重写至少一个以下*输入处理方法*。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-238">For the cmdlet to participate in the Windows PowerShell environment, it must override at least one of the following *input processing methods*.</span></span>

<span data-ttu-id="c5ff6-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing)调用一次，此方法，它用于提供预处理功能。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) This method is called one time, and it is used to provide pre-processing functionality.</span></span>

<span data-ttu-id="c5ff6-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)多次调用此方法，它用于提供按记录功能。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) This method is called multiple times, and it is used to provide record-by-record functionality.</span></span>

<span data-ttu-id="c5ff6-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing)调用一次，此方法，它用于提供后续处理功能。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) This method is called one time, and it is used to provide post-processing functionality.</span></span>

### <a name="specify-the-outputtype-attribute-rc04"></a><span data-ttu-id="c5ff6-242">指定 OutputType 属性 (RC04)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-242">Specify the OutputType Attribute (RC04)</span></span>

<span data-ttu-id="c5ff6-243">（在 Windows PowerShell 2.0 中引入） 的 OutputType 属性指定您 cmdlet 将返回到管道的.NET Framework 类型。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-243">The OutputType attribute (introduced in Windows PowerShell 2.0) specifies the .NET Framework type that your cmdlet returns to the pipeline.</span></span> <span data-ttu-id="c5ff6-244">通过指定 cmdlet 的输出类型可以将返回的对象在 cmdlet 更容易地发现其他 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-244">By specifying the output type of your cmdlets you make the objects returned by your cmdlet more discoverable by other cmdlets.</span></span> <span data-ttu-id="c5ff6-245">修饰具有此特性在 cmdlet 类的详细信息，请参阅[OutputType 特性声明](./outputtype-attribute-declaration.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-245">For more information about decorating the cmdlet class with this attribute, see [OutputType Attribute Declaration](./outputtype-attribute-declaration.md).</span></span>

### <a name="do-not-retain-handles-to-output-objects-rc05"></a><span data-ttu-id="c5ff6-246">不保留输出对象 (RC05) 的句柄</span><span class="sxs-lookup"><span data-stu-id="c5ff6-246">Do Not Retain Handles to Output Objects (RC05)</span></span>

<span data-ttu-id="c5ff6-247">你的 cmdlet 应不保留任何对象的句柄传递给[System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject)方法。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-247">Your cmdlet should not retain any handles to the objects that are passed to the [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="c5ff6-248">这些对象传递给管道中下一个 cmdlet 或脚本使用它们。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-248">These objects are passed to the next cmdlet in the pipeline, or they are used by a script.</span></span> <span data-ttu-id="c5ff6-249">如果保留对象的句柄，两个实体将拥有每个对象，这会导致错误。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-249">If you retain the handles to the objects, two entities will own each object, which causes errors.</span></span>

### <a name="handle-errors-robustly-rc06"></a><span data-ttu-id="c5ff6-250">可靠地处理错误 (RC06)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-250">Handle Errors Robustly (RC06)</span></span>

<span data-ttu-id="c5ff6-251">管理环境本质上是检测，并会对您管理的系统的重要更改。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-251">An administration environment inherently detects and makes important changes to the system that you are administering.</span></span> <span data-ttu-id="c5ff6-252">因此，非常重要 cmdlet 正确地处理错误。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-252">Therefore, it is vital that cmdlets handle errors correctly.</span></span> <span data-ttu-id="c5ff6-253">错误记录的详细信息，请参阅[Windows PowerShell 错误报告](./error-reporting-concepts.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-253">For more information about error records, see [Windows PowerShell Error Reporting](./error-reporting-concepts.md).</span></span>

- <span data-ttu-id="c5ff6-254">当某个错误阻止 cmdlet 继续处理任何更多记录时，它是一个终止错误。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-254">When an error prevents a cmdlet from continuing to process any more records, it is a terminating error.</span></span> <span data-ttu-id="c5ff6-255">该 cmdlet 必须调用[System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)引用方法[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)对象。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-255">The cmdlet must call the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="c5ff6-256">如果 cmdlet 不捕获异常，Windows PowerShell 运行时本身将引发一个终止错误包含较少的信息。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-256">If an exception is not caught by the cmdlet, the Windows PowerShell runtime itself throws a terminating error that contains less information.</span></span>

- <span data-ttu-id="c5ff6-257">对于不会停止操作在下一个非终止错误来自管道 （例如，a 记录的其他进程生成），该 cmdlet 的记录必须调用[System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)引用方法[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)对象。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-257">For a non-terminating error that does not stop operation on the next record that is coming from the pipeline (for example, a record produced by a different process), the cmdlet must call the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="c5ff6-258">非终止错误的一个示例是如果在特定的进程无法停止，则会发生的错误。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-258">An example of a non-terminating error is the error that occurs if a particular process fails to stop.</span></span> <span data-ttu-id="c5ff6-259">调用[System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)方法允许用户以一致地执行请求的操作，并保留失败的特定操作的信息。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-259">Calling the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method allows the user to consistently perform the actions requested and to retain the information for particular actions that fail.</span></span> <span data-ttu-id="c5ff6-260">你的 cmdlet 应尽可能独立处理每条记录。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-260">Your cmdlet should handle each record as independently as possible.</span></span>

- <span data-ttu-id="c5ff6-261">[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)对象，该引用的对象[System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError)和[System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError)方法需要在其核心异常。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-261">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that is referenced by the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) and [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) methods requires an exception at its core.</span></span> <span data-ttu-id="c5ff6-262">确定要使用的异常时，请遵循.NET Framework 设计准则。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-262">Follow the .NET Framework design guidelines when you determine the exception to use.</span></span> <span data-ttu-id="c5ff6-263">如果错误是在语义上与现有异常不同，使用该异常或派生自该异常。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-263">If the error is semantically the same as an existing exception, use that exception or derive from that exception.</span></span> <span data-ttu-id="c5ff6-264">否则，派生的新异常或直接从异常层次结构[System.Exception](/dotnet/api/System.Exception)类型。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-264">Otherwise, derive a new exception or exception hierarchy directly from the [System.Exception](/dotnet/api/System.Exception) type.</span></span>

<span data-ttu-id="c5ff6-265">[System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord)对象也需要进行分组的用户错误的错误类别。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-265">An [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object also requires an error category that groups errors for the user.</span></span> <span data-ttu-id="c5ff6-266">用户可以查看基于类别的值设置的错误`$ErrorView`CategoryView 的 shell 变量。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-266">The user can view errors based on the category by setting the value of the `$ErrorView` shell variable to CategoryView.</span></span> <span data-ttu-id="c5ff6-267">可能的类别定义由[System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory)枚举。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-267">The possible categories are defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span>

- <span data-ttu-id="c5ff6-268">如果某个 cmdlet 创建一个新线程，并且在该线程中运行的代码将引发未处理的异常，Windows PowerShell 将不会捕获该错误，并将终止进程。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-268">If a cmdlet creates a new thread, and if the code that is running in that thread throws an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span>

- <span data-ttu-id="c5ff6-269">如果一个对象将代码中未经处理的异常将导致其析构函数，Windows PowerShell 将不会捕获该错误，并将终止进程。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-269">If an object has code in its destructor that causes an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span> <span data-ttu-id="c5ff6-270">如果对象调用 Dispose 方法会导致未经处理的异常也会发生这种情况。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-270">This also occurs if an object calls Dispose methods that cause an unhandled exception.</span></span>

### <a name="use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07"></a><span data-ttu-id="c5ff6-271">使用 Windows PowerShell 模块来部署 Cmdlet (RC07)</span><span class="sxs-lookup"><span data-stu-id="c5ff6-271">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>

<span data-ttu-id="c5ff6-272">创建一个 Windows PowerShell 模块来打包和部署 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-272">Create a Windows PowerShell module to package and deploy your cmdlets.</span></span> <span data-ttu-id="c5ff6-273">在 Windows PowerShell 2.0 中引入的模块的支持。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-273">Support for modules is introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="c5ff6-274">可以使用二进制模块文件 （这是非常有用测试 cmdlet 时），作为直接包含的 cmdlet 类的程序集，或者可以创建引用 cmdlet 程序集的模块清单。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-274">You can use the assemblies that contain your cmdlet classes directly as binary module files (this is very useful when testing your cmdlets), or you can create a module manifest that references the cmdlet assemblies.</span></span> <span data-ttu-id="c5ff6-275">（您还可以添加现有管理单元中程序集时使用的模块。）有关模块的详细信息，请参阅[编写 Windows PowerShell 模块](../module/writing-a-windows-powershell-module.md)。</span><span class="sxs-lookup"><span data-stu-id="c5ff6-275">(You can also add existing snap-in assemblies when using modules.) For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="c5ff6-276">另请参阅</span><span class="sxs-lookup"><span data-stu-id="c5ff6-276">See Also</span></span>

[<span data-ttu-id="c5ff6-277">强烈建议的开发指导原则</span><span class="sxs-lookup"><span data-stu-id="c5ff6-277">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="c5ff6-278">咨询开发指导原则</span><span class="sxs-lookup"><span data-stu-id="c5ff6-278">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="c5ff6-279">编写 Windows PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="c5ff6-279">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
