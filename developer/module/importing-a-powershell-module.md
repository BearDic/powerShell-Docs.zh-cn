---
title: 正在导入 PowerShell 模块 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 697791b3-2135-4a39-b9d7-8566ed67acf2
caps.latest.revision: 13
ms.openlocfilehash: bb5d036e5658c365a4fafa2cac05c0bba9f87019
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/03/2019
ms.locfileid: "56854053"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="c68c1-102">导入 PowerShell 模块</span><span class="sxs-lookup"><span data-stu-id="c68c1-102">Importing a PowerShell Module</span></span>

<span data-ttu-id="c68c1-103">一次在已安装模块的系统上，则将可能想要导入模块。</span><span class="sxs-lookup"><span data-stu-id="c68c1-103">Once your have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="c68c1-104">导入是将该模块加载到活动内存的进程，以便用户可以在其 PowerShell 会话中访问该模块。</span><span class="sxs-lookup"><span data-stu-id="c68c1-104">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="c68c1-105">在 PowerShell 2.0 中，你可以导入一个新安装 PowerShell 模块，通过调用[导入模块](/powershell/module/Microsoft.PowerShell.Core/Import-Module)cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c68c1-105">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="c68c1-106">在 PowerShell 3.0 中，PowerShell 是能够隐式导入模块时由用户调用的函数或模块中的 cmdlet 之一。</span><span class="sxs-lookup"><span data-stu-id="c68c1-106">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="c68c1-107">请注意，这两个版本假定能够找到它; PowerShell 所在的位置中安装模块有关详细信息，请参阅[安装 PowerShell 模块](./installing-a-powershell-module.md)。</span><span class="sxs-lookup"><span data-stu-id="c68c1-107">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span> <span data-ttu-id="c68c1-108">可以使用模块清单来限制导出您的模块中的哪些部分，并可以使用参数`Import-Module`调用来限制哪些部分是导入。</span><span class="sxs-lookup"><span data-stu-id="c68c1-108">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="c68c1-109">导入一个单元 (PowerShell 1.0)</span><span class="sxs-lookup"><span data-stu-id="c68c1-109">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="c68c1-110">PowerShell 1.0 中不存在的模块： 因此，必须进行注册和使用管理单元。但是，建议不要在此情况下，使用此技术通常更轻松地安装并导入模块一样。</span><span class="sxs-lookup"><span data-stu-id="c68c1-110">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="c68c1-111">有关详细信息，请参阅[如何创建一个 Windows PowerShell 管理单元](../cmdlet/how-to-create-a-windows-powershell-snap-in.md)。</span><span class="sxs-lookup"><span data-stu-id="c68c1-111">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="c68c1-112">导入的模块导入模块 (PowerShell 2.0)</span><span class="sxs-lookup"><span data-stu-id="c68c1-112">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="c68c1-113">PowerShell 2.0 使用适当地命名[导入模块](/powershell/module/Microsoft.PowerShell.Core/Import-Module)cmdlet 导入的模块。</span><span class="sxs-lookup"><span data-stu-id="c68c1-113">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="c68c1-114">运行此 cmdlet 时，Windows PowerShell 中搜索指定的目录中的指定模块`PSModulePath`变量。</span><span class="sxs-lookup"><span data-stu-id="c68c1-114">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="c68c1-115">找到指定的目录后，Windows PowerShell 中搜索文件按以下顺序： 模块清单文件 (.psd1)、 脚本模块文件 (.psm1) 二进制模块文件 (.dll)。</span><span class="sxs-lookup"><span data-stu-id="c68c1-115">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="c68c1-116">有关将目录添加到搜索的详细信息，请参阅[修改 PSModulePath 安装路径](./modifying-the-psmodulepath-installation-path.md)。</span><span class="sxs-lookup"><span data-stu-id="c68c1-116">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span> <span data-ttu-id="c68c1-117">以下代码介绍了如何导入模块：</span><span class="sxs-lookup"><span data-stu-id="c68c1-117">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="c68c1-118">假设位于 myModule `PSModulePath`，PowerShell 会将 myModule 加载到活动内存。</span><span class="sxs-lookup"><span data-stu-id="c68c1-118">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="c68c1-119">如果不位于 myModule`PSModulePath`路径，您可以仍显式告知 PowerShell 在哪里可以找到它：</span><span class="sxs-lookup"><span data-stu-id="c68c1-119">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="c68c1-120">此外可以使用-verbose 参数来标识出该模块，要导出的内容和内容要导入到活动内存中。</span><span class="sxs-lookup"><span data-stu-id="c68c1-120">You can also use the -verbose parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="c68c1-121">导出和导入限制向用户公开的内容： 的区别是谁在控制可见性。</span><span class="sxs-lookup"><span data-stu-id="c68c1-121">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="c68c1-122">实质上是，导出模块中的代码由控制。</span><span class="sxs-lookup"><span data-stu-id="c68c1-122">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="c68c1-123">导入受与此相反，`Import-Module`调用。</span><span class="sxs-lookup"><span data-stu-id="c68c1-123">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="c68c1-124">有关详细信息，请参阅**限制成员已导入的**下文。</span><span class="sxs-lookup"><span data-stu-id="c68c1-124">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="c68c1-125">隐式导入模块 (PowerShell 3.0)</span><span class="sxs-lookup"><span data-stu-id="c68c1-125">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="c68c1-126">从 Windows PowerShell 3.0 开始，模块会自动导入命令中使用的任何 cmdlet 或模块中的函数时。</span><span class="sxs-lookup"><span data-stu-id="c68c1-126">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="c68c1-127">此功能适用于此的值中包含的目录中的任何模块**PSModulePath**环境变量。</span><span class="sxs-lookup"><span data-stu-id="c68c1-127">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="c68c1-128">如果不保存你的模块上的有效路径但是，您可以仍将它们加载使用显式[导入模块](/powershell/module/Microsoft.PowerShell.Core/Import-Module)前面介绍的选项。</span><span class="sxs-lookup"><span data-stu-id="c68c1-128">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="c68c1-129">以下操作触发自动导入模块，也称为"模块自动加载。"</span><span class="sxs-lookup"><span data-stu-id="c68c1-129">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="c68c1-130">在命令中使用 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c68c1-130">Using a cmdlet in a command.</span></span> <span data-ttu-id="c68c1-131">例如，如果键入`Get-ExecutionPolicy`将包含的 Microsoft.PowerShell.Security 模块导入`Get-ExecutionPolicy`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c68c1-131">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="c68c1-132">使用[Get-command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet 来获取命令。</span><span class="sxs-lookup"><span data-stu-id="c68c1-132">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span>  <span data-ttu-id="c68c1-133">例如，如果键入`Get-Command Get-JobTrigger`导入**PSScheduledJob**包含模块`Get-JobTrigger`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c68c1-133">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="c68c1-134">一个`Get-Command`包含通配符的命令被视为可发现并不会触发导入的模块。</span><span class="sxs-lookup"><span data-stu-id="c68c1-134">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="c68c1-135">使用[Get-help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet 来获取有关 cmdlet 的帮助。</span><span class="sxs-lookup"><span data-stu-id="c68c1-135">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="c68c1-136">例如，如果键入`Get-Help Get-WinEvent`导入包含 Microsoft.PowerShell.Diagnostics 模块`Get-WinEvent`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c68c1-136">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="c68c1-137">若要支持自动导入模块， `Get-Command` cmdlet 获取所有 cmdlet 和函数中所有已安装的模块，即使该模块未导入会话。</span><span class="sxs-lookup"><span data-stu-id="c68c1-137">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="c68c1-138">有关详细信息，请参阅帮助主题[Get-command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c68c1-138">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="c68c1-139">导入进程</span><span class="sxs-lookup"><span data-stu-id="c68c1-139">The Importing Process</span></span>

<span data-ttu-id="c68c1-140">导入模块时，为该模块，请创建一个新的会话状态和一个[System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo)在内存中创建对象。</span><span class="sxs-lookup"><span data-stu-id="c68c1-140">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="c68c1-141">为导入的每个模块创建会话状态 （包括根模块和任何嵌套的模块）。</span><span class="sxs-lookup"><span data-stu-id="c68c1-141">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="c68c1-142">从根模块，其中包括被导出到的任何嵌套模块的根模块的任何成员导出的成员然后导入到调用方的会话状态。</span><span class="sxs-lookup"><span data-stu-id="c68c1-142">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="c68c1-143">从模块导出的成员的元数据具有模块名称属性。</span><span class="sxs-lookup"><span data-stu-id="c68c1-143">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="c68c1-144">导出它们的模块的名称填充此属性。</span><span class="sxs-lookup"><span data-stu-id="c68c1-144">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="c68c1-145">如果导出的成员的名称使用未经批准的谓词或如果该成员的名称使用受限的字符，则会显示警告时[导入模块](/powershell/module/Microsoft.PowerShell.Core/Import-Module)运行 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c68c1-145">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="c68c1-146">默认情况下[导入模块](/powershell/module/Microsoft.PowerShell.Core/Import-Module)cmdlet 不返回到管道的任何对象。</span><span class="sxs-lookup"><span data-stu-id="c68c1-146">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="c68c1-147">但是，该 cmdlet 支持`PassThru`可以用于返回参数[System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo)导入的每个模块的对象。</span><span class="sxs-lookup"><span data-stu-id="c68c1-147">However, the cmdlet supports a `PassThru` parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="c68c1-148">若要将输出发送到主机，用户应运行[Write-host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c68c1-148">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="c68c1-149">限制导入的成员</span><span class="sxs-lookup"><span data-stu-id="c68c1-149">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="c68c1-150">通过使用导入模块时[导入模块](/powershell/module/Microsoft.PowerShell.Core/Import-Module)cmdlet，默认情况下，所有导出的模块成员导入到会话，包括任何命令导出到由嵌套模块的模块。</span><span class="sxs-lookup"><span data-stu-id="c68c1-150">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="c68c1-151">默认情况下，不导出变量和别名。</span><span class="sxs-lookup"><span data-stu-id="c68c1-151">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="c68c1-152">若要限制导出的成员，请使用[模块清单](./how-to-write-a-powershell-module-manifest.md)。</span><span class="sxs-lookup"><span data-stu-id="c68c1-152">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span> <span data-ttu-id="c68c1-153">若要限制将导入的成员，请使用以下参数的`Import-Module`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="c68c1-153">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="c68c1-154">`Function`：此参数将限制导出的函数。</span><span class="sxs-lookup"><span data-stu-id="c68c1-154">`Function`: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="c68c1-155">（如果使用的模块清单，请参阅 FunctionsToExport 密钥。）</span><span class="sxs-lookup"><span data-stu-id="c68c1-155">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="c68c1-156">`Cmdlet`：此参数将限制 （如果你使用模块清单，请参阅 CmdletsToExport 密钥。） 导出的 cmdlet</span><span class="sxs-lookup"><span data-stu-id="c68c1-156">`Cmdlet`: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="c68c1-157">`Variable`：此参数将限制 （如果你使用模块清单，请参阅 VariablesToExport 密钥。） 导出的变量</span><span class="sxs-lookup"><span data-stu-id="c68c1-157">`Variable`: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="c68c1-158">`Alias`：此参数将限制 （如果你使用模块清单，请参阅 AliasesToExport 密钥。） 导出的别名</span><span class="sxs-lookup"><span data-stu-id="c68c1-158">`Alias`: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="c68c1-159">另请参阅</span><span class="sxs-lookup"><span data-stu-id="c68c1-159">See Also</span></span>

[<span data-ttu-id="c68c1-160">编写 Windows PowerShell 模块</span><span class="sxs-lookup"><span data-stu-id="c68c1-160">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
