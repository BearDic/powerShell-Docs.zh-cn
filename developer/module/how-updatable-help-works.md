---
title: 可更新帮助的工作原理 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 7674636e-a0f2-4587-bfc5-dd3e6ce5489e
caps.latest.revision: 6
ms.openlocfilehash: 5b6ae54ee6c843996c875189b6ee553be5e4f614
ms.sourcegitcommit: 5990f04b8042ef2d8e571bec6d5b051e64c9921c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/12/2019
ms.locfileid: "57794376"
---
# <a name="how-updatable-help-works"></a><span data-ttu-id="c4382-102">可更新帮助的工作原理</span><span class="sxs-lookup"><span data-stu-id="c4382-102">How Updatable Help Works</span></span>

<span data-ttu-id="c4382-103">本主题说明如何可更新帮助的进程的 HelpInfo XML 文件和 CAB 文件对于每个模块，并安装更新的用户的帮助。</span><span class="sxs-lookup"><span data-stu-id="c4382-103">This topic explains how Updatable Help processes the HelpInfo XML file and CAB files for each module, and installs updated help for users.</span></span>

## <a name="the-update-help-process"></a><span data-ttu-id="c4382-104">更新帮助进程</span><span class="sxs-lookup"><span data-stu-id="c4382-104">The Update-Help Process</span></span>

<span data-ttu-id="c4382-105">下面列出的操作[Update-help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) cmdlet 时的用户运行更新特定的 UI 区域性中的模块的帮助文件的命令。</span><span class="sxs-lookup"><span data-stu-id="c4382-105">The following list describes the actions of the [Update-Help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) cmdlet when a user runs a command to update the help files for a module in a particular UI culture.</span></span>

1. <span data-ttu-id="c4382-106">`Update-Help` 从指定的值的位置获取远程 HelpInfo XML 文件**HelpInfoURI**密钥模块清单中，然后验证针对该架构文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-106">`Update-Help` gets the remote HelpInfo XML file from the location specified by the value of the **HelpInfoURI** key in the module manifest and validates the file against the schema.</span></span> <span data-ttu-id="c4382-107">(若要查看架构，请参阅[HelpInfo XML 架构](./helpinfo-xml-schema.md)。)然后`Update-Help`模块目录中的模块的用户的计算机上的本地 HelpInfo XML 文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-107">(To view the schema, see [HelpInfo XML Schema](./helpinfo-xml-schema.md).) Then `Update-Help` looks for a local HelpInfo XML file for the module in the module directory on the user's computer.</span></span>

2. <span data-ttu-id="c4382-108">`Update-Help` 将指定的 UI 区域性中的远程和本地的 HelpInfo XML 文件的模块的帮助文件的版本号进行比较。</span><span class="sxs-lookup"><span data-stu-id="c4382-108">`Update-Help` compares the version number of the help files for the specified UI culture in the remote and local HelpInfo XML files for the module.</span></span> <span data-ttu-id="c4382-109">如果对远程文件的版本号大于版本号上本地文件，或如果没有对于模块，无本地 HelpInfo XML 文件`Update-Help`正在准备下载新的帮助文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-109">If the version number on the remote file is greater than version number on the local file, or if the there is no local HelpInfo XML file for the module, `Update-Help` prepares to download new help files.</span></span>

3. <span data-ttu-id="c4382-110">`Update-Help` 从指定的位置中选择该模块的 CAB 文件**HelpContentUri**远程 HelpInfo XML 文件中的元素。</span><span class="sxs-lookup"><span data-stu-id="c4382-110">`Update-Help` selects the CAB file for the module from the location specified by the **HelpContentUri** element in the remote HelpInfo XML file.</span></span> <span data-ttu-id="c4382-111">它使用的模块名称、 GUID、 模块和 UI 区域性来标识该 CAB 文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-111">It uses the module name, module GUID, and UI culture to identify the CAB file.</span></span>

4. <span data-ttu-id="c4382-112">`Update-Help` 下载的 CAB 文件，对其进行解压缩，验证帮助内容文件，并帮助内容将文件保存在模块目录的特定于语言的子目录中用户的计算机上。</span><span class="sxs-lookup"><span data-stu-id="c4382-112">`Update-Help` downloads the CAB file, unpacks it, validates the help content files, and saves the help content files in the language-specific subdirectory of the module directory on the user's computer.</span></span>

5. <span data-ttu-id="c4382-113">`Update-Help` 通过复制远程 HelpInfo XML 文件来创建本地 HelpInfo XML 文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-113">`Update-Help` creates a local HelpInfo XML file by copying the remote HelpInfo XML file.</span></span> <span data-ttu-id="c4382-114">编辑本地 HelpInfo XML 文件，以便它包括仅用于安装该 CAB 文件的元素。</span><span class="sxs-lookup"><span data-stu-id="c4382-114">It edits the local HelpInfo XML file so that it includes elements only for the CAB file that it installed.</span></span> <span data-ttu-id="c4382-115">然后它会将本地 HelpInfo XML 文件保存在模块目录中，并结束更新。</span><span class="sxs-lookup"><span data-stu-id="c4382-115">Then it saves the local HelpInfo XML file in the module directory and concludes the update.</span></span>

## <a name="the-save-help-process"></a><span data-ttu-id="c4382-116">保存帮助进程</span><span class="sxs-lookup"><span data-stu-id="c4382-116">The Save-Help Process</span></span>

<span data-ttu-id="c4382-117">下面列出的操作[Save-help](/powershell/module/Microsoft.PowerShell.Core/Save-Help)并[Update-help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) cmdlet 时的用户运行命令以更新文件共享中的帮助文件，然后使用这些文件在更新的帮助文件用户的计算机。</span><span class="sxs-lookup"><span data-stu-id="c4382-117">The following list describes the actions of the [Save-Help](/powershell/module/Microsoft.PowerShell.Core/Save-Help) and [Update-Help](/powershell/module/Microsoft.PowerShell.Core/Update-Help) cmdlets when a user runs commands to update the help files in a file share, and then use those files to update the help files on the user's computer.</span></span>

<span data-ttu-id="c4382-118">`Save-Help` Cmdlet 执行以下操作以响应命令以将模块的帮助文件保存在指定的文件共享**DestinationPath**参数。</span><span class="sxs-lookup"><span data-stu-id="c4382-118">The `Save-Help` cmdlet performs the following actions in response to a command to save the help files for a module in a file share that is specified by the **DestinationPath** parameter.</span></span>

1. <span data-ttu-id="c4382-119">`Save-Help` 从指定的值的位置获取远程 HelpInfo XML 文件**HelpInfoURI**密钥模块清单中，然后验证针对该架构文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-119">`Save-Help` gets  the remote HelpInfo XML file from the location specified by the value of the **HelpInfoURI** key in the module manifest and validates the file against the schema.</span></span> <span data-ttu-id="c4382-120">(若要查看架构，请参阅[HelpInfo XML 架构](./helpinfo-xml-schema.md)。)然后`Save-Help`会查找由指定的目录中的本地 HelpInfo XML 文件**DestinationPath**中的参数`Save-Help`命令。</span><span class="sxs-lookup"><span data-stu-id="c4382-120">(To view the schema, see [HelpInfo XML Schema](./helpinfo-xml-schema.md).) Then `Save-Help` looks for a local HelpInfo XML file in the directory that is specified by the **DestinationPath** parameter in the `Save-Help` command.</span></span>

2. <span data-ttu-id="c4382-121">`Save-Help` 将指定的 UI 区域性中的远程和本地的 HelpInfo XML 文件的模块的帮助文件的版本号进行比较。</span><span class="sxs-lookup"><span data-stu-id="c4382-121">`Save-Help` compares the version number of the help files for the specified UI culture in the remote and local HelpInfo XML files for the module.</span></span> <span data-ttu-id="c4382-122">如果对远程文件的版本号大于上的本地文件的版本号或没有任何本地 HelpInfo XML 文件中模块**DestinationPath**目录中，`Save-Help`正在准备下载新的帮助文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-122">If the version number on the remote file is greater than version number on the local file, or if the there is no local HelpInfo XML file for the module in the **DestinationPath** directory, `Save-Help` prepares to download new help files.</span></span>

3. <span data-ttu-id="c4382-123">`Save-Help` 从指定的位置中选择该模块的 CAB 文件**HelpContentUri**远程 HelpInfo XML 文件中的元素。</span><span class="sxs-lookup"><span data-stu-id="c4382-123">`Save-Help` selects the CAB file for the module from the location specified by the **HelpContentUri** element in the remote HelpInfo XML file.</span></span> <span data-ttu-id="c4382-124">它使用的模块名称、 GUID、 模块和 UI 区域性来标识该 CAB 文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-124">It uses the module name, module GUID, and UI culture to identify the CAB file.</span></span>

4. <span data-ttu-id="c4382-125">`Save-Help` 下载的 CAB 文件，并将其保存在**DestinationPath**目录。</span><span class="sxs-lookup"><span data-stu-id="c4382-125">`Save-Help` downloads the CAB file and saves it in the **DestinationPath** directory.</span></span> <span data-ttu-id="c4382-126">（它不会创建任何特定于语言的子目录）。</span><span class="sxs-lookup"><span data-stu-id="c4382-126">(It does not create any language-specific subdirectories.)</span></span>

5. <span data-ttu-id="c4382-127">`Save-Help` 通过复制远程 HelpInfo XML 文件来创建本地 HelpInfo XML 文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-127">`Save-Help` creates a local HelpInfo XML file by copying the remote HelpInfo XML file.</span></span> <span data-ttu-id="c4382-128">编辑本地 HelpInfo XML 文件，以便它包括仅用于将其保存 CAB 文件的元素。</span><span class="sxs-lookup"><span data-stu-id="c4382-128">It edits the local HelpInfo XML file so that it includes elements only for the CAB file that it saved.</span></span> <span data-ttu-id="c4382-129">然后它将保存在本地的 HelpInfo XML 文件**DestinationPath**目录，并结束更新。</span><span class="sxs-lookup"><span data-stu-id="c4382-129">Then it saves the local HelpInfo XML file in the  **DestinationPath** directory and concludes the update.</span></span>

   <span data-ttu-id="c4382-130">`Update-Help` Cmdlet 执行以下操作以更新的文件中指定的文件共享的用户的计算机上的帮助文件的命令响应**SourcePath**参数。</span><span class="sxs-lookup"><span data-stu-id="c4382-130">The `Update-Help` cmdlet performs the following actions in response to a command to update the help files on a user's computer from the files in a file share that is specified by the **SourcePath** parameter.</span></span>

1. <span data-ttu-id="c4382-131">`Update-Help` 获取远程 HelpInfo XML 文件从**SourcePath**目录。</span><span class="sxs-lookup"><span data-stu-id="c4382-131">`Update-Help` gets the remote HelpInfo XML file from the **SourcePath** directory.</span></span> <span data-ttu-id="c4382-132">然后它查找模块目录中用户的计算机上的本地 HelpInfo XML 文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-132">Then it looks for a local HelpInfo XML file in the module directory on the user's computer.</span></span>

2. <span data-ttu-id="c4382-133">`Update-Help` 将指定的 UI 区域性中的远程和本地的 HelpInfo XML 文件的模块的帮助文件的版本号进行比较。</span><span class="sxs-lookup"><span data-stu-id="c4382-133">`Update-Help` compares the version number of the help files for the specified UI culture in the remote and local HelpInfo XML files for the module.</span></span> <span data-ttu-id="c4382-134">如果对远程文件的版本号大于版本号上本地文件，或如果有任何本地 HelpInfo XML 文件，`Update-Help`正在准备安装新的帮助文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-134">If the version number on the remote file is greater than version number on the local file, or if the there is no local HelpInfo XML file, `Update-Help` prepares to install new help files.</span></span>

3. <span data-ttu-id="c4382-135">`Update-Help` 选择模块从 CAB 文件**SourcePath**目录。</span><span class="sxs-lookup"><span data-stu-id="c4382-135">`Update-Help` selects the CAB file for the module from **SourcePath** directory.</span></span> <span data-ttu-id="c4382-136">它使用的模块名称、 GUID、 模块和 UI 区域性来标识该 CAB 文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-136">It uses the module name, module GUID, and UI culture to identify the CAB file.</span></span>

4. <span data-ttu-id="c4382-137">`Update-Help` 解压缩 CAB 文件，验证帮助内容文件，并帮助内容将文件保存在模块目录的特定于语言的子目录中用户的计算机上。</span><span class="sxs-lookup"><span data-stu-id="c4382-137">`Update-Help` unpacks the CAB file, validates the help content files, and saves the help content files in the language-specific subdirectory of the module directory on the user's computer.</span></span>

5. <span data-ttu-id="c4382-138">`Update-Help` 通过复制远程 HelpInfo XML 文件来创建本地 HelpInfo XML 文件。</span><span class="sxs-lookup"><span data-stu-id="c4382-138">`Update-Help` creates a local HelpInfo XML file by copying the remote HelpInfo XML file.</span></span> <span data-ttu-id="c4382-139">编辑本地 HelpInfo XML 文件，以便它包括仅用于安装该 CAB 文件的元素。</span><span class="sxs-lookup"><span data-stu-id="c4382-139">It edits the local HelpInfo XML file so that it includes elements only for the CAB file that it installed.</span></span> <span data-ttu-id="c4382-140">然后它会将本地 HelpInfo XML 文件保存在模块目录中，并结束更新。</span><span class="sxs-lookup"><span data-stu-id="c4382-140">Then it saves the local HelpInfo XML file in the module directory and concludes the update.</span></span>