---
title: Windows PowerShell 提供程序概述 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 82244fbd-07b9-47f3-805c-3fb90ebbf58a
caps.latest.revision: 13
ms.openlocfilehash: 81f6c8cd75ccea9e711cd8f6d6daa6cca5a499a0
ms.sourcegitcommit: 46bebe692689ebedfe65ff2c828fe666b443198d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/10/2019
ms.locfileid: "67734870"
---
# <a name="windows-powershell-provider-overview"></a><span data-ttu-id="5f293-102">Windows PowerShell 提供程序概述</span><span class="sxs-lookup"><span data-stu-id="5f293-102">Windows PowerShell Provider Overview</span></span>

<span data-ttu-id="5f293-103">Windows PowerShell 提供程序允许将任何数据存储，就好像已装载的驱动器进行公开与文件系统类似。</span><span class="sxs-lookup"><span data-stu-id="5f293-103">A Windows PowerShell provider allows any data store to be exposed like a file system as if it were a mounted drive.</span></span> <span data-ttu-id="5f293-104">例如，内置的注册表提供程序，可像你可以导航导航注册表`c`您的计算机的驱动器。</span><span class="sxs-lookup"><span data-stu-id="5f293-104">For example, the built-in Registry provider allows you to navigate the registry like you would navigate the `c` drive of your computer.</span></span> <span data-ttu-id="5f293-105">一个提供程序还可以重写`Item`cmdlet (例如， `Get-Item`，`Set-Item`等)，以便可以将数据存储区中的数据视为文件并且导航文件系统时，将被视为目录。</span><span class="sxs-lookup"><span data-stu-id="5f293-105">A provider can also override the `Item` cmdlets (for example, `Get-Item`, `Set-Item`, etc.) such that the data in your data store can be treated like files and directories are treated when navigating a file system.</span></span> <span data-ttu-id="5f293-106">有关提供程序和驱动器，以及在 Windows PowerShell 中的内置提供程序的详细信息，请参阅[about_Providers](/powershell/module/microsoft.powershell.core/about/about_providers)。</span><span class="sxs-lookup"><span data-stu-id="5f293-106">For more information about providers and drives, and the built-in providers in  Windows PowerShell, see [about_Providers](/powershell/module/microsoft.powershell.core/about/about_providers).</span></span>

## <a name="providers-and-drives"></a><span data-ttu-id="5f293-107">提供程序和驱动器</span><span class="sxs-lookup"><span data-stu-id="5f293-107">Providers and Drives</span></span>

<span data-ttu-id="5f293-108">一个提供程序定义用于访问、 导航和编辑数据存储，而在驱动器中指定的提供程序定义的类型的指定入口点到数据存储区 （或数据存储区的一部分） 的逻辑。</span><span class="sxs-lookup"><span data-stu-id="5f293-108">A Provider defines the logic that is used to access, navigate, and edit a data store, while a drive specifies a specific entry point to a data store (or a portion of a data store) that is of the type defined by the provider.</span></span> <span data-ttu-id="5f293-109">例如，注册表提供程序可以访问配置单元和注册表中的密钥和 HKLM 和 HKCU 驱动器指定注册表中相应的配置单元。</span><span class="sxs-lookup"><span data-stu-id="5f293-109">For example, the Registry provider allows you to access hives and keys in a registry, and the HKLM and HKCU drives specify the corresponding hives within the registry.</span></span> <span data-ttu-id="5f293-110">HKLM 和 HKCU 驱动器这两个使用注册表提供程序。</span><span class="sxs-lookup"><span data-stu-id="5f293-110">The HKLM and HKCU drives both use the Registry provider.</span></span>

<span data-ttu-id="5f293-111">当您编写一个提供程序时，可以指定默认驱动器驱动器提供程序可用时自动创建的。</span><span class="sxs-lookup"><span data-stu-id="5f293-111">When you write a provider, you can specify default drives-drives that are created automatically when the provider is available.</span></span> <span data-ttu-id="5f293-112">您还可以定义用于创建使用该提供程序的新驱动器的方法。</span><span class="sxs-lookup"><span data-stu-id="5f293-112">You also define a method to create new drives that use that provider.</span></span>

## <a name="type-of-providers"></a><span data-ttu-id="5f293-113">提供程序的类型</span><span class="sxs-lookup"><span data-stu-id="5f293-113">Type of Providers</span></span>

<span data-ttu-id="5f293-114">有几种类型的提供程序，其中每个提供不同级别的功能。</span><span class="sxs-lookup"><span data-stu-id="5f293-114">There are several types of providers, each of which provides a different level of functionality.</span></span> <span data-ttu-id="5f293-115">一个提供程序实现为类派生的后代之一[System.Management.Automation.SessionStateCategory](/dotnet/api/system.management.automation.sessionstatecategory?view=pscore-6.2.0) **CmdletProvider**类。</span><span class="sxs-lookup"><span data-stu-id="5f293-115">A provider is implemented as a class that derives from one of the descendants of the [System.Management.Automation.SessionStateCategory](/dotnet/api/system.management.automation.sessionstatecategory?view=pscore-6.2.0) **CmdletProvider** class.</span></span> <span data-ttu-id="5f293-116">有关不同类型的提供程序的信息，请参阅[提供程序类型](./provider-types.md)。</span><span class="sxs-lookup"><span data-stu-id="5f293-116">For information about the different types of providers, see [Provider types](./provider-types.md).</span></span>

## <a name="provider-cmdlets"></a><span data-ttu-id="5f293-117">提供程序 cmdlet</span><span class="sxs-lookup"><span data-stu-id="5f293-117">Provider cmdlets</span></span>

<span data-ttu-id="5f293-118">提供程序可以实现方法对应的 cmdlet，创建时为该提供程序在驱动器中使用这些 cmdlet 的自定义行为。</span><span class="sxs-lookup"><span data-stu-id="5f293-118">Providers can implement methods that correspond to cmdlets, creating custom behaviors for those cmdlets when used in a drive for that provider.</span></span> <span data-ttu-id="5f293-119">具体取决于提供程序的类型，提供了不同的 cmdlet 集。</span><span class="sxs-lookup"><span data-stu-id="5f293-119">Depending on the type of provider, different sets of cmdlets are available.</span></span> <span data-ttu-id="5f293-120">有关可用于自定义提供程序中的 cmdlet 的完整列表，请参阅[提供程序 cmdlet](./provider-cmdlets.md)。</span><span class="sxs-lookup"><span data-stu-id="5f293-120">For a complete list of the cmdlets available for customization in providers, see [Provider cmdlets](./provider-cmdlets.md).</span></span>

## <a name="provider-paths"></a><span data-ttu-id="5f293-121">提供程序路径</span><span class="sxs-lookup"><span data-stu-id="5f293-121">Provider paths</span></span>

<span data-ttu-id="5f293-122">用户导航文件系统一样的提供程序驱动器。</span><span class="sxs-lookup"><span data-stu-id="5f293-122">Users navigate provider drives like file systems.</span></span> <span data-ttu-id="5f293-123">因此，他们希望要对应于文件系统导航中使用的路径的路径的语法。</span><span class="sxs-lookup"><span data-stu-id="5f293-123">Because of this, they expect the syntax of paths to correspond to the paths used in file system navigation.</span></span> <span data-ttu-id="5f293-124">当用户运行提供程序 cmdlet 时，它们指定要访问的项的路径。</span><span class="sxs-lookup"><span data-stu-id="5f293-124">When a user runs a provider cmdlet, they specify a path to the item to be accessed.</span></span> <span data-ttu-id="5f293-125">可以多种方式解释指定的路径。</span><span class="sxs-lookup"><span data-stu-id="5f293-125">The path that is specified can be interpreted in several ways.</span></span> <span data-ttu-id="5f293-126">提供程序应支持一个或多个以下的路径类型。</span><span class="sxs-lookup"><span data-stu-id="5f293-126">A provider should support one or more of the following path types.</span></span>

### <a name="drive-qualified-paths"></a><span data-ttu-id="5f293-127">驱动器限定路径</span><span class="sxs-lookup"><span data-stu-id="5f293-127">Drive-qualified paths</span></span>

<span data-ttu-id="5f293-128">驱动器限定的路径是项名称、 容器和子容器中的项所在，并通过其访问项的 Windows PowerShell 驱动器的组合。</span><span class="sxs-lookup"><span data-stu-id="5f293-128">A drive-qualified path is a combination of the item name, the container and subcontainers in which the item is located, and the Windows PowerShell drive through which the item is accessed.</span></span> <span data-ttu-id="5f293-129">（驱动器定义用于访问数据存储区提供程序。</span><span class="sxs-lookup"><span data-stu-id="5f293-129">(Drives are defined by the provider that is used to access the data store.</span></span> <span data-ttu-id="5f293-130">此路径的开头使用驱动器名称后接一个冒号 （:）。</span><span class="sxs-lookup"><span data-stu-id="5f293-130">This path starts with the drive name followed by a colon (:).</span></span> <span data-ttu-id="5f293-131">例如：`get-childitem C:`</span><span class="sxs-lookup"><span data-stu-id="5f293-131">For example: `get-childitem C:`</span></span>

### <a name="provider-qualified-paths"></a><span data-ttu-id="5f293-132">提供程序限定路径</span><span class="sxs-lookup"><span data-stu-id="5f293-132">Provider-qualified paths</span></span>

<span data-ttu-id="5f293-133">若要允许 Windows PowerShell 引擎初始化和取消初始化您的提供程序，该提供程序必须支持的提供程序限定路径。</span><span class="sxs-lookup"><span data-stu-id="5f293-133">To allow the Windows PowerShell engine to initialize and uninitialize your provider, the provider must support a provider-qualified path.</span></span> <span data-ttu-id="5f293-134">例如，用户可以初始化和取消初始化 FileSystem 提供程序，因为它定义了以下提供程序限定路径： `FileSystem::\\uncshare\abc\bar`。</span><span class="sxs-lookup"><span data-stu-id="5f293-134">For example, the user can initialize and uninitialize the FileSystem provider because it defines the following provider-qualified path: `FileSystem::\\uncshare\abc\bar`.</span></span>

### <a name="provider-direct-paths"></a><span data-ttu-id="5f293-135">提供程序直接路径</span><span class="sxs-lookup"><span data-stu-id="5f293-135">Provider-direct paths</span></span>

<span data-ttu-id="5f293-136">若要允许远程访问 Windows PowerShell 提供程序，它应支持的提供程序直接路径要直接传递到 Windows PowerShell 提供程序为当前的位置。</span><span class="sxs-lookup"><span data-stu-id="5f293-136">To allow remote access to your Windows PowerShell provider, it should support a provider-direct path to pass directly to the Windows PowerShell provider for the current location.</span></span> <span data-ttu-id="5f293-137">例如，可以使用注册表的 Windows PowerShell 提供程序`\\server\regkeypath`作为提供程序直接路径。</span><span class="sxs-lookup"><span data-stu-id="5f293-137">For example, the registry Windows PowerShell provider can use `\\server\regkeypath` as a provider-direct path.</span></span>

### <a name="provider-internal-paths"></a><span data-ttu-id="5f293-138">提供程序内部的路径</span><span class="sxs-lookup"><span data-stu-id="5f293-138">Provider-internal paths</span></span>

<span data-ttu-id="5f293-139">若要允许使用 Windows PowerShell 应用程序编程接口 (Api) 访问数据的提供程序 cmdlet，Windows PowerShell 提供程序应支持的提供程序内部的路径。</span><span class="sxs-lookup"><span data-stu-id="5f293-139">To allow the provider cmdlet to access data using non-Windows PowerShell application programming interfaces (APIs), your Windows PowerShell provider should support a provider-internal path.</span></span> <span data-ttu-id="5f293-140">此路径指示后"::"中的提供程序限定路径。</span><span class="sxs-lookup"><span data-stu-id="5f293-140">This path is indicated after the "::" in the provider-qualified path.</span></span> <span data-ttu-id="5f293-141">例如，文件系统的 Windows PowerShell 提供程序的提供程序内部路径是`\\uncshare\abc\bar`。</span><span class="sxs-lookup"><span data-stu-id="5f293-141">For example, the provider-internal path for the filesystem Windows PowerShell provider is `\\uncshare\abc\bar`.</span></span>

## <a name="overriding-cmdlet-parameters"></a><span data-ttu-id="5f293-142">重写 cmdlet 参数</span><span class="sxs-lookup"><span data-stu-id="5f293-142">Overriding cmdlet parameters</span></span>

<span data-ttu-id="5f293-143">由提供程序可以重写的某些特定于提供程序的 cmdlet 的行为。</span><span class="sxs-lookup"><span data-stu-id="5f293-143">The behavior of some provider-specific cmdlets can be overridden by a provider.</span></span> <span data-ttu-id="5f293-144">可以重写的参数的列表以及如何在提供程序类中重写它们，请参阅[提供程序 cmdlet 参数](./provider-cmdlet-parameters.md)</span><span class="sxs-lookup"><span data-stu-id="5f293-144">For a list of parameters that can be overridden, and how to override them in your provider class, see [Provider cmdlet parameters](./provider-cmdlet-parameters.md)</span></span>

## <a name="dynamic-parameters"></a><span data-ttu-id="5f293-145">动态参数</span><span class="sxs-lookup"><span data-stu-id="5f293-145">Dynamic parameters</span></span>

<span data-ttu-id="5f293-146">提供程序可以定义当用户指定一个 cmdlet 的静态参数的值会添加到提供程序 cmdlet 的动态参数。</span><span class="sxs-lookup"><span data-stu-id="5f293-146">Providers can define dynamic parameters that are added to a provider cmdlet when the user specifies a certain value for one of the static parameters of the cmdlet.</span></span> <span data-ttu-id="5f293-147">一个提供程序通过实现一个或多个动态参数方法执行此操作。</span><span class="sxs-lookup"><span data-stu-id="5f293-147">A provider does this by implementing one or more dynamic parameter methods.</span></span> <span data-ttu-id="5f293-148">Cmdlet 可用于添加动态参数，以及用于实现它们的方法的参数的列表，请参阅[提供程序 cmdlet 的动态参数](./provider-cmdlet-dynamic-parameters.md)。</span><span class="sxs-lookup"><span data-stu-id="5f293-148">For a list of cmdlet parameters that can be used to add dynamic parameter, and the methods used to implement them, see [Provider cmdlet dynamic parameters](./provider-cmdlet-dynamic-parameters.md).</span></span>

## <a name="provider-capabilities"></a><span data-ttu-id="5f293-149">提供程序的功能</span><span class="sxs-lookup"><span data-stu-id="5f293-149">Provider capabilities</span></span>

<span data-ttu-id="5f293-150">[System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)枚举定义的提供程序可以支持的功能数。</span><span class="sxs-lookup"><span data-stu-id="5f293-150">The [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration  defines a number of capabilities that providers can support.</span></span> <span data-ttu-id="5f293-151">其中包括使用通配符、 筛选器项和支持事务的功能。</span><span class="sxs-lookup"><span data-stu-id="5f293-151">These include the ability to use wildcards, filter items, and support transactions.</span></span> <span data-ttu-id="5f293-152">若要指定提供程序的功能，请添加一系列的值[System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)枚举，与逻辑组合`OR`操作，作为[System.Management.Automation.Provider.Cmdletproviderattribute.Providercapabilities\*](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute.ProviderCapabilities)属性 （该属性的第二个参数） 的[System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute)提供程序类的属性。</span><span class="sxs-lookup"><span data-stu-id="5f293-152">To specify capabilities for a provider, add a list of values of the  [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration, combined with a logical `OR` operation, as the [System.Management.Automation.Provider.Cmdletproviderattribute.Providercapabilities\*](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute.ProviderCapabilities) property (the second parameter of the attribute) of the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute for your provider class.</span></span> <span data-ttu-id="5f293-153">例如，以下属性指定的提供程序支持[System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities?view=pscore-6.2.0) **ShouldProcess**和[System.Management.Automation.Provider.ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities?view=pscore-6.2.0) **事务**功能。</span><span class="sxs-lookup"><span data-stu-id="5f293-153">For example, the following attribute specifies that the provider supports the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities?view=pscore-6.2.0) **ShouldProcess** and [System.Management.Automation.Provider.ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities?view=pscore-6.2.0) **Transactions** capabilities.</span></span>

```csharp
[CmdletProvider(RegistryProvider.ProviderName, ProviderCapabilities.ShouldProcess | ProviderCapabilities.Transactions)]

```

## <a name="provider-cmdlet-help"></a><span data-ttu-id="5f293-154">提供程序 cmdlet 帮助</span><span class="sxs-lookup"><span data-stu-id="5f293-154">Provider cmdlet help</span></span>

<span data-ttu-id="5f293-155">当编写提供程序，可以实现您自己支持的提供程序 cmdlet 的帮助。</span><span class="sxs-lookup"><span data-stu-id="5f293-155">When writing a provider, you can implement your own Help for the provider cmdlets that you support.</span></span> <span data-ttu-id="5f293-156">这包括适用于每个提供程序 cmdlet 或多个版本帮助主题的情况下提供程序 cmdlet 的作用根据动态参数使用不同的单个帮助主题。</span><span class="sxs-lookup"><span data-stu-id="5f293-156">This includes a single help topic for each provider cmdlet or multiple versions of a help topic for cases where the provider cmdlet acts differently based on the use of dynamic parameters.</span></span> <span data-ttu-id="5f293-157">若要支持提供程序特定于 cmdlet 的帮助，您的提供程序必须实现[System.Management.Automation.Provider.Icmdletprovidersupportshelp](/dotnet/api/System.Management.Automation.Provider.ICmdletProviderSupportsHelp)接口。</span><span class="sxs-lookup"><span data-stu-id="5f293-157">To support provider cmdlet-specific help, your provider must implement the [System.Management.Automation.Provider.Icmdletprovidersupportshelp](/dotnet/api/System.Management.Automation.Provider.ICmdletProviderSupportsHelp) interface.</span></span>

<span data-ttu-id="5f293-158">Windows PowerShell 引擎调用[System.Management.Automation.Provider.Icmdletprovidersupportshelp.Gethelpmaml\*](/dotnet/api/System.Management.Automation.Provider.ICmdletProviderSupportsHelp.GetHelpMaml)方法以显示提供程序 cmdlet 的帮助主题。</span><span class="sxs-lookup"><span data-stu-id="5f293-158">The Windows PowerShell engine calls the [System.Management.Automation.Provider.Icmdletprovidersupportshelp.Gethelpmaml\*](/dotnet/api/System.Management.Automation.Provider.ICmdletProviderSupportsHelp.GetHelpMaml) method to display the Help topic for your provider cmdlets.</span></span> <span data-ttu-id="5f293-159">引擎提供了用户在运行时指定该 cmdlet 的名称`Get-Help`cmdlet 和用户的当前路径。</span><span class="sxs-lookup"><span data-stu-id="5f293-159">The engine provides the name of the cmdlet that the user specified when running the `Get-Help` cmdlet and the current path of the user.</span></span> <span data-ttu-id="5f293-160">如果您的提供程序实现了不同版本的同一提供程序 cmdlet 对不同的驱动器，则需要使用当前路径。</span><span class="sxs-lookup"><span data-stu-id="5f293-160">The current path is required if your provider implements different versions of the same provider cmdlet for different drives.</span></span> <span data-ttu-id="5f293-161">该方法必须返回一个字符串，包含于 cmdlet 帮助的 XML。</span><span class="sxs-lookup"><span data-stu-id="5f293-161">The method must return a string that contains the XML for the cmdlet Help.</span></span>

<span data-ttu-id="5f293-162">使用 PSMAML XML 写入的帮助文件的内容。</span><span class="sxs-lookup"><span data-stu-id="5f293-162">The content for the Help file is written using PSMAML XML.</span></span> <span data-ttu-id="5f293-163">这是用于编写针对独立 cmdlet 的帮助内容的相同 XML 架构。</span><span class="sxs-lookup"><span data-stu-id="5f293-163">This is the same XML schema that is used for writing Help content for stand-alone cmdlets.</span></span> <span data-ttu-id="5f293-164">添加自定义 cmdlet 帮助您的提供程序的帮助文件的内容在`CmdletHelpPaths`元素。</span><span class="sxs-lookup"><span data-stu-id="5f293-164">Add the content for your custom cmdlet Help to the Help file for your provider under the `CmdletHelpPaths` element.</span></span> <span data-ttu-id="5f293-165">下面的示例演示`command`单个提供程序 cmdlet，和它的元素将显示如何指定提供程序 cmdlet 的名称，您的提供程序。</span><span class="sxs-lookup"><span data-stu-id="5f293-165">The following example shows the `command` element for a single provider cmdlet, and it shows how you specify the name of the provider cmdlet that your provider.</span></span> <span data-ttu-id="5f293-166">支持</span><span class="sxs-lookup"><span data-stu-id="5f293-166">supports</span></span>

```xml
<CmdletHelpPaths>
  <command:command>
    <command:details>
      <command:name>ProviderCmdletName</command:name>
      <command:verb>Verb</command:verb>
      <command:noun>Noun</command:noun>
    <command:details>
  </command:command>
<CmdletHelpPath>
```

## <a name="see-also"></a><span data-ttu-id="5f293-167">另请参阅</span><span class="sxs-lookup"><span data-stu-id="5f293-167">See Also</span></span>

[<span data-ttu-id="5f293-168">Windows PowerShell 提供程序功能</span><span class="sxs-lookup"><span data-stu-id="5f293-168">Windows PowerShell Provider Functionality</span></span>](./provider-types.md)

[<span data-ttu-id="5f293-169">提供程序 Cmdlet</span><span class="sxs-lookup"><span data-stu-id="5f293-169">Provider Cmdlets</span></span>](./provider-cmdlets.md)

[<span data-ttu-id="5f293-170">编写 Windows PowerShell 提供程序</span><span class="sxs-lookup"><span data-stu-id="5f293-170">Writing a Windows PowerShell Provider</span></span>](./writing-a-windows-powershell-provider.md)