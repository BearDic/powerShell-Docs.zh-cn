---
title: 加载和导出数据的格式设置 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 2a48de31-7961-4b0e-b58b-93466e38370b
caps.latest.revision: 6
ms.openlocfilehash: 08c64d4094d8ba6c551b454887331666f0694f11
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/03/2019
ms.locfileid: "56860623"
---
# <a name="loading-and-exporting-formatting-data"></a><span data-ttu-id="f3290-102">加载和导出格式设置数据</span><span class="sxs-lookup"><span data-stu-id="f3290-102">Loading and Exporting Formatting Data</span></span>

<span data-ttu-id="f3290-103">创建格式设置文件后，需要更新通过将文件加载到当前会话的会话的格式数据。</span><span class="sxs-lookup"><span data-stu-id="f3290-103">Once you have created your formatting file, you need to update the format data of the session by loading your files into the current session.</span></span> <span data-ttu-id="f3290-104">（由 Windows PowerShell 提供的格式设置文件加载的管理单元打开当前会话时注册。）一旦更新当前会话的格式数据，Windows PowerShell 将使用此数据来显示与加载的格式设置文件中定义的视图相关联的.NET 对象。</span><span class="sxs-lookup"><span data-stu-id="f3290-104">(The formatting files provided by Windows PowerShell are loaded by snap-ins that are registered when the current session is opened.) Once the format data of the current session is updated, Windows PowerShell uses that data to display the .NET objects associated with the views defined in the loaded formatting files.</span></span> <span data-ttu-id="f3290-105">可以加载到当前会话的格式设置文件的数量没有限制。</span><span class="sxs-lookup"><span data-stu-id="f3290-105">There is no limit to the number of formatting files that you can load into the current session.</span></span> <span data-ttu-id="f3290-106">除了更新的格式设置数据，可以返回到格式设置文件在当前会话中导出的格式数据。</span><span class="sxs-lookup"><span data-stu-id="f3290-106">In addition to updating the formatting data, you can export the format data in the current session back to a formatting file.</span></span>

## <a name="loading-format-data"></a><span data-ttu-id="f3290-107">加载数据的格式</span><span class="sxs-lookup"><span data-stu-id="f3290-107">Loading format data</span></span>

<span data-ttu-id="f3290-108">可以将格式设置文件加载到当前会话使用以下方法：</span><span class="sxs-lookup"><span data-stu-id="f3290-108">Formatting files can be loaded into the current session using the following methods:</span></span>

- <span data-ttu-id="f3290-109">您可以导入当前会话从命令行的格式设置文件。</span><span class="sxs-lookup"><span data-stu-id="f3290-109">You can import the formatting file into the current session from the command line.</span></span> <span data-ttu-id="f3290-110">使用[Update-formatdata](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet，如以下过程中所述。</span><span class="sxs-lookup"><span data-stu-id="f3290-110">Use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet as described in the following procedure.</span></span>
- <span data-ttu-id="f3290-111">您可以导入当前会话从命令行的格式设置文件。</span><span class="sxs-lookup"><span data-stu-id="f3290-111">You can import the formatting file into the current session from the command line.</span></span> <span data-ttu-id="f3290-112">使用[Update-formatdata](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet，如以下过程中所述。</span><span class="sxs-lookup"><span data-stu-id="f3290-112">Use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet as described in the following procedure.</span></span>

- <span data-ttu-id="f3290-113">可以创建引用格式设置文件的模块清单。</span><span class="sxs-lookup"><span data-stu-id="f3290-113">You can create a module manifest that references your formatting file.</span></span> <span data-ttu-id="f3290-114">模块，可打包你设置用于发布的文件的格式。</span><span class="sxs-lookup"><span data-stu-id="f3290-114">Modules allow you to package you formatting files for distribution.</span></span> <span data-ttu-id="f3290-115">使用[New-modulemanifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet 来创建清单，并[导入模块](/powershell/module/Microsoft.PowerShell.Core/Import-Module)cmdlet 将模块加载到当前会话。</span><span class="sxs-lookup"><span data-stu-id="f3290-115">Use the [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet to create the manifest, and the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to load the module into the current session.</span></span> <span data-ttu-id="f3290-116">有关模块的详细信息，请参阅[编写 Windows PowerShell 模块](../module/writing-a-windows-powershell-module.md)。</span><span class="sxs-lookup"><span data-stu-id="f3290-116">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>
- <span data-ttu-id="f3290-117">可以创建引用格式设置文件的模块清单。</span><span class="sxs-lookup"><span data-stu-id="f3290-117">You can create a module manifest that references your formatting file.</span></span> <span data-ttu-id="f3290-118">模块，可打包你设置用于发布的文件的格式。</span><span class="sxs-lookup"><span data-stu-id="f3290-118">Modules allow you to package you formatting files for distribution.</span></span> <span data-ttu-id="f3290-119">使用[New-modulemanifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet 来创建清单，并[导入模块](/powershell/module/Microsoft.PowerShell.Core/Import-Module)cmdlet 将模块加载到当前会话。</span><span class="sxs-lookup"><span data-stu-id="f3290-119">Use the [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet to create the manifest, and the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to load the module into the current session.</span></span> <span data-ttu-id="f3290-120">有关模块的详细信息，请参阅[编写 Windows PowerShell 模块](../module/writing-a-windows-powershell-module.md)。</span><span class="sxs-lookup"><span data-stu-id="f3290-120">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="f3290-121">您可以创建一个单元引用格式设置文件。</span><span class="sxs-lookup"><span data-stu-id="f3290-121">You can create a snap-in that references your formatting file.</span></span> <span data-ttu-id="f3290-122">使用[System.Management.Automation.Pssnapin.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats)引用格式设置文件。</span><span class="sxs-lookup"><span data-stu-id="f3290-122">Use the [System.Management.Automation.Pssnapin.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) to reference your formatting files.</span></span> <span data-ttu-id="f3290-123">强烈建议使用包 cmdlet 的模块和任何关联的格式设置和类型的文件来分发它。</span><span class="sxs-lookup"><span data-stu-id="f3290-123">It is strongly encouraged to use modules to package cmdlets, and any associated formatting and types files for distribution.</span></span> <span data-ttu-id="f3290-124">有关模块的详细信息，请参阅[编写 Windows PowerShell 模块](../module/writing-a-windows-powershell-module.md)。</span><span class="sxs-lookup"><span data-stu-id="f3290-124">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="f3290-125">如果以编程方式调用命令时，您可以将格式设置文件条目添加到其中运行的命令的初始会话状态的运行空间。</span><span class="sxs-lookup"><span data-stu-id="f3290-125">If you are invoking commands programmatically, you can add a formatting file entry to the initial session state of the runspace where the commands are run.</span></span> <span data-ttu-id="f3290-126">若要添加的格式设置文件所使用的.NET 类型的详细信息，请参阅[System.Management.Automation.Runspaces.Sessionstateformatentry？Displayproperty =](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry)类。</span><span class="sxs-lookup"><span data-stu-id="f3290-126">For more information about .NET type used to add the formatting file, see the [System.Management.Automation.Runspaces.Sessionstateformatentry?Displayproperty=Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) class.</span></span>

<span data-ttu-id="f3290-127">加载格式设置文件时，它被添加到内部列表用于确定哪个视图对象显示在命令行时要使用 Windows PowerShell。</span><span class="sxs-lookup"><span data-stu-id="f3290-127">When a formatting file is loaded, it is added to an internal list that Windows PowerShell uses to determine which view to use when displaying objects at the command line.</span></span> <span data-ttu-id="f3290-128">可以在前面添加到列表中，开始在格式设置文件或可将其追加到列表的末尾。</span><span class="sxs-lookup"><span data-stu-id="f3290-128">You can prepend your formatting file to the beginning of the list, or you can append it to the end of the list.</span></span> <span data-ttu-id="f3290-129">了解此处格式设置文件添加到此列表很重要，如果要加载格式设置文件，用于定义具有现有视图定义的例如当你想要更改 Windows PowerShell 核心 cmdlet 返回的对象时的方式的对象的视图 显示。</span><span class="sxs-lookup"><span data-stu-id="f3290-129">Knowing where your formatting file is added to this list is important if you are loading formatting file that defines a view for an object that has an existing view defined, such as when you want to change how an object that is returned by a Windows PowerShell core cmdlet is displayed.</span></span> <span data-ttu-id="f3290-130">如果你加载的格式设置文件，用于定义对象的唯一视图，可以使用任何以前所述的方法。</span><span class="sxs-lookup"><span data-stu-id="f3290-130">If you are loading a formatting file that defines the only view for an object, you can use any of the methods described previously.</span></span>  <span data-ttu-id="f3290-131">如果你加载的格式设置文件，用于定义对象的另一个视图，则必须使用[Update-formatdata](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet 并预先考虑您的文件列表的开头。</span><span class="sxs-lookup"><span data-stu-id="f3290-131">If you are loading a formatting file that defines another view for an object, you must use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet and prepend your file to the beginning of the list.</span></span>
<span data-ttu-id="f3290-132">加载格式设置文件时，它被添加到内部列表用于确定哪个视图对象显示在命令行时要使用 Windows PowerShell。</span><span class="sxs-lookup"><span data-stu-id="f3290-132">When a formatting file is loaded, it is added to an internal list that Windows PowerShell uses to determine which view to use when displaying objects at the command line.</span></span> <span data-ttu-id="f3290-133">可以在前面添加到列表中，开始在格式设置文件或可将其追加到列表的末尾。</span><span class="sxs-lookup"><span data-stu-id="f3290-133">You can prepend your formatting file to the beginning of the list, or you can append it to the end of the list.</span></span> <span data-ttu-id="f3290-134">了解此处格式设置文件添加到此列表很重要，如果要加载格式设置文件，用于定义具有现有视图定义的例如当你想要更改 Windows PowerShell 核心 cmdlet 返回的对象时的方式的对象的视图 显示。</span><span class="sxs-lookup"><span data-stu-id="f3290-134">Knowing where your formatting file is added to this list is important if you are loading formatting file that defines a view for an object that has an existing view defined, such as when you want to change how an object that is returned by a Windows PowerShell core cmdlet is displayed.</span></span> <span data-ttu-id="f3290-135">如果你加载的格式设置文件，用于定义对象的唯一视图，可以使用任何以前所述的方法。</span><span class="sxs-lookup"><span data-stu-id="f3290-135">If you are loading a formatting file that defines the only view for an object, you can use any of the methods described previously.</span></span>  <span data-ttu-id="f3290-136">如果你加载的格式设置文件，用于定义对象的另一个视图，则必须使用[Update-formatdata](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet 并预先考虑您的文件列表的开头。</span><span class="sxs-lookup"><span data-stu-id="f3290-136">If you are loading a formatting file that defines another view for an object, you must use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet and prepend your file to the beginning of the list.</span></span>

## <a name="storing-your-formatting-file"></a><span data-ttu-id="f3290-137">将格式设置文件存储</span><span class="sxs-lookup"><span data-stu-id="f3290-137">Storing Your Formatting File</span></span>

<span data-ttu-id="f3290-138">没有任何要求的格式设置文件在磁盘上的存储位置。</span><span class="sxs-lookup"><span data-stu-id="f3290-138">There is no requirement for where your formatting files are stored on disk.</span></span> <span data-ttu-id="f3290-139">但是，强烈建议您将其存储在以下文件夹中： `user\documents\windowspowershell\`</span><span class="sxs-lookup"><span data-stu-id="f3290-139">However, it is strongly suggested that you store them in the following folder: `user\documents\windowspowershell\`</span></span>

#### <a name="loading-a-format-file-using-import-formatdata"></a><span data-ttu-id="f3290-140">正在加载使用导入 FormatData 使用格式化文件</span><span class="sxs-lookup"><span data-stu-id="f3290-140">Loading a format file using Import-FormatData</span></span>

1. <span data-ttu-id="f3290-141">将存储到磁盘在格式设置文件。</span><span class="sxs-lookup"><span data-stu-id="f3290-141">Store your formatting file to disk.</span></span>

2. <span data-ttu-id="f3290-142">运行[Update-formatdata](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet 使用以下命令之一。</span><span class="sxs-lookup"><span data-stu-id="f3290-142">Run the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet using one of the following commands.</span></span>
2. <span data-ttu-id="f3290-143">运行[Update-formatdata](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet 使用以下命令之一。</span><span class="sxs-lookup"><span data-stu-id="f3290-143">Run the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet using one of the following commands.</span></span>

   <span data-ttu-id="f3290-144">若要添加将格式设置文件列表的开头，请使用此命令。</span><span class="sxs-lookup"><span data-stu-id="f3290-144">To add your formatting file to the front of the list use this command.</span></span> <span data-ttu-id="f3290-145">如果要更改对象的显示方式，请使用此命令。</span><span class="sxs-lookup"><span data-stu-id="f3290-145">Use this command if you are changing how an object is displayed.</span></span>

   ```powershell
   Update-FormatData -PrependPath PathToFormattingFile
   ```

   <span data-ttu-id="f3290-146">若要添加将格式设置文件列表的末尾使用此命令。</span><span class="sxs-lookup"><span data-stu-id="f3290-146">To add your formatting file to the end of the list use this command.</span></span>

   ```powershell
   Update-FormatData -AppendPath PathToFormattingFile
   ```

   <span data-ttu-id="f3290-147">已添加文件使用后[Update-formatdata](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet，你不能将文件从列表中删除该会话处于打开状态时。</span><span class="sxs-lookup"><span data-stu-id="f3290-147">Once you have added a file using the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, you cannot remove the file from the list while the session is open.</span></span> <span data-ttu-id="f3290-148">您必须关闭会话后，若要从列表中删除的格式设置文件。</span><span class="sxs-lookup"><span data-stu-id="f3290-148">You must close the session to remove the formatting file from the list.</span></span>
   <span data-ttu-id="f3290-149">已添加文件使用后[Update-formatdata](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet，你不能将文件从列表中删除该会话处于打开状态时。</span><span class="sxs-lookup"><span data-stu-id="f3290-149">Once you have added a file using the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, you cannot remove the file from the list while the session is open.</span></span> <span data-ttu-id="f3290-150">您必须关闭会话后，若要从列表中删除的格式设置文件。</span><span class="sxs-lookup"><span data-stu-id="f3290-150">You must close the session to remove the formatting file from the list.</span></span>

## <a name="exporting-format-data"></a><span data-ttu-id="f3290-151">导出格式数据</span><span class="sxs-lookup"><span data-stu-id="f3290-151">Exporting format data</span></span>

<span data-ttu-id="f3290-152">在此处插入分区正文。</span><span class="sxs-lookup"><span data-stu-id="f3290-152">Insert section body here.</span></span>
