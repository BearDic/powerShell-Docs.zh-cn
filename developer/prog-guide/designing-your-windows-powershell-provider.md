---
title: 设计 Windows PowerShell 提供程序 |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], designing
ms.assetid: 11d20319-cc40-4227-b810-4af33372b182
caps.latest.revision: 10
ms.openlocfilehash: 518040df4df7260a974bfda252c606a051cc35ad
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/03/2019
ms.locfileid: "56856853"
---
# <a name="designing-your-windows-powershell-provider"></a><span data-ttu-id="a2a69-102">设计 Windows PowerShell 提供程序</span><span class="sxs-lookup"><span data-stu-id="a2a69-102">Designing Your Windows PowerShell Provider</span></span>

<span data-ttu-id="a2a69-103">如果您的产品或配置公开一组存储数据，如用户会想要在导航或浏览数据库，则应实现一个 Windows PowerShell 提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-103">You should implement a Windows PowerShell provider if your product or configuration exposes a set of stored data, such as a database that the user will want to navigate or browse.</span></span> <span data-ttu-id="a2a69-104">此外，如果您的产品提供了一个容器，即使它不是多层次的容器，最好实现 Windows PowerShell 提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-104">Additionally, if your product provides a container, even if it is not a multilevel container, it makes sense to implement a Windows PowerShell provider.</span></span> <span data-ttu-id="a2a69-105">例如，你可能想要实现的 Windows PowerShell 容器提供程序 cmdlet 谓词复制、 移动、 重命名，新的、 或删除作为对您的产品或配置数据的操作会比较有利。</span><span class="sxs-lookup"><span data-stu-id="a2a69-105">For example, you might want to implement a Windows PowerShell container provider if the cmdlet verb Copy, Move, Rename, New, or Remove makes sense as an operation on your product or configuration data.</span></span>

## <a name="windows-powershell-paths-identify-your-provider"></a><span data-ttu-id="a2a69-106">Windows PowerShell 路径标识您的提供程序</span><span class="sxs-lookup"><span data-stu-id="a2a69-106">Windows PowerShell Paths Identify Your Provider</span></span>

<span data-ttu-id="a2a69-107">Windows PowerShell 运行时使用 Windows PowerShell 路径来访问相应的 Windows PowerShell 提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-107">The Windows PowerShell runtime uses Windows PowerShell paths to access the appropriate Windows PowerShell provider.</span></span> <span data-ttu-id="a2a69-108">当一个 cmdlet 指定两个路径时，运行时知道要使用来访问关联的数据存储区的提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-108">When a cmdlet specifies one of these paths, the runtime knows which provider to use to access the associated data store.</span></span> <span data-ttu-id="a2a69-109">这些路径包括驱动器限定的路径、 提供程序限定的路径、 提供程序直接路径和提供程序内部的路径。</span><span class="sxs-lookup"><span data-stu-id="a2a69-109">These paths include drive-qualified paths, provider-qualified paths, provider-direct paths, and provider-internal paths.</span></span> <span data-ttu-id="a2a69-110">每个 Windows PowerShell 提供程序必须支持一个或多个这些路径。</span><span class="sxs-lookup"><span data-stu-id="a2a69-110">Each Windows PowerShell provider must support one or more of these paths.</span></span>

<span data-ttu-id="a2a69-111">有关 Windows PowerShell 路径的详细信息，请参阅 Windows PowerShell 的工作原理。</span><span class="sxs-lookup"><span data-stu-id="a2a69-111">For more information about Windows PowerShell paths, see How Windows PowerShell Works.</span></span>

### <a name="defining-a-drive-qualified-path"></a><span data-ttu-id="a2a69-112">定义驱动器限定的路径</span><span class="sxs-lookup"><span data-stu-id="a2a69-112">Defining a Drive-Qualified Path</span></span>

<span data-ttu-id="a2a69-113">若要允许用户访问位于物理驱动器的数据，Windows PowerShell 提供程序必须支持的驱动器限定路径。</span><span class="sxs-lookup"><span data-stu-id="a2a69-113">To allow the user to access data located at a physical drive, your Windows PowerShell provider must support a drive-qualified path.</span></span> <span data-ttu-id="a2a69-114">此路径的开头使用跟一个冒号 （:），例如，mydrive:\abc\bar 驱动器名称。</span><span class="sxs-lookup"><span data-stu-id="a2a69-114">This path starts with the drive name followed by a colon (:), for example, mydrive:\abc\bar.</span></span>

### <a name="defining-a-provider-qualified-path"></a><span data-ttu-id="a2a69-115">定义提供程序限定的路径</span><span class="sxs-lookup"><span data-stu-id="a2a69-115">Defining a Provider-Qualified Path</span></span>

<span data-ttu-id="a2a69-116">若要允许 Windows PowerShell 运行时初始化和取消初始化提供程序，Windows PowerShell 提供程序必须支持的提供程序限定路径。</span><span class="sxs-lookup"><span data-stu-id="a2a69-116">To allow the Windows PowerShell runtime to initialize and uninitialize the provider, your Windows PowerShell provider must support a provider-qualified path.</span></span> <span data-ttu-id="a2a69-117">例如，文件系统::\\\uncshare\abc\bar 是由 Windows PowerShell filesystem 提供程序的提供程序限定路径。</span><span class="sxs-lookup"><span data-stu-id="a2a69-117">For example, FileSystem::\\\uncshare\abc\bar is the provider-qualified path for the filesystem provider furnished by Windows PowerShell.</span></span>

### <a name="defining-a-provider-direct-path"></a><span data-ttu-id="a2a69-118">定义提供程序直接路径</span><span class="sxs-lookup"><span data-stu-id="a2a69-118">Defining a Provider-Direct Path</span></span>

<span data-ttu-id="a2a69-119">若要允许远程访问 Windows PowerShell 提供程序，它应支持的提供程序直接路径要直接传递到 Windows PowerShell 提供程序为当前的位置。</span><span class="sxs-lookup"><span data-stu-id="a2a69-119">To allow remote access to your Windows PowerShell provider, it should support a provider-direct path to pass directly to the Windows PowerShell provider for the current location.</span></span> <span data-ttu-id="a2a69-120">例如，可以使用注册表的 Windows PowerShell 提供程序\\\server\regkeypath 作为提供程序直接路径。</span><span class="sxs-lookup"><span data-stu-id="a2a69-120">For example, the registry Windows PowerShell provider can use \\\server\regkeypath as a provider-direct path.</span></span>

### <a name="defining-a-provider-internal-path"></a><span data-ttu-id="a2a69-121">定义提供程序内部的路径</span><span class="sxs-lookup"><span data-stu-id="a2a69-121">Defining a Provider-Internal Path</span></span>

<span data-ttu-id="a2a69-122">若要允许使用 Windows PowerShell 应用程序编程接口 (Api) 访问数据的提供程序 cmdlet，Windows PowerShell 提供程序应支持的提供程序内部的路径。</span><span class="sxs-lookup"><span data-stu-id="a2a69-122">To allow the provider cmdlet to access data using non-Windows PowerShell application programming interfaces (APIs), your Windows PowerShell provider should support a provider-internal path.</span></span> <span data-ttu-id="a2a69-123">此路径指示后"::"中的提供程序限定路径。</span><span class="sxs-lookup"><span data-stu-id="a2a69-123">This path is indicated after the "::" in the provider-qualified path.</span></span> <span data-ttu-id="a2a69-124">例如，文件系统的 Windows PowerShell 提供程序的提供程序内部路径是\\\uncshare\abc\bar。</span><span class="sxs-lookup"><span data-stu-id="a2a69-124">For example, the provider-internal path for the filesystem Windows PowerShell provider is \\\uncshare\abc\bar.</span></span>

## <a name="changing-stored-data"></a><span data-ttu-id="a2a69-125">更改存储的数据</span><span class="sxs-lookup"><span data-stu-id="a2a69-125">Changing Stored Data</span></span>

<span data-ttu-id="a2a69-126">重写时修改基础数据存储区的方法，始终调用[System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject)方法替换的项的最新版本的更改方法。</span><span class="sxs-lookup"><span data-stu-id="a2a69-126">When overriding methods that modify the underlying data store, always call the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method with the most up-to-date version of the item changed by that method.</span></span> <span data-ttu-id="a2a69-127">提供程序基础结构确定是否需要传递到管道中，例如当用户指定了-PassThru 参数项对象。</span><span class="sxs-lookup"><span data-stu-id="a2a69-127">The provider infrastructure determines if the item object needs to be passed to the pipeline, such as when the user specifies the -PassThru parameter.</span></span> <span data-ttu-id="a2a69-128">如果检索最新项 （极大影响） 为高昂的操作，你可以测试 Context.PassThru 属性，以确定你实际上需要写入生成的项。</span><span class="sxs-lookup"><span data-stu-id="a2a69-128">If retrieving the most up-to-date item is a costly operation (performance-wise,) you can test the Context.PassThru property to determine if you actually need to write the resulting item.</span></span>

## <a name="choose-a-base-class-for-your-provider"></a><span data-ttu-id="a2a69-129">为您的提供程序选择的基类</span><span class="sxs-lookup"><span data-stu-id="a2a69-129">Choose a Base Class for Your Provider</span></span>

<span data-ttu-id="a2a69-130">Windows PowerShell 提供了大量可用于实现自己的 Windows PowerShell 提供程序的基类。</span><span class="sxs-lookup"><span data-stu-id="a2a69-130">Windows PowerShell provides a number of base classes that you can use to implement your own Windows PowerShell provider.</span></span> <span data-ttu-id="a2a69-131">在设计时提供程序，选择基类，在本部分中，最适合您的要求中所述。</span><span class="sxs-lookup"><span data-stu-id="a2a69-131">When designing a provider, choose the base class, described in this section, that is most suited to your requirements.</span></span>

<span data-ttu-id="a2a69-132">每个 Windows PowerShell 提供程序基类提供一组 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-132">Each Windows PowerShell provider base class makes available a set of cmdlets.</span></span> <span data-ttu-id="a2a69-133">本部分介绍了这些 cmdlet，但它没有描述其参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-133">This section describes the cmdlets, but it does not describe their parameters.</span></span>

<span data-ttu-id="a2a69-134">使用会话状态，Windows PowerShell 运行时向多个位置 cmdlet 提供某些 Windows PowerShell 提供程序，如`Get-Location`， `Set-Location`， `Pop-Location`，和`Push-Location`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-134">Using the session state, the Windows PowerShell runtime makes several location cmdlets available to certain Windows PowerShell providers, such as the `Get-Location`, `Set-Location`, `Pop-Location`, and `Push-Location` cmdlets.</span></span> <span data-ttu-id="a2a69-135">可以使用`Get-Help`cmdlet 来获取有关这些位置 cmdlet 的信息。</span><span class="sxs-lookup"><span data-stu-id="a2a69-135">You can use the `Get-Help` cmdlet to obtain information about these location cmdlets.</span></span>

### <a name="cmdletprovider-base-class"></a><span data-ttu-id="a2a69-136">CmdletProvider 基类</span><span class="sxs-lookup"><span data-stu-id="a2a69-136">CmdletProvider Base Class</span></span>

<span data-ttu-id="a2a69-137">[System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider)类定义了一个基本的 Windows PowerShell 提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-137">The [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) class defines a basic Windows PowerShell provider.</span></span> <span data-ttu-id="a2a69-138">此类支持的提供程序声明，提供了大量属性和方法可用于所有 Windows PowerShell 提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-138">This class supports the provider declaration and supplies a number of properties and methods that are available to all Windows PowerShell providers.</span></span> <span data-ttu-id="a2a69-139">通过调用类`Get-PSProvider`cmdlet 可列出所有可用提供程序会话。</span><span class="sxs-lookup"><span data-stu-id="a2a69-139">The class is invoked by the `Get-PSProvider` cmdlet to list all available providers for a session.</span></span> <span data-ttu-id="a2a69-140">此 cmdlet 的实现提供的会话状态。</span><span class="sxs-lookup"><span data-stu-id="a2a69-140">The implementation of this cmdlet is furnished by the session state.</span></span>

> [!NOTE]
> <span data-ttu-id="a2a69-141">Windows PowerShell 提供程序可供所有 Windows PowerShell 语言的作用域。</span><span class="sxs-lookup"><span data-stu-id="a2a69-141">Windows PowerShell providers are available to all Windows PowerShell language scopes.</span></span>

### <a name="drivecmdletprovider-base-class"></a><span data-ttu-id="a2a69-142">DriveCmdletProvider 基类</span><span class="sxs-lookup"><span data-stu-id="a2a69-142">DriveCmdletProvider Base Class</span></span>

<span data-ttu-id="a2a69-143">[System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)类定义支持的操作添加新的驱动器，删除现有驱动器和初始化默认驱动器的 Windows PowerShell 驱动器提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-143">The [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class defines a Windows PowerShell drive provider that supports operations for adding new drives, removing existing drives, and initializing default drives.</span></span> <span data-ttu-id="a2a69-144">例如，提供的 Windows PowerShell FileSystem 提供程序初始化的所有卷的装载，如硬盘驱动器和 CD/DVD 设备驱动器的驱动器。</span><span class="sxs-lookup"><span data-stu-id="a2a69-144">For example, the FileSystem provider provided by Windows PowerShell initializes drives for all volumes that are mounted, such as hard drives and CD/DVD device drives.</span></span>

<span data-ttu-id="a2a69-145">此类派生自[System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider)基类。</span><span class="sxs-lookup"><span data-stu-id="a2a69-145">This class derives from the [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class.</span></span> <span data-ttu-id="a2a69-146">下表列出了通过此类公开的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-146">The following table lists the cmdlets exposed by this class.</span></span> <span data-ttu-id="a2a69-147">除了所列的、 `Get-PSDrive` cmdlet （由会话状态） 是一个相关的 cmdlet 用于检索可用的驱动器。</span><span class="sxs-lookup"><span data-stu-id="a2a69-147">In addition to those listed, the `Get-PSDrive` cmdlet (exposed by session state) is a related cmdlet that is used to retrieve available drives.</span></span>

|<span data-ttu-id="a2a69-148">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a2a69-148">Cmdlet</span></span>|<span data-ttu-id="a2a69-149">定义</span><span class="sxs-lookup"><span data-stu-id="a2a69-149">Definition</span></span>|
|------------|----------------|
|`New-PSDrive`|<span data-ttu-id="a2a69-150">对于会话，请创建新的驱动器和驱动器信息进行流式传输。</span><span class="sxs-lookup"><span data-stu-id="a2a69-150">Creates a new drive for the session, and streams drive information.</span></span>|
|`Remove-PSDrive`|<span data-ttu-id="a2a69-151">从会话中删除一个驱动器。</span><span class="sxs-lookup"><span data-stu-id="a2a69-151">Removes a drive from the session.</span></span>|

### <a name="itemcmdletprovider-base-class"></a><span data-ttu-id="a2a69-152">ItemCmdletProvider 基类</span><span class="sxs-lookup"><span data-stu-id="a2a69-152">ItemCmdletProvider Base Class</span></span>

<span data-ttu-id="a2a69-153">[System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider)类定义对数据存储的各个项执行操作的 Windows PowerShell 项提供程序并不会假定任何容器或导航功能。</span><span class="sxs-lookup"><span data-stu-id="a2a69-153">The [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) class defines a Windows PowerShell item provider that performs operations on the individual items of the data store, and it does not assume any container or navigation capabilities.</span></span> <span data-ttu-id="a2a69-154">此类派生自[System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider)基类。</span><span class="sxs-lookup"><span data-stu-id="a2a69-154">This class derives from the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="a2a69-155">下表列出了通过此类公开的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-155">The following table lists the cmdlets exposed by this class.</span></span>

|<span data-ttu-id="a2a69-156">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a2a69-156">Cmdlet</span></span>|<span data-ttu-id="a2a69-157">定义</span><span class="sxs-lookup"><span data-stu-id="a2a69-157">Definition</span></span>|
|------------|----------------|
|`Clear-Item`|<span data-ttu-id="a2a69-158">清除项的指定位置的当前内容，并替换与指定提供程序的"清除"值。</span><span class="sxs-lookup"><span data-stu-id="a2a69-158">Clears the current content of items at the specified location, and replaces it with the "clear" value specified by the provider.</span></span> <span data-ttu-id="a2a69-159">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-159">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Get-Item`|<span data-ttu-id="a2a69-160">从指定位置检索项并流式传输结果对象。</span><span class="sxs-lookup"><span data-stu-id="a2a69-160">Retrieves items from the specified location, and streams the resultant objects.</span></span>|
|`Invoke-Item`|<span data-ttu-id="a2a69-161">调用指定的路径处的项的默认操作。</span><span class="sxs-lookup"><span data-stu-id="a2a69-161">Invokes the default action for the item at the specified path.</span></span>|
|`Set-Item`|<span data-ttu-id="a2a69-162">用指示值的指定位置设置的项。</span><span class="sxs-lookup"><span data-stu-id="a2a69-162">Sets an item at the specified location with the indicated value.</span></span> <span data-ttu-id="a2a69-163">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-163">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Resolve-Path`|<span data-ttu-id="a2a69-164">解决了有关 Windows PowerShell 路径和数据流路径信息的通配符。</span><span class="sxs-lookup"><span data-stu-id="a2a69-164">Resolves the wildcards for a Windows PowerShell path, and streams path information.</span></span>|
|`Test-Path`|<span data-ttu-id="a2a69-165">测试指定的路径，并返回`true`如果存在和`false`否则为。</span><span class="sxs-lookup"><span data-stu-id="a2a69-165">Tests for the specified path, and returns `true` if it exists and `false` otherwise.</span></span> <span data-ttu-id="a2a69-166">此 cmdlet 实现以支持`IsContainer`参数[System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject)方法。</span><span class="sxs-lookup"><span data-stu-id="a2a69-166">This cmdlet is implemented to support the `IsContainer` parameter for the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method.</span></span>|

### <a name="containercmdletprovider-base-class"></a><span data-ttu-id="a2a69-167">ContainerCmdletProvider 基类</span><span class="sxs-lookup"><span data-stu-id="a2a69-167">ContainerCmdletProvider Base Class</span></span>

<span data-ttu-id="a2a69-168">[System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)类定义的 Windows PowerShell 容器提供程序公开的数据应用商店项目，向用户的容器。</span><span class="sxs-lookup"><span data-stu-id="a2a69-168">The [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class defines a Windows PowerShell container provider that exposes a container, for data store items, to the user.</span></span> <span data-ttu-id="a2a69-169">请注意只有在没有一个容器 （没有嵌套的容器） 中它的项时，可以使用 Windows PowerShell 容器提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-169">Be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="a2a69-170">如果有嵌套的容器，则必须实现一个 Windows PowerShell 导航提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-170">If there are nested containers, then you must implement a Windows PowerShell navigation provider .</span></span>

<span data-ttu-id="a2a69-171">此类派生自[System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider)基类。</span><span class="sxs-lookup"><span data-stu-id="a2a69-171">This class derives from the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="a2a69-172">下表定义了此类实现的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-172">The following table defines the cmdlets implemented by this class.</span></span>

|<span data-ttu-id="a2a69-173">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a2a69-173">Cmdlet</span></span>|<span data-ttu-id="a2a69-174">定义</span><span class="sxs-lookup"><span data-stu-id="a2a69-174">Definition</span></span>|
|------------|----------------|
|`Copy-Item`|<span data-ttu-id="a2a69-175">将项从一个位置复制到另一个。</span><span class="sxs-lookup"><span data-stu-id="a2a69-175">Copies items from one location to another.</span></span> <span data-ttu-id="a2a69-176">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-176">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Get-Childitem`|<span data-ttu-id="a2a69-177">检索指定位置的子项，并以对象形式将其流式处理。</span><span class="sxs-lookup"><span data-stu-id="a2a69-177">Retrieves the child items at the specified location, and streams them as objects.</span></span>|
|`New-Item`|<span data-ttu-id="a2a69-178">在指定位置创建新项并流式传输结果对象。</span><span class="sxs-lookup"><span data-stu-id="a2a69-178">Creates new items at the specified location, and streams the resultant object.</span></span>|
|`Remove-Item`|<span data-ttu-id="a2a69-179">从指定位置移除项。</span><span class="sxs-lookup"><span data-stu-id="a2a69-179">Removes items from the specified location.</span></span>|
|`Rename-Item`|<span data-ttu-id="a2a69-180">重命名指定位置处的项。</span><span class="sxs-lookup"><span data-stu-id="a2a69-180">Renames an item at the specified location.</span></span> <span data-ttu-id="a2a69-181">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-181">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|

### <a name="navigationcmdletprovider-base-class"></a><span data-ttu-id="a2a69-182">NavigationCmdletProvider 基类</span><span class="sxs-lookup"><span data-stu-id="a2a69-182">NavigationCmdletProvider Base Class</span></span>

<span data-ttu-id="a2a69-183">[System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider)类定义执行操作的项的使用多个容器的 Windows PowerShell 导航提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-183">The [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) class defines a Windows PowerShell navigation provider that performs operations for items that use more than one container.</span></span> <span data-ttu-id="a2a69-184">此类派生自[System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)基类。</span><span class="sxs-lookup"><span data-stu-id="a2a69-184">This class derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="a2a69-185">下表列出了通过此类公开的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-185">The following table list the cmdlets exposed by this class.</span></span>

|<span data-ttu-id="a2a69-186">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a2a69-186">Cmdlet</span></span>|<span data-ttu-id="a2a69-187">定义</span><span class="sxs-lookup"><span data-stu-id="a2a69-187">Definition</span></span>|
|------------|----------------|
|<span data-ttu-id="a2a69-188">Combine-Path</span><span class="sxs-lookup"><span data-stu-id="a2a69-188">Combine-Path</span></span>|<span data-ttu-id="a2a69-189">将两个路径合并到单个路径，使用特定于提供程序的路径之间的分隔符。</span><span class="sxs-lookup"><span data-stu-id="a2a69-189">Combines two paths into a single path, using a provider-specific delimiter between paths.</span></span> <span data-ttu-id="a2a69-190">此 cmdlet 将流式传输的字符串。</span><span class="sxs-lookup"><span data-stu-id="a2a69-190">This cmdlet streams strings.</span></span>|
|`Move-Item`|<span data-ttu-id="a2a69-191">将项目移动到指定位置。</span><span class="sxs-lookup"><span data-stu-id="a2a69-191">Moves items to the specified location.</span></span> <span data-ttu-id="a2a69-192">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-192">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|

<span data-ttu-id="a2a69-193">相关的 cmdlet 是由 Windows PowerShell 的基本分析路径 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-193">A related cmdlet is the basic Parse-Path cmdlet furnished by Windows PowerShell.</span></span> <span data-ttu-id="a2a69-194">此 cmdlet 可用于 Windows PowerShell 路径，以支持分析`Parent`参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-194">This cmdlet can be used to parse a Windows PowerShell path to support the `Parent` parameter.</span></span> <span data-ttu-id="a2a69-195">流式处理的父路径字符串。</span><span class="sxs-lookup"><span data-stu-id="a2a69-195">It streams the parent path string.</span></span>

## <a name="select-provider-interfaces-to-support"></a><span data-ttu-id="a2a69-196">选择支持的提供程序接口</span><span class="sxs-lookup"><span data-stu-id="a2a69-196">Select Provider Interfaces to Support</span></span>

<span data-ttu-id="a2a69-197">除了从 Windows PowerShell 基础类之一派生，Windows PowerShell 提供程序可以通过从一个或多个以下的提供程序接口派生来支持其他功能。</span><span class="sxs-lookup"><span data-stu-id="a2a69-197">In addition to deriving from one of the Windows PowerShell base classes, your Windows PowerShell provider can support other functionality by deriving from one or more of the following provider interfaces.</span></span> <span data-ttu-id="a2a69-198">本部分将定义这些接口和支持的每个 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-198">This section defines those interfaces and the cmdlets supported by each.</span></span> <span data-ttu-id="a2a69-199">它没有描述的接口支持的 cmdlet 的参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-199">It does not describe the parameters for the interface-supported cmdlets.</span></span> <span data-ttu-id="a2a69-200">Cmdlet 参数信息，请使用联机`Get-Command`和`Get-Help`cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-200">Cmdlet parameter information is available online using the `Get-Command` and `Get-Help` cmdlets.</span></span>

### <a name="icontentcmdletprovider"></a><span data-ttu-id="a2a69-201">IContentCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="a2a69-201">IContentCmdletProvider</span></span>

<span data-ttu-id="a2a69-202">[System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider)接口定义执行操作的内容的数据项的内容提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-202">The [System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) interface defines a content provider that performs operations on the content of a data item.</span></span> <span data-ttu-id="a2a69-203">下表列出了此接口提供的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-203">The following table lists the cmdlets exposed by this interface.</span></span>

|<span data-ttu-id="a2a69-204">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a2a69-204">Cmdlet</span></span>|<span data-ttu-id="a2a69-205">定义</span><span class="sxs-lookup"><span data-stu-id="a2a69-205">Definition</span></span>|
|------------|----------------|
|`Add-Content`|<span data-ttu-id="a2a69-206">将指示的值长度追加到指定项的内容。</span><span class="sxs-lookup"><span data-stu-id="a2a69-206">Appends the indicated value lengths to the contents of the specified item.</span></span> <span data-ttu-id="a2a69-207">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-207">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Clear-Content`|<span data-ttu-id="a2a69-208">将指定项的内容设置为"清除"的值。</span><span class="sxs-lookup"><span data-stu-id="a2a69-208">Sets the content of the specified item to the "clear" value.</span></span> <span data-ttu-id="a2a69-209">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-209">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Get-Content`|<span data-ttu-id="a2a69-210">检索指定项的内容并流式传输结果对象。</span><span class="sxs-lookup"><span data-stu-id="a2a69-210">Retrieves the contents of the specified items and streams the resultant objects.</span></span>|
|`Set-Content`|<span data-ttu-id="a2a69-211">替换指定项的现有内容。</span><span class="sxs-lookup"><span data-stu-id="a2a69-211">Replaces the existing content for the specified items.</span></span> <span data-ttu-id="a2a69-212">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-212">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|

### <a name="ipropertycmdletprovider"></a><span data-ttu-id="a2a69-213">IPropertyCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="a2a69-213">IPropertyCmdletProvider</span></span>

<span data-ttu-id="a2a69-214">[System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)接口定义属性的 Windows PowerShell 提供程序，在数据存储区中执行操作的项的属性。</span><span class="sxs-lookup"><span data-stu-id="a2a69-214">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface defines a property Windows PowerShell provider that performs operations on the properties of items in the data store.</span></span> <span data-ttu-id="a2a69-215">下表列出了此接口提供的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-215">The following table lists the cmdlets exposed by this interface.</span></span>

> [!NOTE]
> <span data-ttu-id="a2a69-216">`Path`有关这些 cmdlet 的参数指示的项而不是标识某个属性的路径。</span><span class="sxs-lookup"><span data-stu-id="a2a69-216">The `Path` parameter on these cmdlets indicates a path to an item instead of identifying a property.</span></span>

|<span data-ttu-id="a2a69-217">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a2a69-217">Cmdlet</span></span>|<span data-ttu-id="a2a69-218">定义</span><span class="sxs-lookup"><span data-stu-id="a2a69-218">Definition</span></span>|
|------------|----------------|
|`Clear-ItemProperty`|<span data-ttu-id="a2a69-219">将指定项的属性设置为"清除"的值。</span><span class="sxs-lookup"><span data-stu-id="a2a69-219">Sets properties of the specified items to the "clear" value.</span></span> <span data-ttu-id="a2a69-220">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-220">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Get-ItemProperty`|<span data-ttu-id="a2a69-221">从指定的项中检索属性，并流式传输结果对象。</span><span class="sxs-lookup"><span data-stu-id="a2a69-221">Retrieves properties from the specified items and streams the resultant objects.</span></span>|
|`Set-ItemProperty`|<span data-ttu-id="a2a69-222">设置具有所示值的指定项的属性。</span><span class="sxs-lookup"><span data-stu-id="a2a69-222">Sets properties of the specified items with the indicated values.</span></span> <span data-ttu-id="a2a69-223">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-223">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|

### <a name="idynamicpropertycmdletprovider"></a><span data-ttu-id="a2a69-224">IDynamicPropertyCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="a2a69-224">IDynamicPropertyCmdletProvider</span></span>

<span data-ttu-id="a2a69-225">[System.Management.Automation.Provider.Idynamicpropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IDynamicPropertyCmdletProvider)接口，派生自[System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider)，定义指定其支持的 cmdlet 的动态参数的提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-225">The [System.Management.Automation.Provider.Idynamicpropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IDynamicPropertyCmdletProvider) interface, derived from [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider), defines a provider that specifies dynamic parameters for its supported cmdlets.</span></span> <span data-ttu-id="a2a69-226">此类型提供程序的处理的操作，在运行时，例如，新的属性操作可以为其定义属性。</span><span class="sxs-lookup"><span data-stu-id="a2a69-226">This type of provider handles operations for which properties can be defined at run time, for example, a new property operation.</span></span> <span data-ttu-id="a2a69-227">此类操作不能以静态方式定义属性的项。</span><span class="sxs-lookup"><span data-stu-id="a2a69-227">Such operations are not possible on items having statically defined properties.</span></span> <span data-ttu-id="a2a69-228">下表列出了此接口提供的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-228">The following table lists the cmdlets exposed by this interface.</span></span>

|<span data-ttu-id="a2a69-229">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a2a69-229">Cmdlet</span></span>|<span data-ttu-id="a2a69-230">定义</span><span class="sxs-lookup"><span data-stu-id="a2a69-230">Definition</span></span>|
|------------|----------------|
|`Copy-ItemProperty`|<span data-ttu-id="a2a69-231">将属性从指定的项复制到另一个项。</span><span class="sxs-lookup"><span data-stu-id="a2a69-231">Copies a property from the specified item to another item.</span></span> <span data-ttu-id="a2a69-232">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-232">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`Move-ItemProperty`|<span data-ttu-id="a2a69-233">将属性从指定的项移动到另一个项。</span><span class="sxs-lookup"><span data-stu-id="a2a69-233">Moves a property from the specified item to another item.</span></span> <span data-ttu-id="a2a69-234">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-234">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|
|`New-ItemProperty`|<span data-ttu-id="a2a69-235">在指定的项上创建属性并流式传输结果对象。</span><span class="sxs-lookup"><span data-stu-id="a2a69-235">Creates a property on the specified items and streams the resultant objects.</span></span>|
|`Remove-ItemProperty`|<span data-ttu-id="a2a69-236">删除指定项的属性。</span><span class="sxs-lookup"><span data-stu-id="a2a69-236">Removes a property for the specified items.</span></span>|
|`Rename-ItemProperty`|<span data-ttu-id="a2a69-237">重命名指定的项的属性。</span><span class="sxs-lookup"><span data-stu-id="a2a69-237">Renames a property of the specified items.</span></span> <span data-ttu-id="a2a69-238">此 cmdlet 没有通过输出对象通过管道，除非其`PassThru`指定参数。</span><span class="sxs-lookup"><span data-stu-id="a2a69-238">This cmdlet does not pass an output object through the pipeline unless its `PassThru` parameter is specified.</span></span>|

### <a name="isecuritydescriptorcmdletprovider"></a><span data-ttu-id="a2a69-239">ISecurityDescriptorCmdletProvider</span><span class="sxs-lookup"><span data-stu-id="a2a69-239">ISecurityDescriptorCmdletProvider</span></span>

<span data-ttu-id="a2a69-240">[System.Management.Automation.Provider.Isecuritydescriptorcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ISecurityDescriptorCmdletProvider)接口将安全描述符功能添加到提供程序。</span><span class="sxs-lookup"><span data-stu-id="a2a69-240">The [System.Management.Automation.Provider.Isecuritydescriptorcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ISecurityDescriptorCmdletProvider) interface adds security descriptor functionality to a provider.</span></span> <span data-ttu-id="a2a69-241">此接口允许用户获取和设置数据存储区中的项的安全描述符信息。</span><span class="sxs-lookup"><span data-stu-id="a2a69-241">This interface allows the user to get and set security descriptor information for an item in the data store.</span></span> <span data-ttu-id="a2a69-242">下表列出了此接口提供的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a2a69-242">The following table lists the cmdlets exposed by this interface.</span></span>

|<span data-ttu-id="a2a69-243">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a2a69-243">Cmdlet</span></span>|<span data-ttu-id="a2a69-244">定义</span><span class="sxs-lookup"><span data-stu-id="a2a69-244">Definition</span></span>|
|------------|----------------|
|`Get-Acl`|<span data-ttu-id="a2a69-245">检索访问控制列表 (ACL)，这是一个用于防止操作系统资源，例如的安全描述符、 文件或对象的一部分中所包含的信息。</span><span class="sxs-lookup"><span data-stu-id="a2a69-245">Retrieves the information contained in an access control list (ACL), which is part of a security descriptor used to guard operating system resources, for example, a file or an object.</span></span>|
|`Set-Acl`|<span data-ttu-id="a2a69-246">设置 ACL 的信息。</span><span class="sxs-lookup"><span data-stu-id="a2a69-246">Sets the information for an ACL.</span></span> <span data-ttu-id="a2a69-247">它的实例的形式是[System.Security.Accesscontrol.Objectsecurity](/dotnet/api/System.Security.AccessControl.ObjectSecurity)为指定的路径指定的项上。</span><span class="sxs-lookup"><span data-stu-id="a2a69-247">It is in the form of an instance of [System.Security.Accesscontrol.Objectsecurity](/dotnet/api/System.Security.AccessControl.ObjectSecurity) on the item(s) designated for the specified path.</span></span> <span data-ttu-id="a2a69-248">如果 Windows PowerShell 提供程序支持的安全信息的设置，此 cmdlet 可以在注册表中或任何其他提供程序项，设置有关文件、 项和子项的信息。</span><span class="sxs-lookup"><span data-stu-id="a2a69-248">This cmdlet can set information about files, keys, and subkeys in the registry, or any other provider item, if the Windows PowerShell provider supports the setting of security information.</span></span>|

## <a name="see-also"></a><span data-ttu-id="a2a69-249">另请参阅</span><span class="sxs-lookup"><span data-stu-id="a2a69-249">See Also</span></span>

[<span data-ttu-id="a2a69-250">创建 Windows PowerShell 提供程序</span><span class="sxs-lookup"><span data-stu-id="a2a69-250">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="a2a69-251">Windows PowerShell 的工作原理</span><span class="sxs-lookup"><span data-stu-id="a2a69-251">How Windows PowerShell Works</span></span>](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58)

[<span data-ttu-id="a2a69-252">Windows PowerShell 的工作原理</span><span class="sxs-lookup"><span data-stu-id="a2a69-252">How Windows PowerShell Works</span></span>](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58)

[<span data-ttu-id="a2a69-253">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="a2a69-253">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)