---
title: 如何创建控制台 Shell |Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Make-Shell [PowerShell Programmer's Guide]
ms.assetid: 6c24dd44-a8ec-421d-ac86-90912e1a8cc6
caps.latest.revision: 5
ms.openlocfilehash: 7166881bd1403ea8c81ec2928321f6b93e3ac58d
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "62081561"
---
# <a name="how-to-create-a-console-shell"></a><span data-ttu-id="1b9be-102">如何创建控制台 Shell</span><span class="sxs-lookup"><span data-stu-id="1b9be-102">How to Create a Console Shell</span></span>

<span data-ttu-id="1b9be-103">Windows PowerShell 提供了使 Shell 工具，也称为"请-工具包"，用于创建不可扩展的控制台 shell。</span><span class="sxs-lookup"><span data-stu-id="1b9be-103">Windows PowerShell provides a Make-Shell tool, also referred to as the "make-kit", that is used to create a console shell that is not extensible.</span></span> <span data-ttu-id="1b9be-104">使用此新工具创建的 shell 不能通过 Windows PowerShell 管理单元的更高版本扩展。</span><span class="sxs-lookup"><span data-stu-id="1b9be-104">Shells created with this new tool cannot be extended later through a Windows PowerShell snap-in.</span></span>

## <a name="syntax"></a><span data-ttu-id="1b9be-105">语法</span><span class="sxs-lookup"><span data-stu-id="1b9be-105">Syntax</span></span>

<span data-ttu-id="1b9be-106">下面是用于运行使 Shell 从生成文件中的语法。</span><span class="sxs-lookup"><span data-stu-id="1b9be-106">Here is the syntax used to run Make-Shell from within a make-file.</span></span>

```
make-shell
  -out n.exe
  -namespace ns
  [ -lib libdirectory1[,libdirectory2,..] ]
  [ -reference ca1.dll[,ca2.dll,...] ]
  [ -formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...] ]
  [ -typedata td1.type.ps1xml[,td2.type.ps1xml,...] ]
  [ -source c1.cs [,c2.cs,...] ]
  [ -authorizationmanager authorizationManagerType ]
  [ -win32icon i.ico ]
  [ -initscript p.ps1 ]
  [ -builtinscript s1.ps1[,s2.ps1,...] ]
  [ -resource resourcefile.txt ]
  [ -cscflags cscFlags ]
  [ -? | -help ]
```

## <a name="parameters"></a><span data-ttu-id="1b9be-107">参数</span><span class="sxs-lookup"><span data-stu-id="1b9be-107">Parameters</span></span>

<span data-ttu-id="1b9be-108">下面是使 Shell 的参数的简要说明。</span><span class="sxs-lookup"><span data-stu-id="1b9be-108">Here is a brief description of the parameters of Make-Shell.</span></span>

> [!CAUTION]
> <span data-ttu-id="1b9be-109">通过使 Shell 不支持程序集的 UNC 路径。</span><span class="sxs-lookup"><span data-stu-id="1b9be-109">UNC paths to assemblies are not supported by Make-Shell.</span></span>

|<span data-ttu-id="1b9be-110">参数</span><span class="sxs-lookup"><span data-stu-id="1b9be-110">Parameter</span></span>|<span data-ttu-id="1b9be-111">说明</span><span class="sxs-lookup"><span data-stu-id="1b9be-111">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="1b9be-112">-out n.exe</span><span class="sxs-lookup"><span data-stu-id="1b9be-112">-out n.exe</span></span>|<span data-ttu-id="1b9be-113">必需。</span><span class="sxs-lookup"><span data-stu-id="1b9be-113">Required.</span></span> <span data-ttu-id="1b9be-114">命令行程序生成的名称。</span><span class="sxs-lookup"><span data-stu-id="1b9be-114">The name of the shell to produce.</span></span> <span data-ttu-id="1b9be-115">路径指定为此参数的一部分。</span><span class="sxs-lookup"><span data-stu-id="1b9be-115">The path is specified as part of this parameter.</span></span><br /><br /> <span data-ttu-id="1b9be-116">如果未指定，使 shell 会将".exe"追加到此值。</span><span class="sxs-lookup"><span data-stu-id="1b9be-116">Make-shell will append ".exe" to this value if it is not specified.</span></span> <span data-ttu-id="1b9be-117">**注意：** 不要创建输出文件具有相同名称与引用的.dll 文件。</span><span class="sxs-lookup"><span data-stu-id="1b9be-117">**Caution:**  Do not create an output file with the same name as the referenced .dll file.</span></span> <span data-ttu-id="1b9be-118">如果尝试这样做，请 Shell 工具将创建具有相同的名称，这将覆盖具有 cmdlet 源代码的.cs 文件的.cs 文件。</span><span class="sxs-lookup"><span data-stu-id="1b9be-118">If you attempt this, the Make-Shell tool creates a .cs file with the same name, which will overwrite the .cs file that has your cmdlet source code.</span></span>|
|<span data-ttu-id="1b9be-119">命名空间 ns</span><span class="sxs-lookup"><span data-stu-id="1b9be-119">-namespace ns</span></span>|<span data-ttu-id="1b9be-120">必需。</span><span class="sxs-lookup"><span data-stu-id="1b9be-120">Required.</span></span> <span data-ttu-id="1b9be-121">要用于派生的命名空间[System.Management.Automation.Runspaces.Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration)品牌工具包生成和编译的类。</span><span class="sxs-lookup"><span data-stu-id="1b9be-121">The namespace to use for the derived [System.Management.Automation.Runspaces.Runspaceconfiguration](/dotnet/api/System.Management.Automation.Runspaces.RunspaceConfiguration) class that the make-kit generates and compiles.</span></span>|
|<span data-ttu-id="1b9be-122">-lib libdirectory1[,libdirectory2,..]</span><span class="sxs-lookup"><span data-stu-id="1b9be-122">-lib libdirectory1[,libdirectory2,..]</span></span>|<span data-ttu-id="1b9be-123">对于.NET 程序集，包括 Windows PowerShell 程序集，通过指定的程序集搜索的目录`reference`参数、 间接引用另一个程序集的程序集和.NET 系统程序集。</span><span class="sxs-lookup"><span data-stu-id="1b9be-123">The directories that are searched for .NET assemblies, including the Windows PowerShell assemblies, assemblies specified by the `reference` parameter, assemblies indirectly referenced by another assembly, and the .NET system assemblies.</span></span>|
|<span data-ttu-id="1b9be-124">-reference ca1.dll[,ca2.dll,...]</span><span class="sxs-lookup"><span data-stu-id="1b9be-124">-reference ca1.dll[,ca2.dll,...]</span></span>|<span data-ttu-id="1b9be-125">逗号分隔的要包括在 shell 中的程序集列表。</span><span class="sxs-lookup"><span data-stu-id="1b9be-125">A comma-separated list of the assemblies to include in the shell.</span></span> <span data-ttu-id="1b9be-126">这些程序集包括所有 cmdlet 和提供程序程序集，以及应加载的资源程序集。</span><span class="sxs-lookup"><span data-stu-id="1b9be-126">These assemblies  includes all cmdlet and provider assemblies, as well as resource assemblies that should be loaded.</span></span> <span data-ttu-id="1b9be-127">如果未指定此参数，然后一个外壳会生成包含核心 cmdlet 和提供的 Windows PowerShell 提供程序。</span><span class="sxs-lookup"><span data-stu-id="1b9be-127">If this parameter is not specified, then a shell is produced that contains only the core cmdlets and providers provided by Windows PowerShell.</span></span><br /><br /> <span data-ttu-id="1b9be-128">可以使用其完整路径指定程序集，否则将使用指定的路径搜索它们`lib`参数。</span><span class="sxs-lookup"><span data-stu-id="1b9be-128">The assemblies can be specified using their full path, otherwise they will be searched for using the path specified by the `lib` parameter.</span></span>|
|<span data-ttu-id="1b9be-129">-formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="1b9be-129">-formatdata fd1.format.ps1xml[,fd2.format.ps1xml,...]</span></span>|<span data-ttu-id="1b9be-130">要包括在 shell 中的格式数据的以逗号分隔列表。</span><span class="sxs-lookup"><span data-stu-id="1b9be-130">A comma-separated list of format data to include in the shell.</span></span> <span data-ttu-id="1b9be-131">如果未指定此参数，然后一个外壳会生成包含由 Windows PowerShell 提供的格式数据。</span><span class="sxs-lookup"><span data-stu-id="1b9be-131">If this parameter is not specified, then a shell is produced that contains only the format data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="1b9be-132">-typedata td1.type.ps1xml[,td2.type.ps1xml,...]</span><span class="sxs-lookup"><span data-stu-id="1b9be-132">-typedata td1.type.ps1xml[,td2.type.ps1xml,...]</span></span>|<span data-ttu-id="1b9be-133">若要包括在 shell 中的数据类型以逗号分隔列表。</span><span class="sxs-lookup"><span data-stu-id="1b9be-133">A comma-separated list of type data to include in the shell.</span></span> <span data-ttu-id="1b9be-134">如果未指定此参数，然后一个外壳会生成包含由 Windows PowerShell 提供的类型数据。</span><span class="sxs-lookup"><span data-stu-id="1b9be-134">If this parameter is not specified, then a shell is produced that contains only the type data provided by Windows PowerShell.</span></span>|
|<span data-ttu-id="1b9be-135">-source c1.cs [,c2.cs,...]</span><span class="sxs-lookup"><span data-stu-id="1b9be-135">-source c1.cs [,c2.cs,...]</span></span>|<span data-ttu-id="1b9be-136">提供的命令行程序开发人员，包含生成命令行程序所需的任何源代码的文件的名称。</span><span class="sxs-lookup"><span data-stu-id="1b9be-136">The name of a file, provided by the shell developer, that contains any source code needed to build the shell.</span></span><br /><br /> <span data-ttu-id="1b9be-137">源代码文件可以包含任何以下源代码：</span><span class="sxs-lookup"><span data-stu-id="1b9be-137">The source code file can contain any of the following source code:</span></span><br /><br /> <span data-ttu-id="1b9be-138">-重写默认授权管理器授权管理器实现。</span><span class="sxs-lookup"><span data-stu-id="1b9be-138">-   The Authorization manager implementation that overrides the default authorization manager.</span></span> <span data-ttu-id="1b9be-139">（这可能还提供编译成程序集。）</span><span class="sxs-lookup"><span data-stu-id="1b9be-139">(This could also be supplied compiled into an assembly.)</span></span><br /><span data-ttu-id="1b9be-140">程序集信息性特性声明： 如 AssemblyCompanyAttribute、 AssemblyCopyrightAttribute、 AssemblyFileVersionAttribute、 AssemblyInformationalVersionAttribute、 AssemblyProductAttribute，和AssemblyTrademarkAttribute。</span><span class="sxs-lookup"><span data-stu-id="1b9be-140">-   Assembly informational attribute declarations: such as the AssemblyCompanyAttribute, AssemblyCopyrightAttribute, AssemblyFileVersionAttribute, AssemblyInformationalVersionAttribute, AssemblyProductAttribute, and AssemblyTrademarkAttribute.</span></span>|
|<span data-ttu-id="1b9be-141">-authorizationmanager authorizationManagerType</span><span class="sxs-lookup"><span data-stu-id="1b9be-141">-authorizationmanager authorizationManagerType</span></span>|<span data-ttu-id="1b9be-142">包含授权管理器实现的类型。</span><span class="sxs-lookup"><span data-stu-id="1b9be-142">The type that contains the authorization manager implementation.</span></span> <span data-ttu-id="1b9be-143">这可定义在源代码中，或编译到程序集 (由指定`reference`参数)。</span><span class="sxs-lookup"><span data-stu-id="1b9be-143">This can be defined in source code, or compiled into an assembly (specified by the `reference` parameter).</span></span> <span data-ttu-id="1b9be-144">如果未指定此参数，则使用默认的安全管理器。</span><span class="sxs-lookup"><span data-stu-id="1b9be-144">If this parameter is not specified, the default security manager is used.</span></span> <span data-ttu-id="1b9be-145">值应为完整类型名称，包括命名空间。</span><span class="sxs-lookup"><span data-stu-id="1b9be-145">The value should be the full type name, including namespaces.</span></span>|
|<span data-ttu-id="1b9be-146">-win32icon i.ico</span><span class="sxs-lookup"><span data-stu-id="1b9be-146">-win32icon i.ico</span></span>|<span data-ttu-id="1b9be-147">命令行程序.exe 文件的图标。</span><span class="sxs-lookup"><span data-stu-id="1b9be-147">The icon for the .exe file for the shell.</span></span> <span data-ttu-id="1b9be-148">如果未指定，shell 将具有 c# 编译器包含 （如果有） 的图标。</span><span class="sxs-lookup"><span data-stu-id="1b9be-148">If not specified, then the shell will have the icon that the c# compiler includes (if any).</span></span>|
|<span data-ttu-id="1b9be-149">-initscript p.ps1</span><span class="sxs-lookup"><span data-stu-id="1b9be-149">-initscript p.ps1</span></span>|<span data-ttu-id="1b9be-150">在 shell 启动配置文件。</span><span class="sxs-lookup"><span data-stu-id="1b9be-150">The startup profile for the shell.</span></span> <span data-ttu-id="1b9be-151">该文件是包含"作为-是";没有有效性检查，可以使 Shell。</span><span class="sxs-lookup"><span data-stu-id="1b9be-151">The file is included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="1b9be-152">-builtinscript s1.ps1[,s2.ps1,...]</span><span class="sxs-lookup"><span data-stu-id="1b9be-152">-builtinscript s1.ps1[,s2.ps1,...]</span></span>|<span data-ttu-id="1b9be-153">Shell 的内置脚本的列表。</span><span class="sxs-lookup"><span data-stu-id="1b9be-153">A list of built-in scripts for the shell.</span></span> <span data-ttu-id="1b9be-154">在路径中，脚本之前发现这些脚本和命令行程序构建后不能更改其内容。</span><span class="sxs-lookup"><span data-stu-id="1b9be-154">These scripts are discovered before scripts in the path, and their contents cannot be changed once the shell is built.</span></span><br /><br /> <span data-ttu-id="1b9be-155">将包含这些文件"作为-是";没有有效性检查，可以使 Shell。</span><span class="sxs-lookup"><span data-stu-id="1b9be-155">The files are included "as-is"; no validity checking is done by Make-Shell.</span></span>|
|<span data-ttu-id="1b9be-156">-资源 resourcefile.txt</span><span class="sxs-lookup"><span data-stu-id="1b9be-156">-resource resourcefile.txt</span></span>|<span data-ttu-id="1b9be-157">包含帮助和横幅 shell 的资源的.txt 文件。</span><span class="sxs-lookup"><span data-stu-id="1b9be-157">The .txt file containing help and banner resources for the shell.</span></span> <span data-ttu-id="1b9be-158">第一个资源命名 ShellHelp，并且包含当 shell 调用使用了显示的文本`help`参数。</span><span class="sxs-lookup"><span data-stu-id="1b9be-158">The first resource is named ShellHelp, and contains the text displayed if the shell is invoked with the `help` parameter.</span></span> <span data-ttu-id="1b9be-159">第二个资源命名 ShellBanner，并且它包含的文本和 shell 在交互模式下启动时显示的版权信息。</span><span class="sxs-lookup"><span data-stu-id="1b9be-159">The second resource is named ShellBanner, and it contains the text and copyright information displayed when the shell is launched in interactive mode.</span></span><br /><br /> <span data-ttu-id="1b9be-160">如果未提供此参数，或这些资源不存在，则泛型帮助和横幅使用。</span><span class="sxs-lookup"><span data-stu-id="1b9be-160">If this parameter is not provided, or these resources are not present, then a generic help and banner are used.</span></span>|
|<span data-ttu-id="1b9be-161">-cscflags cscFlags</span><span class="sxs-lookup"><span data-stu-id="1b9be-161">-cscflags cscFlags</span></span>|<span data-ttu-id="1b9be-162">标志应传递给C#编译器 (csc.exe)。</span><span class="sxs-lookup"><span data-stu-id="1b9be-162">Flags that should be passed to the C# compiler (csc.exe).</span></span> <span data-ttu-id="1b9be-163">这些是通过传递不变。</span><span class="sxs-lookup"><span data-stu-id="1b9be-163">These are passed through unchanged.</span></span> <span data-ttu-id="1b9be-164">如果此参数包含空格，它应该括在双引号中。</span><span class="sxs-lookup"><span data-stu-id="1b9be-164">If this parameter includes spaces, it should be surrounded in double-quotes.</span></span>|
|<span data-ttu-id="1b9be-165">-?</span><span class="sxs-lookup"><span data-stu-id="1b9be-165">-?</span></span><br /><br /> <span data-ttu-id="1b9be-166">-help</span><span class="sxs-lookup"><span data-stu-id="1b9be-166">-help</span></span>|<span data-ttu-id="1b9be-167">显示版权消息和使 Shell 命令行选项。</span><span class="sxs-lookup"><span data-stu-id="1b9be-167">Displays the copyright message and Make-Shell command line options.</span></span>|
|<span data-ttu-id="1b9be-168">-verbose</span><span class="sxs-lookup"><span data-stu-id="1b9be-168">-verbose</span></span>|<span data-ttu-id="1b9be-169">在创建外壳程序时显示的详细信息。</span><span class="sxs-lookup"><span data-stu-id="1b9be-169">Displays detailed information while the shell is being created.</span></span>|

## <a name="see-also"></a><span data-ttu-id="1b9be-170">另请参阅</span><span class="sxs-lookup"><span data-stu-id="1b9be-170">See Also</span></span>

[<span data-ttu-id="1b9be-171">Windows PowerShell 程序员指南</span><span class="sxs-lookup"><span data-stu-id="1b9be-171">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="1b9be-172">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="1b9be-172">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)