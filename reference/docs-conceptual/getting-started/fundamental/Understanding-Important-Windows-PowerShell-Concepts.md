---
ms.date: 2017-06-05
keywords: powershell,cmdlet
title: "了解重要的 Windows PowerShell 概念"
ms.assetid: 3e601e38-4520-4578-a48d-b6779f1d35ee
ms.openlocfilehash: 1ffcfefcc7ffc7c98ba4d1e3ccc9a59cd9b0baac
ms.sourcegitcommit: 598b7835046577841aea2211d613bb8513271a8b
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/08/2017
---
# <a name="understanding-important-windows-powershell-concepts"></a><span data-ttu-id="2ed7b-103">了解重要的 Windows PowerShell 概念</span><span class="sxs-lookup"><span data-stu-id="2ed7b-103">Understanding Important Windows PowerShell Concepts</span></span>
<span data-ttu-id="2ed7b-104">Windows PowerShell 设计集成了很多不同环境的概念。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-104">The Windows PowerShell design integrates concepts from many different environments.</span></span> <span data-ttu-id="2ed7b-105">具有特定 Shell 或编程环境方面经验的人会对其中几种比较熟悉，但很少有人了解全部概念。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-105">Several of them are familiar to people with experience in specific shells or programming environments, but very few people will know about all of them.</span></span> <span data-ttu-id="2ed7b-106">查看其中一些概念可获得有关 Shell 的有用概述。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-106">Looking at some of these concepts provides a useful overview of the shell.</span></span>

### <a name="commands-are-not-text-based"></a><span data-ttu-id="2ed7b-107">命令不基于文本</span><span class="sxs-lookup"><span data-stu-id="2ed7b-107">Commands Are Not Text-Based</span></span>
<span data-ttu-id="2ed7b-108">与传统的命令行接口命令不同，Windows PowerShell cmdlet 旨在处理对象结构的信息，这些信息不仅仅只是显示在屏幕上的字符串。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-108">Unlike traditional command-line interface commands, Windows PowerShell cmdlets are designed to deal with objects - structured information that is more than just a string of characters appearing on the screen.</span></span> <span data-ttu-id="2ed7b-109">命令输出会始终包含你在需要时可使用的额外信息。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-109">Command output always carries along extra information that you can use if you need it.</span></span> <span data-ttu-id="2ed7b-110">我们将在本文档中深入讨论这个主题。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-110">We will discuss this topic in depth in this document.</span></span>

<span data-ttu-id="2ed7b-111">如果你过去使用过文本处理工具来处理命令行数据，你会发现它们在 Windows PowerShell 中的使用和工作方式会有所不同。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-111">If you have used text-processing tools to process command-line data in the past, you will find that they behave differently if you try to use them in Windows PowerShell.</span></span> <span data-ttu-id="2ed7b-112">在大多数情况下，你不需要文本或文本处理工具来提取特定信息。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-112">In most cases, you do not need text-processing tools to extract specific information.</span></span> <span data-ttu-id="2ed7b-113">可以使用标准 Windows PowerShell 对象操作命令直接访问部分数据。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-113">You can access portions of the data directly by using standard Windows PowerShell object manipulation commands.</span></span>

### <a name="the-command-family-is-extensible"></a><span data-ttu-id="2ed7b-114">命令系列是可扩展的</span><span class="sxs-lookup"><span data-stu-id="2ed7b-114">The Command Family Is Extensible</span></span>
<span data-ttu-id="2ed7b-115">接口（比如 Cmd.exe）不提供可直接扩展内置命令集的方法。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-115">Interfaces such as Cmd.exe do not provide a way for you to directly extend the built-in command set.</span></span> <span data-ttu-id="2ed7b-116">你可以创建在 Cmd.exe 中运行的外部命令行工具，但这些外部工具没有服务（例如帮助集成），并且 Cmd.exe 不能自动了解它们是有效命令。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-116">You can create external command-line tools that run in Cmd.exe, but these external tools do not have services, such as Help integration, and Cmd.exe does not automatically know that they are valid commands.</span></span>

<span data-ttu-id="2ed7b-117">Windows PowerShell 中的本机二进制命令称为 *cmdlet*（读作 command-lets），可以通过创建 cmdlet 和使用管理单元向 Windows PowerShell 添加 cmdlet 来进行扩充。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-117">The native binary commands in Windows PowerShell, known as *cmdlets* (pronounced command-lets), can be augmented by cmdlets that you create and that you add to Windows PowerShell by using snap-ins.</span></span> <span data-ttu-id="2ed7b-118">已对 Windows PowerShell *管理单元*进行编译，就像任何其他接口中的二进制工具一样。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-118">Windows PowerShell *snap-ins* are compiled, just like binary tools in any other interface.</span></span> <span data-ttu-id="2ed7b-119">可以使用它们将 Windows PowerShell 提供程序以及新的 cmdlet 添加到 Shell 中。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-119">You can use them to add Windows PowerShell providers to the shell, as well as new cmdlets.</span></span>

<span data-ttu-id="2ed7b-120">由于 Windows PowerShell 内部命令的特殊性质，我们将视其为 *cmdlet*。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-120">Because of the special nature of the Windows PowerShell internal commands, we will refer to them as *cmdlets*.</span></span>

> [!NOTE]
> <span data-ttu-id="2ed7b-121">Windows PowerShell 可运行不同于 cmdlet 的其他命令。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-121">Windows PowerShell can run commands other than cmdlets.</span></span> <span data-ttu-id="2ed7b-122">我们不会在 Windows PowerShell 用户指南中详细讨论这些命令，但作为不同类型的命令，对它们进行了解会很有用。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-122">We will not be discussing them in detail in the Windows PowerShell User's Guide, but they are useful to know about as categories of command types.</span></span> <span data-ttu-id="2ed7b-123">Windows PowerShell 支持类似于 UNIX shell 脚本和 Cmd.exe 批处理文件但文件扩展名为 .ps1 的脚本。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-123">Windows PowerShell supports scripts that are analogous to UNIX shell scripts and Cmd.exe batch files, but have a .ps1 file name extension.</span></span> <span data-ttu-id="2ed7b-124">Windows PowerShell 还允许你创建可在接口或脚本中直接使用的内部函数。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-124">Windows PowerShell also allows you to create internal functions that can be used directly in the interface or in scripts.</span></span>

### <a name="windows-powershell-handles-console-input-and-display"></a><span data-ttu-id="2ed7b-125">Windows PowerShell 处理控制台输入和显示</span><span class="sxs-lookup"><span data-stu-id="2ed7b-125">Windows PowerShell Handles Console Input and Display</span></span>
<span data-ttu-id="2ed7b-126">当你键入命令时，Windows PowerShell 会始终直接处理命令行输入。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-126">When you type a command, Windows PowerShell always processes the command-line input directly.</span></span> <span data-ttu-id="2ed7b-127">Windows PowerShell 还会对你在屏幕上看到的输出进行格式设置。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-127">Windows PowerShell also formats the output that you see on the screen.</span></span> <span data-ttu-id="2ed7b-128">这很重要，因为它减少了每个 cmdlet 所需执行的工作，并确保你始终可以相同的方式执行操作而不用考虑所使用的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-128">This is significant because it reduces the work required of each cmdlet and ensures that you can always do things the same way regardless of which cmdlet you are using.</span></span> <span data-ttu-id="2ed7b-129">一个有关这会如何简化工具开发人员和用户生活的例子是命令行帮助。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-129">One example of how this simplifies life for both tool developers and users is command-line Help.</span></span>

<span data-ttu-id="2ed7b-130">传统的命令行工具有自己的用于请求和显示帮助的方案。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-130">Traditional command-line tools have their own schemes for requesting and displaying Help.</span></span> <span data-ttu-id="2ed7b-131">某些命令行工具使用 **/?**</span><span class="sxs-lookup"><span data-stu-id="2ed7b-131">Some command-line tools use **/?**</span></span> <span data-ttu-id="2ed7b-132">来触发显示帮助内容；其他工具则使用 **-?**、**/H** 或 **//**。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-132">to trigger the Help display; others use **-?**, **/H**, or even **//**.</span></span> <span data-ttu-id="2ed7b-133">有些工具会在 GUI 窗口而不是在控制台显示区域显示帮助。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-133">Some will display Help in a GUI window, rather than in the console display.</span></span> <span data-ttu-id="2ed7b-134">一些复杂的工具，比如应用程序更新程序，在显示帮助前先将内部文件解压缩。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-134">Some complex tools, such as application updaters, unpack internal files before displaying their Help.</span></span> <span data-ttu-id="2ed7b-135">如果你使用的参数有误，该工具可能会忽略你键入的内容并自动开始执行任务。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-135">If you use the wrong parameter, the tool might ignore what you typed and begin performing a task automatically.</span></span>

<span data-ttu-id="2ed7b-136">当你在 Windows PowerShell 中输入命令时，Windows PowerShell 会自动分析并预处理你输入的任何内容。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-136">When you enter a command in Windows PowerShell, everything you enter is automatically parsed and pre-processed by Windows PowerShell.</span></span> <span data-ttu-id="2ed7b-137">如果你使用 **?**</span><span class="sxs-lookup"><span data-stu-id="2ed7b-137">If you use the **-?**</span></span> <span data-ttu-id="2ed7b-138">和 Windows PowerShell cmdlet 结合使用，则始终意味着“显示此命令的帮助”。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-138">parameter with a Windows PowerShell cmdlet, it always means "show me Help for this command".</span></span> <span data-ttu-id="2ed7b-139">Cmdlet 开发人员无需分析命令；只需提供帮助文本。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-139">Cmdlet developers do not have to parse the command; they only need to provide the Help text.</span></span>

<span data-ttu-id="2ed7b-140">即使在 Windows PowerShell 中运行传统命令行工具，也仍可使用 Windows powershell 的帮助功能，了解这一点很重要。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-140">It is important to understand that the Help features of Windows PowerShell are available even when you run traditional command-line tools in Windows PowerShell.</span></span> <span data-ttu-id="2ed7b-141">Windows PowerShell 处理参数并将结果传递给外部工具。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-141">Windows PowerShell processes the parameters and passes the results to the external tools.</span></span>

> [!NOTE]
> <span data-ttu-id="2ed7b-142">如果在 Windows PowerShell 中运行图形应用程序，将随即打开该应用程序的窗口。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-142">If you run an graphic application in Windows PowerShell, the window for the application opens.</span></span> <span data-ttu-id="2ed7b-143">Windows PowerShell 仅会在处理你提供的命令行输入或返回到控制台窗口中的应用程序输出时才会进行干预；它不会内在地影响应用程序的工作方式。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-143">Windows PowerShell intervenes only when processing the command-line input you supply or the application output returned to the console window; it does not affect how the application works internally.</span></span>

### <a name="windows-powershell-uses-some-c-syntax"></a><span data-ttu-id="2ed7b-144">Windows PowerShell 使用某些 C# 语法</span><span class="sxs-lookup"><span data-stu-id="2ed7b-144">Windows PowerShell Uses Some C# Syntax</span></span>
<span data-ttu-id="2ed7b-145">Windows PowerShell 所具有的语法功能和关键字与 C# 编程语言中所使用的十分类似，因为 Windows PowerShell 是基于 .NET Framework。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-145">Windows PowerShell has syntax features and keywords that are very similar to those used in the C# programming language, because Windows PowerShell is based on the .NET Framework.</span></span> <span data-ttu-id="2ed7b-146">如果你对 C# 语言感兴趣，那么学习 Windows PowerShell 会让 C# 语言的学习变得更加容易。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-146">Learning Windows PowerShell will make it much easier to learn C#, if you are interested in the language.</span></span>

<span data-ttu-id="2ed7b-147">如果你不是 C# 程序员，这种相似性就不重要了。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-147">If you are not a C# programmer, this similarity is not important.</span></span> <span data-ttu-id="2ed7b-148">但是，如果你已经熟悉了 C#，这种相似性就可以使 Windows PowerShell 的学习变得容易许多。</span><span class="sxs-lookup"><span data-stu-id="2ed7b-148">However, if you are already familiar with C#, the similarities can make learning Windows PowerShell much easier.</span></span>

