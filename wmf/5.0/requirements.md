---
ms.date: 2017-06-12
author: JKeithB
ms.topic: reference
keywords: "wmf,powershell,安装程序"
ms.openlocfilehash: 510e1baa2933932cfd4c3bcb4e0973f3eb8095f3
ms.sourcegitcommit: 99227f62dcf827354770eb2c3e95c5cf6a3118b4
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/15/2018
---
# <a name="system-requirements"></a><span data-ttu-id="e0142-102">系统要求</span><span class="sxs-lookup"><span data-stu-id="e0142-102">System Requirements</span></span>

- <span data-ttu-id="e0142-103">先安装最新 Windows 更新，再安装 WMF 5.0 RTM。</span><span class="sxs-lookup"><span data-stu-id="e0142-103">Install the latest Windows updates before installing WMF 5.0 RTM.</span></span>
- <span data-ttu-id="e0142-104">你仅可以在以下操作系统上安装 WMF 5.0 RTM：</span><span class="sxs-lookup"><span data-stu-id="e0142-104">You can install WMF 5.0 RTM only on the following operating systems:</span></span>

    | <span data-ttu-id="e0142-105">操作系统</span><span class="sxs-lookup"><span data-stu-id="e0142-105">Operating System</span></span>       | <span data-ttu-id="e0142-106">版本</span><span class="sxs-lookup"><span data-stu-id="e0142-106">Editions</span></span>         | <span data-ttu-id="e0142-107">必备条件</span><span class="sxs-lookup"><span data-stu-id="e0142-107">Prerequisites</span></span>        |  <span data-ttu-id="e0142-108">包链接</span><span class="sxs-lookup"><span data-stu-id="e0142-108">Package Links</span></span> |
    |------------------------|--------------|------------------|----------------------| --------------|
    | <span data-ttu-id="e0142-109">Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="e0142-109">Windows Server 2012 R2</span></span> |  |  | [<span data-ttu-id="e0142-110">Win8.1AndW2K12R2-KB3134758-x64.msu</span><span class="sxs-lookup"><span data-stu-id="e0142-110">Win8.1AndW2K12R2-KB3134758-x64.msu</span></span>](http://go.microsoft.com/fwlink/?LinkId=717507) |
    | <span data-ttu-id="e0142-111">Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="e0142-111">Windows Server 2012</span></span>    |  |  | [<span data-ttu-id="e0142-112">W2K12-KB3134759-x64.msu</span><span class="sxs-lookup"><span data-stu-id="e0142-112">W2K12-KB3134759-x64.msu</span></span>](http://go.microsoft.com/fwlink/?LinkId=717506) |
    | <span data-ttu-id="e0142-113">Windows Server 2008 R2 SP1</span><span class="sxs-lookup"><span data-stu-id="e0142-113">Windows Server 2008 R2 SP1</span></span> | <span data-ttu-id="e0142-114">所有，IA64 除外</span><span class="sxs-lookup"><span data-stu-id="e0142-114">All, except IA64</span></span> | <span data-ttu-id="e0142-115">已安装 [WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855) 和 [ NET framework 4.5 或更高版本](https://msdn.microsoft.com/library/5a4x27ek.aspx)</span><span class="sxs-lookup"><span data-stu-id="e0142-115">[WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855) and [.NET Framework 4.5 or above](https://msdn.microsoft.com/library/5a4x27ek.aspx) are installed</span></span>| [<span data-ttu-id="e0142-116">Win7AndW2K8R2-KB3134760-x64.msu</span><span class="sxs-lookup"><span data-stu-id="e0142-116">Win7AndW2K8R2-KB3134760-x64.msu</span></span>](http://go.microsoft.com/fwlink/?LinkId=717504)|
    | <span data-ttu-id="e0142-117">Windows 8.1</span><span class="sxs-lookup"><span data-stu-id="e0142-117">Windows 8.1</span></span> | <span data-ttu-id="e0142-118">Pro，企业</span><span class="sxs-lookup"><span data-stu-id="e0142-118">Pro, Enterprise</span></span> | | <span data-ttu-id="e0142-119">**x64：**  [Win8.1AndW2K12R2-KB3134758-x64.msu](http://go.microsoft.com/fwlink/?LinkId=717507)</span><span class="sxs-lookup"><span data-stu-id="e0142-119">**x64:**  [Win8.1AndW2K12R2-KB3134758-x64.msu](http://go.microsoft.com/fwlink/?LinkId=717507)</span></span> </br> <span data-ttu-id="e0142-120">**x86：**  [Win8.1-KB3134758-x86.msu](http://go.microsoft.com/fwlink/?LinkID=717963)</span><span class="sxs-lookup"><span data-stu-id="e0142-120">**x86:**  [Win8.1-KB3134758-x86.msu](http://go.microsoft.com/fwlink/?LinkID=717963)</span></span>|
    | <span data-ttu-id="e0142-121">Windows 7 SP1</span><span class="sxs-lookup"><span data-stu-id="e0142-121">Windows 7 SP1</span></span> | <span data-ttu-id="e0142-122">全部</span><span class="sxs-lookup"><span data-stu-id="e0142-122">All</span></span> | <span data-ttu-id="e0142-123">已安装 [WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855) 和 [ NET framework 4.5 或更高版本](https://msdn.microsoft.com/library/5a4x27ek.aspx)</span><span class="sxs-lookup"><span data-stu-id="e0142-123">[WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855) and [.NET Framework 4.5 or above](https://msdn.microsoft.com/library/5a4x27ek.aspx) are installed</span></span> | <span data-ttu-id="e0142-124">**x64：**  [Win7AndW2K8R2-KB3134760-x64.msu](http://go.microsoft.com/fwlink/?LinkId=717504)</span><span class="sxs-lookup"><span data-stu-id="e0142-124">**x64:**  [Win7AndW2K8R2-KB3134760-x64.msu](http://go.microsoft.com/fwlink/?LinkId=717504)</span></span>  </br> <span data-ttu-id="e0142-125">**x86：**  [Win7-KB3134760-x86.msu](http://go.microsoft.com/fwlink/?LinkID=717962)</span><span class="sxs-lookup"><span data-stu-id="e0142-125">**x86:**  [Win7-KB3134760-x86.msu](http://go.microsoft.com/fwlink/?LinkID=717962)</span></span>|

# <a name="installation-instructions"></a><span data-ttu-id="e0142-126">安装说明</span><span class="sxs-lookup"><span data-stu-id="e0142-126">Installation Instructions</span></span>

### <a name="to-install-wmf-50-from-windows-explorer-or-file-explorer"></a><span data-ttu-id="e0142-127">从 Windows 资源管理器（或文件资源管理器）安装 WMF 5.0：</span><span class="sxs-lookup"><span data-stu-id="e0142-127">To install WMF 5.0 from Windows Explorer (or File Explorer):</span></span>

1. <span data-ttu-id="e0142-128">导航到在其中下载了 MSU 文件的文件夹。</span><span class="sxs-lookup"><span data-stu-id="e0142-128">Navigate to the folder into which you downloaded the MSU file.</span></span>

2. <span data-ttu-id="e0142-129">双击 MSU 以运行它。</span><span class="sxs-lookup"><span data-stu-id="e0142-129">Double-click the MSU to run it.</span></span>

### <a name="to-install-wmf-50-from-command-prompt"></a><span data-ttu-id="e0142-130">从“命令提示符”安装 WMF 5.0：</span><span class="sxs-lookup"><span data-stu-id="e0142-130">To install WMF 5.0 from Command Prompt:</span></span>

1. <span data-ttu-id="e0142-131">下载适用于计算机体系结构的正确程序包后，使用提升的用户权限（以管理员身份运行）打开“命令提示符”窗口。</span><span class="sxs-lookup"><span data-stu-id="e0142-131">After downloading the correct package for your computer's architecture, open a Command Prompt window with elevated user rights (Run as Administrator).</span></span> <span data-ttu-id="e0142-132">在 Windows Server 2012 R2、Windows Server 2012 或 Windows Server 2008 R2 SP1 的服务器核心安装选项上，命令提示符默认使用提升的用户权限打开。</span><span class="sxs-lookup"><span data-stu-id="e0142-132">On the Server Core installation options of Windows Server 2012 R2 or Windows Server 2012 or Windows Server 2008 R2 SP1, Command Prompt opens with elevated user rights by default.</span></span>

2. <span data-ttu-id="e0142-133">将目录更改为向其中下载或复制 WMF 5.0 安装包的文件夹。</span><span class="sxs-lookup"><span data-stu-id="e0142-133">Change directories to the folder into which you have downloaded or copied the WMF 5.0 installation package.</span></span>

3. <span data-ttu-id="e0142-134">运行下列命令之一：</span><span class="sxs-lookup"><span data-stu-id="e0142-134">Run one of the following commands:</span></span>
    - <span data-ttu-id="e0142-135">在正在运行 Windows Server 2012 R2 或 Windows 8.1 x64 的计算机上，运行 **Win8.1AndW2K12R2-KB3134758-x64.msu /quiet**。</span><span class="sxs-lookup"><span data-stu-id="e0142-135">On computers that are running Windows Server 2012 R2 or Windows 8.1 x64, run **Win8.1AndW2K12R2-KB3134758-x64.msu /quiet**.</span></span>
    - <span data-ttu-id="e0142-136">在正在运行 Windows Server 2012 的计算机上，运行 **W2K12-KB3134759-x64.msu /quiet**。</span><span class="sxs-lookup"><span data-stu-id="e0142-136">On computers that are running Windows Server 2012, run **W2K12-KB3134759-x64.msu /quiet**.</span></span>
    - <span data-ttu-id="e0142-137">在正在运行 Windows Server 2008 R2 SP1 或 Windows 7 SP1 x64 的计算机上，运行 **Win7AndW2K8R2-KB3134760-x64.msu /quiet**。</span><span class="sxs-lookup"><span data-stu-id="e0142-137">On computers that are running Windows Server 2008 R2 SP1 or Windows 7 SP1 x64, run **Win7AndW2K8R2-KB3134760-x64.msu /quiet**.</span></span>
    - <span data-ttu-id="e0142-138">在正在运行 Windows 8.1 x86 的计算机上，运行 **Win8.1-KB3134758-x86.msu /quiet**。</span><span class="sxs-lookup"><span data-stu-id="e0142-138">On computers that are running Windows 8.1 x86, run **Win8.1-KB3134758-x86.msu /quiet**.</span></span>
    - <span data-ttu-id="e0142-139">在正在运行 Windows 7 SP1 x86 的计算机上，运行 **Win7-KB3134760-x86.msu /quiet**。</span><span class="sxs-lookup"><span data-stu-id="e0142-139">On computers that are running Windows 7 SP1 x86, run **Win7-KB3134760-x86.msu /quiet**.</span></span>

### <a name="additional-installation-notes-for-windows-server-2008-r2-sp1-and-windows-7-sp1"></a><span data-ttu-id="e0142-140">Windows Server 2008 R2 SP1 和 Windows 7 SP1 的其他安装说明：</span><span class="sxs-lookup"><span data-stu-id="e0142-140">Additional Installation Notes for Windows Server 2008 R2 SP1 and Windows 7 SP1:</span></span>

<span data-ttu-id="e0142-141">确保已满足以下必备条件：</span><span class="sxs-lookup"><span data-stu-id="e0142-141">Ensure following prerequisites have been met:</span></span>
- <span data-ttu-id="e0142-142">已安装最新服务包。</span><span class="sxs-lookup"><span data-stu-id="e0142-142">Latest service pack is installed.</span></span>
- <span data-ttu-id="e0142-143">已安装 [WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855)。</span><span class="sxs-lookup"><span data-stu-id="e0142-143">[WMF 4.0](http://www.microsoft.com/en-us/download/details.aspx?id=40855) is installed.</span></span>
- <span data-ttu-id="e0142-144">已安装 [.NET framework 4.5 或更高版本](https://msdn.microsoft.com/library/5a4x27ek.aspx)。</span><span class="sxs-lookup"><span data-stu-id="e0142-144">[.NET Framework 4.5 or above](https://msdn.microsoft.com/library/5a4x27ek.aspx) is installed.</span></span>

<span data-ttu-id="e0142-145">**WMF 4.0 依赖关系**</span><span class="sxs-lookup"><span data-stu-id="e0142-145">**WMF 4.0 Dependency**</span></span>

<span data-ttu-id="e0142-146">Windows Server 2008 R2 SP1 和 Windows 7 SP1 系统内置了 PowerShell 2.0、WinRM 和 WMI。</span><span class="sxs-lookup"><span data-stu-id="e0142-146">Windows Server 2008 R2 SP1 and Windows 7 SP1 systems have built-in PowerShell 2.0, WinRM, and WMI.</span></span> <span data-ttu-id="e0142-147">在发布 Windows Server 2008 R2 SP1 和 Windows 7 SP1 之后，发布了更新这些内置组件的 WMF 3.0 和 WMF 4.0 程序包。</span><span class="sxs-lookup"><span data-stu-id="e0142-147">WMF 3.0 and WMF 4.0 packages, which updates these built-in components, were released after the release of Windows Server 2008 R2 SP1 and Windows 7 SP1.</span></span> <span data-ttu-id="e0142-148">安装/卸载 WMF 3.0 和 WMF 4.0 程序包在以下升级路径中发现了一些问题：</span><span class="sxs-lookup"><span data-stu-id="e0142-148">Installing/Uninstalling WMF 3.0 and WMF 4.0 packages uncovered some issues in the following upgrade path:</span></span>

- <span data-ttu-id="e0142-149">内置 --> WMF 4.0。</span><span class="sxs-lookup"><span data-stu-id="e0142-149">Built-in --> WMF 4.0</span></span>
- <span data-ttu-id="e0142-150">内置 --> WMF 3.0 --> WMF4.0。</span><span class="sxs-lookup"><span data-stu-id="e0142-150">Built-in --> WMF 3.0 --> WMF4.0.</span></span> 

<span data-ttu-id="e0142-151">我们在 WMF 4.0 程序包中修复了这些问题。</span><span class="sxs-lookup"><span data-stu-id="e0142-151">We fixed all these issues in WMF 4.0 packages.</span></span> <span data-ttu-id="e0142-152">因此，对于在 Windows Server 2008 R2 SP1 和 Windows 7 SP1 上安装 WMF 5.0，WMF 4.0 是先决条件。</span><span class="sxs-lookup"><span data-stu-id="e0142-152">Hence, there is a prerequisite of WMF 4.0 for installing WMF 5.0 on Windows Server 2008 R2 SP1 and Windows 7 SP1.</span></span> <span data-ttu-id="e0142-153">下面是如果在升级到 WMF 5.0 之前未安装 WMF 4.0，可能会遇到的特定问题：</span><span class="sxs-lookup"><span data-stu-id="e0142-153">Below are the specific issues you might encounter if you do not install WMF 4.0 before upgrading to WMF 5.0:</span></span>

- <span data-ttu-id="e0142-154">在 Windows 7 SP1 和 Windows Server 2008 R2 SP1 ([KB2809215](https://support.microsoft.com/en-us/kb/2809215)) 中卸载 WMF 3.0 或 WMF 5.0（未安装先决条件 WMF 4.0）之后，已转发事件日志不可用，且 EventCollector 日志不会显示在事件查看器中。</span><span class="sxs-lookup"><span data-stu-id="e0142-154">Forwarded Events log is unavailable and EventCollector log is not displayed in Event Viewer after you uninstall WMF 3.0 or WMF 5.0 (without the prerequisite WMF 4.0 installed) in Windows 7 SP1 and in Windows Server 2008 R2 SP1 ([KB2809215](https://support.microsoft.com/en-us/kb/2809215)).</span></span>
- <span data-ttu-id="e0142-155">直接从内置 PowerShell 2.0 升级到 WMF 5.0 ([KB2872035](https://support.microsoft.com/en-us/kb/2872035)) 或从 WMF 3.0 升级到 WMF 5.0 时，对 *PSModulePath* 环境变量进行的自定义会重置为默认值。</span><span class="sxs-lookup"><span data-stu-id="e0142-155">Customization to *PSModulePath* environment variable gets reset to default value when you upgrade directly from built-in PowerShell 2.0 to WMF 5.0 ([KB2872035](https://support.microsoft.com/en-us/kb/2872035)) or from WMF 3.0 to WMF 5.0.</span></span> <span data-ttu-id="e0142-156">Windows 7 SP1 和 Windows Server 2008 R2 SP1 中的 ([KB2872047](https://support.microsoft.com/en-us/kb/2872047))。</span><span class="sxs-lookup"><span data-stu-id="e0142-156">([KB2872047](https://support.microsoft.com/en-us/kb/2872047)) in Windows 7 SP1 and in Windows Server 2008 R2 SP1.</span></span>

<span data-ttu-id="e0142-157">**WinRM 依赖关系**</span><span class="sxs-lookup"><span data-stu-id="e0142-157">**WinRM Dependency**</span></span>

<span data-ttu-id="e0142-158">Windows PowerShell Desired State Configuration (DSC) 依赖 WinRM。</span><span class="sxs-lookup"><span data-stu-id="e0142-158">Windows PowerShell Desired State Configuration (DSC) depends on WinRM.</span></span> <span data-ttu-id="e0142-159">在 Windows Server 2008 R2 SP1 和 Windows 7 SP1 上默认不启用 WinRM。</span><span class="sxs-lookup"><span data-stu-id="e0142-159">WinRM is not enabled by default on Windows Server 2008 R2 SP1 and Windows 7 SP1.</span></span> <span data-ttu-id="e0142-160">若要启用 WinRM，请在 Windows PowerShell 提升的会话中运行 **Set-WSManQuickConfig**。</span><span class="sxs-lookup"><span data-stu-id="e0142-160">To enable WinRM, in a Windows PowerShell elevated session, run **Set-WSManQuickConfig**.</span></span>

# <a name="uninstallation-instructions"></a><span data-ttu-id="e0142-161">卸载说明</span><span class="sxs-lookup"><span data-stu-id="e0142-161">Uninstallation Instructions</span></span>

### <a name="using-command-prompt"></a><span data-ttu-id="e0142-162">使用命令提示符</span><span class="sxs-lookup"><span data-stu-id="e0142-162">Using Command Prompt</span></span>

1.  <span data-ttu-id="e0142-163">打开“命令提示符”。</span><span class="sxs-lookup"><span data-stu-id="e0142-163">Open **Command Prompt.**</span></span>

2.  <span data-ttu-id="e0142-164">运行 [Windows Update Standalone Launcher](https://support.microsoft.com/en-us/kb/934307)，如下所示：</span><span class="sxs-lookup"><span data-stu-id="e0142-164">Run the [Windows Update Standalone Launcher](https://support.microsoft.com/en-us/kb/934307) as shown below:</span></span>

<span data-ttu-id="e0142-165">在 Windows Server 2012 R2 和 Windows 8.1 上：</span><span class="sxs-lookup"><span data-stu-id="e0142-165">On Windows Server 2012 R2 and Windows 8.1:</span></span>
```powershell
wusa /uninstall /kb:3134758
```
<span data-ttu-id="e0142-166">在 Windows Server 2012 上：</span><span class="sxs-lookup"><span data-stu-id="e0142-166">On Windows Server 2012:</span></span>
```powershell
wusa /uninstall /kb:3134759
```
<span data-ttu-id="e0142-167">在 Windows Server 2008 R2 SP1 和 Windows 7 SP1 上：</span><span class="sxs-lookup"><span data-stu-id="e0142-167">On Windows Server 2008 R2 SP1 and Windows 7 SP1:</span></span>
```powershell
wusa /uninstall /kb:3134760
```

### <a name="using-control-panel"></a><span data-ttu-id="e0142-168">使用控制面板。</span><span class="sxs-lookup"><span data-stu-id="e0142-168">Using Control Panel</span></span>

1.  <span data-ttu-id="e0142-169">打开“控制面板”。</span><span class="sxs-lookup"><span data-stu-id="e0142-169">Open **Control Panel.**</span></span>

2.  <span data-ttu-id="e0142-170">打开“程序”，然后打开“卸载程序”。</span><span class="sxs-lookup"><span data-stu-id="e0142-170">Open **Programs**, then open **Uninstall a program.**</span></span>

3.  <span data-ttu-id="e0142-171">单击“查看已安装的更新”。</span><span class="sxs-lookup"><span data-stu-id="e0142-171">Click **View installed updates.**</span></span>

4.  <span data-ttu-id="e0142-172">从已安装的更新列表中选择“Windows Management Framework 5.0”。</span><span class="sxs-lookup"><span data-stu-id="e0142-172">Select **Windows Management Framework 5.0** from the list of installed updates.</span></span> <span data-ttu-id="e0142-173">这对应于 *KB3134758*、*KB3134759* 或 *KB3134760*。</span><span class="sxs-lookup"><span data-stu-id="e0142-173">This corresponds to *KB3134758*, *KB3134759*, or *KB3134760*.</span></span> <span data-ttu-id="e0142-174">单击“卸载”。</span><span class="sxs-lookup"><span data-stu-id="e0142-174">Click **Uninstall.**</span></span>

